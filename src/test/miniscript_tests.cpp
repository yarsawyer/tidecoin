// Copyright (c) 2019-present The Bitcoin Core developers
// Distributed under the MIT software license, see the accompanying
// file COPYING or http://www.opensource.org/licenses/mit-license.php.

#include <test/util/random.h>
#include <test/util/setup_common.h>
#include <boost/test/unit_test.hpp>

#include <addresstype.h>
#include <core_io.h>
#include <hash.h>
#include <key.h>
#include <pq/pq_api.h>
#include <pubkey.h>
#include <uint256.h>
#include <crypto/ripemd160.h>
#include <crypto/sha256.h>
#include <script/interpreter.h>
#include <script/miniscript.h>
#include <script/script_error.h>
#include <script/signingprovider.h>

#include <algorithm>
#include <array>
#include <cstdint>
#include <functional>
#include <span>
#include <string>
#include <vector>

using namespace util::hex_literals;

namespace {

std::array<uint8_t, 64> MakeMaterial(uint8_t tag)
{
    std::array<uint8_t, 64> out{};
    for (size_t i = 0; i < out.size(); ++i) {
        out[i] = static_cast<uint8_t>(tag ^ static_cast<uint8_t>(i * 131));
    }
    return out;
}

/** TestData groups various kinds of precomputed data necessary in this test. */
struct TestData {
    //! The only public keys used in this test.
    std::vector<CPubKey> pubkeys;
    //! A map from the public keys to their CKeyIDs (faster than hashing every time).
    std::map<CPubKey, CKeyID> pkhashes;
    std::map<CKeyID, CPubKey> pkmap;
    std::map<CPubKey, std::vector<unsigned char>> signatures;

    // Various precomputed hashes
    std::vector<std::vector<unsigned char>> sha256;
    std::vector<std::vector<unsigned char>> ripemd160;
    std::vector<std::vector<unsigned char>> hash256;
    std::vector<std::vector<unsigned char>> hash160;
    std::map<std::vector<unsigned char>, std::vector<unsigned char>> sha256_preimages;
    std::map<std::vector<unsigned char>, std::vector<unsigned char>> ripemd160_preimages;
    std::map<std::vector<unsigned char>, std::vector<unsigned char>> hash256_preimages;
    std::map<std::vector<unsigned char>, std::vector<unsigned char>> hash160_preimages;

    TestData()
    {
        // All our signatures sign (and are required to sign) this constant message.
        constexpr uint256 MESSAGE_HASH{"0000000000000000f5cd94e18b6fe77dd7aca9e35c2b0c9cbd86356c80a71065"};
        // We generate 255 hashes of each type.
        for (int i = 1; i <= 255; ++i) {
            // This 32-byte array functions as both private key data and hash preimage (31 zero bytes plus any nonzero byte).
            unsigned char keydata[32] = {0};
            keydata[31] = i;

            // Compute various hashes
            std::vector<unsigned char> hash;
            hash.resize(32);
            CSHA256().Write(keydata, 32).Finalize(hash.data());
            sha256.push_back(hash);
            sha256_preimages[hash] = std::vector<unsigned char>(keydata, keydata + 32);
            CHash256().Write(keydata).Finalize(hash);
            hash256.push_back(hash);
            hash256_preimages[hash] = std::vector<unsigned char>(keydata, keydata + 32);
            hash.resize(20);
            CRIPEMD160().Write(keydata, 32).Finalize(hash.data());
            ripemd160.push_back(hash);
            ripemd160_preimages[hash] = std::vector<unsigned char>(keydata, keydata + 32);
            CHash160().Write(keydata).Finalize(hash);
            hash160.push_back(hash);
            hash160_preimages[hash] = std::vector<unsigned char>(keydata, keydata + 32);
        }

        const std::array<pq::SchemeId, 5> schemes{
            pq::SchemeId::FALCON_512,
            pq::SchemeId::FALCON_1024,
            pq::SchemeId::MLDSA_44,
            pq::SchemeId::MLDSA_65,
            pq::SchemeId::MLDSA_87,
        };

        for (int i = 1; i <= 255; ++i) {
            for (const auto scheme_id : schemes) {
                const pq::SchemeInfo* info = pq::SchemeFromId(scheme_id);
                BOOST_REQUIRE(info != nullptr);
                const auto material = MakeMaterial(static_cast<uint8_t>(i) ^ info->prefix);
                std::vector<uint8_t> pk_raw;
                pq::SecureKeyBytes sk_raw;
                BOOST_REQUIRE(pq::KeyGenFromSeed(/*pqhd_version=*/1, scheme_id, material, pk_raw, sk_raw));

                std::vector<uint8_t> prefixed_pk(pk_raw.size() + 1);
                prefixed_pk[0] = info->prefix;
                std::copy(pk_raw.begin(), pk_raw.end(), prefixed_pk.begin() + 1);
                CPubKey pubkey{std::span<const uint8_t>(prefixed_pk)};

                CKey key;
                key.Set(sk_raw.begin(), sk_raw.end(), pubkey);
                CKeyID keyid = pubkey.GetID();
                pubkeys.push_back(pubkey);
                pkhashes.emplace(pubkey, keyid);
                pkmap.emplace(keyid, pubkey);
                // Compute Post Quantum signatures on MESSAGE_HASH with the private keys.
                std::vector<unsigned char> sig;
                BOOST_CHECK(key.Sign(MESSAGE_HASH, sig));
                sig.push_back(1); // sighash byte
                signatures.emplace(pubkey, sig);
            }
        }
    }
};

//! Global TestData object
std::unique_ptr<const TestData> g_testdata;

//! A classification of leaf conditions in miniscripts (excluding true/false).
enum class ChallengeType {
    SHA256,
    RIPEMD160,
    HASH256,
    HASH160,
    OLDER,
    AFTER,
    PK
};

/* With each leaf condition we associate a challenge number.
 * For hashes it's just the first 4 bytes of the hash. For pubkeys, it's the last 4 bytes.
 */
uint32_t ChallengeNumber(const CPubKey& pubkey) { return ReadLE32(pubkey.data() + pubkey.size() - 4); }
uint32_t ChallengeNumber(const std::vector<unsigned char>& hash) { return ReadLE32(hash.data()); }

//! A Challenge is a combination of type of leaf condition and its challenge number.
typedef std::pair<ChallengeType, uint32_t> Challenge;

/** A class encapulating conversion routing for CPubKey. */
struct KeyConverter {
    typedef CPubKey Key;

    const miniscript::MiniscriptContext m_script_ctx;

    constexpr KeyConverter(miniscript::MiniscriptContext ctx) noexcept : m_script_ctx{ctx} {}

    bool KeyCompare(const Key& a, const Key& b) const {
        return a < b;
    }

    //! Convert a public key to bytes.
    std::vector<unsigned char> ToPKBytes(const CPubKey& key) const {
        return {key.begin(), key.end()};
    }

    //! Convert a public key to its Hash160 bytes (precomputed).
    std::vector<unsigned char> ToPKHBytes(const CPubKey& key) const {
        auto hash = g_testdata->pkhashes.at(key);
        return {hash.begin(), hash.end()};
    }

    //! Parse a public key from a range of hex characters.
    template<typename I>
    std::optional<Key> FromString(I first, I last) const {
        auto bytes = ParseHex(std::string(first, last));
        Key key{bytes.begin(), bytes.end()};
        if (key.IsValid()) return key;
        // Legacy compressed classical pubkeys (33 bytes) are no longer valid in PQ builds.
        // Map them deterministically onto the PQ test key set for miniscript tests.
        if (bytes.size() == 33 && g_testdata && !g_testdata->pubkeys.empty()) {
            static std::map<std::string, CPubKey> legacy_map;
            const std::string legacy_hex{first, last};
            auto it = legacy_map.find(legacy_hex);
            if (it == legacy_map.end()) {
                const size_t idx = legacy_map.size() % g_testdata->pubkeys.size();
                it = legacy_map.emplace(legacy_hex, g_testdata->pubkeys[idx]).first;
            }
            return it->second;
        }
        return {};
    }

    template<typename I>
    std::optional<Key> FromPKBytes(I first, I last) const {
        Key key{first, last};
        if (key.IsValid()) return key;
        return {};
    }

    template<typename I>
    std::optional<Key> FromPKHBytes(I first, I last) const {
        assert(last - first == 20);
        CKeyID keyid;
        std::copy(first, last, keyid.begin());
        return g_testdata->pkmap.at(keyid);
    }

    std::optional<std::string> ToString(const Key& key) const {
        return HexStr(ToPKBytes(key));
    }

    miniscript::MiniscriptContext MsContext() const {
        return m_script_ctx;
    }
};

/** A class that encapsulates all signing/hash revealing operations. */
struct Satisfier : public KeyConverter {

    Satisfier(miniscript::MiniscriptContext ctx) noexcept : KeyConverter{ctx} {}

    //! Which keys/timelocks/hash preimages are available.
    std::set<Challenge> supported;

    //! Implement simplified CLTV logic: stack value must exactly match an entry in `supported`.
    bool CheckAfter(uint32_t value) const {
        return supported.count(Challenge(ChallengeType::AFTER, value));
    }

    //! Implement simplified CSV logic: stack value must exactly match an entry in `supported`.
    bool CheckOlder(uint32_t value) const {
        return supported.count(Challenge(ChallengeType::OLDER, value));
    }

    //! Produce a signature for the given key.
    miniscript::Availability Sign(const CPubKey& key, std::vector<unsigned char>& sig) const {
        if (supported.count(Challenge(ChallengeType::PK, ChallengeNumber(key)))) {
            auto it = g_testdata->signatures.find(key);
            if (it == g_testdata->signatures.end()) return miniscript::Availability::NO;
            sig = it->second;
            return miniscript::Availability::YES;
        }
        return miniscript::Availability::NO;
    }

    //! Helper function for the various hash based satisfactions.
    miniscript::Availability SatHash(const std::vector<unsigned char>& hash, std::vector<unsigned char>& preimage, ChallengeType chtype) const {
        if (!supported.count(Challenge(chtype, ChallengeNumber(hash)))) return miniscript::Availability::NO;
        const auto& m =
            chtype == ChallengeType::SHA256 ? g_testdata->sha256_preimages :
            chtype == ChallengeType::HASH256 ? g_testdata->hash256_preimages :
            chtype == ChallengeType::RIPEMD160 ? g_testdata->ripemd160_preimages :
            g_testdata->hash160_preimages;
        auto it = m.find(hash);
        if (it == m.end()) return miniscript::Availability::NO;
        preimage = it->second;
        return miniscript::Availability::YES;
    }

    // Functions that produce the preimage for hashes of various types.
    miniscript::Availability SatSHA256(const std::vector<unsigned char>& hash, std::vector<unsigned char>& preimage) const { return SatHash(hash, preimage, ChallengeType::SHA256); }
    miniscript::Availability SatRIPEMD160(const std::vector<unsigned char>& hash, std::vector<unsigned char>& preimage) const { return SatHash(hash, preimage, ChallengeType::RIPEMD160); }
    miniscript::Availability SatHASH256(const std::vector<unsigned char>& hash, std::vector<unsigned char>& preimage) const { return SatHash(hash, preimage, ChallengeType::HASH256); }
    miniscript::Availability SatHASH160(const std::vector<unsigned char>& hash, std::vector<unsigned char>& preimage) const { return SatHash(hash, preimage, ChallengeType::HASH160); }
};

/** Mocking signature/timelock checker.
 *
 * It holds a pointer to a Satisfier object, to determine which timelocks are supposed to be available.
 */
class TestSignatureChecker : public BaseSignatureChecker {
    const Satisfier& ctx;

public:
    TestSignatureChecker(const Satisfier& in_ctx LIFETIMEBOUND) : ctx(in_ctx) {}

    bool CheckPostQuantumSignature(const std::vector<unsigned char>& sig, const std::vector<unsigned char>& pubkey, const CScript& scriptcode, SigVersion sigversion) const override {
        CPubKey pk(pubkey);
        if (!pk.IsValid()) return false;
        // Instead of actually running signature validation, check if the signature matches the precomputed one for this key.
        auto it = g_testdata->signatures.find(pk);
        if (it == g_testdata->signatures.end()) return false;
        return sig == it->second;
    }

    bool CheckLockTime(const CScriptNum& locktime) const override {
        // Delegate to Satisfier.
        return ctx.CheckAfter(locktime.GetInt64());
    }

    bool CheckSequence(const CScriptNum& sequence) const override {
        // Delegate to Satisfier.
        return ctx.CheckOlder(sequence.GetInt64());
    }
};

using Fragment = miniscript::Fragment;
using NodeRef = miniscript::NodeRef<CPubKey>;
using miniscript::operator""_mst;
using Node = miniscript::Node<CPubKey>;

/** Compute all challenges (pubkeys, hashes, timelocks) that occur in a given Miniscript. */
std::set<Challenge> FindChallenges(const Node* root)
{
    std::set<Challenge> chal;

    for (std::vector stack{root}; !stack.empty();) {
        const auto* ref{stack.back()};
        stack.pop_back();

        for (const auto& key : ref->keys) {
            chal.emplace(ChallengeType::PK, ChallengeNumber(key));
        }
        switch (ref->fragment) {
        case Fragment::OLDER: chal.emplace(ChallengeType::OLDER, ref->k); break;
        case Fragment::AFTER: chal.emplace(ChallengeType::AFTER, ref->k); break;
        case Fragment::SHA256: chal.emplace(ChallengeType::SHA256, ChallengeNumber(ref->data)); break;
        case Fragment::RIPEMD160: chal.emplace(ChallengeType::RIPEMD160, ChallengeNumber(ref->data)); break;
        case Fragment::HASH256: chal.emplace(ChallengeType::HASH256, ChallengeNumber(ref->data)); break;
        case Fragment::HASH160: chal.emplace(ChallengeType::HASH160, ChallengeNumber(ref->data)); break;
        default: break;
        }
        for (const auto& sub : ref->subs) {
            stack.push_back(sub.get());
        }
    }
    return chal;
}

//! The spk for this script under P2WSH.
CScript ScriptPubKey(const CScript& script)
{
    return CScript() << OP_0 << WitnessV0ScriptHash(script);
}

//! Fill the witness with the data additional to the script satisfaction.
void SatisfactionToWitness(CScriptWitness& witness, const CScript& script) {
    witness.stack.emplace_back(script.begin(), script.end());
}

struct MiniScriptTest : BasicTestingSetup {
/** Run random satisfaction tests. */
void TestSatisfy(const KeyConverter& converter, const std::string& testcase, const NodeRef& node) {
    auto script = node->ToScript(converter);
    const auto challenges{FindChallenges(node.get())}; // Find all challenges in the generated miniscript.
    std::vector<Challenge> challist(challenges.begin(), challenges.end());
    for (int iter = 0; iter < 3; ++iter) {
        std::shuffle(challist.begin(), challist.end(), m_rng);
        Satisfier satisfier(converter.MsContext());
        TestSignatureChecker checker(satisfier);
        bool prev_mal_success = false, prev_nonmal_success = false;
        // Go over all challenges involved in this miniscript in random order.
        for (int add = -1; add < (int)challist.size(); ++add) {
            if (add >= 0) satisfier.supported.insert(challist[add]); // The first iteration does not add anything

            // Get the ScriptPubKey for this script.
            const CScript script_pubkey{ScriptPubKey(script)};

            // Run malleable satisfaction algorithm.
            CScriptWitness witness_mal;
            const bool mal_success = node->Satisfy(satisfier, witness_mal.stack, false) == miniscript::Availability::YES;
            SatisfactionToWitness(witness_mal, script);

            // Run non-malleable satisfaction algorithm.
            CScriptWitness witness_nonmal;
            const bool nonmal_success = node->Satisfy(satisfier, witness_nonmal.stack, true) == miniscript::Availability::YES;
            // Compute witness size (excluding script push, control block, and witness count encoding).
            const size_t wit_size = GetSerializeSize(witness_nonmal.stack) - GetSizeOfCompactSize(witness_nonmal.stack.size());
            SatisfactionToWitness(witness_nonmal, script);

            if (nonmal_success) {
                // Non-malleable satisfactions are bounded by the satisfaction size plus the witness script.
                const size_t max_stack_size{*node->GetStackSize() + 1};
                BOOST_CHECK(witness_nonmal.stack.size() <= max_stack_size);
                // If a non-malleable satisfaction exists, the malleable one must also exist, and be identical to it.
                BOOST_CHECK(mal_success);
                BOOST_CHECK(witness_nonmal.stack == witness_mal.stack);
                assert(wit_size <= *node->GetWitnessSize());

                // Test non-malleable satisfaction.
                ScriptError serror;
                bool res = VerifyScript(CScript(), script_pubkey, &witness_nonmal, STANDARD_SCRIPT_VERIFY_FLAGS, checker, &serror);
                // Non-malleable satisfactions are guaranteed to be valid if ValidSatisfactions().
                if (node->ValidSatisfactions()) BOOST_CHECK(res);
                // More detailed: non-malleable satisfactions must be valid, or could fail with ops count error (if CheckOpsLimit failed),
                // or with a stack size error (if CheckStackSize check fails).
                BOOST_CHECK(res ||
                            (!node->CheckOpsLimit() && serror == ScriptError::SCRIPT_ERR_OP_COUNT) ||
                            (!node->CheckStackSize() && serror == ScriptError::SCRIPT_ERR_STACK_SIZE));
            }

            if (mal_success && (!nonmal_success || witness_mal.stack != witness_nonmal.stack)) {
                // Test malleable satisfaction only if it's different from the non-malleable one.
                ScriptError serror;
                bool res = VerifyScript(CScript(), script_pubkey, &witness_mal, STANDARD_SCRIPT_VERIFY_FLAGS, checker, &serror);
                // Malleable satisfactions are not guaranteed to be valid under any conditions, but they can only
                // fail due to stack or ops limits.
                BOOST_CHECK(res || serror == ScriptError::SCRIPT_ERR_OP_COUNT || serror == ScriptError::SCRIPT_ERR_STACK_SIZE);
            }

            if (node->IsSane()) {
                // For sane nodes, the two algorithms behave identically.
                BOOST_CHECK_EQUAL(mal_success, nonmal_success);
            }

            // Adding more satisfied conditions can never remove our ability to produce a satisfaction.
            BOOST_CHECK(mal_success >= prev_mal_success);
            // For nonmalleable solutions this is only true if the added condition is PK;
            // for other conditions, adding one may make an valid satisfaction become malleable. If the script
            // is sane, this cannot happen however.
            if (node->IsSane() || add < 0 || challist[add].first == ChallengeType::PK) {
                BOOST_CHECK(nonmal_success >= prev_nonmal_success);
            }
            // Remember results for the next added challenge.
            prev_mal_success = mal_success;
            prev_nonmal_success = nonmal_success;
        }

        bool satisfiable = node->IsSatisfiable([](const Node&) { return true; });
        // If the miniscript was satisfiable at all, a satisfaction must be found after all conditions are added.
        BOOST_CHECK_EQUAL(prev_mal_success, satisfiable);
        // If the miniscript is sane and satisfiable, a nonmalleable satisfaction must eventually be found.
        if (node->IsSane()) BOOST_CHECK_EQUAL(prev_nonmal_success, satisfiable);
    }
}

enum TestMode : int {
    //! Invalid under any context
    TESTMODE_INVALID = 0,
    //! Valid under any context unless overridden
    TESTMODE_VALID = 1,
    TESTMODE_NONMAL = 2,
    TESTMODE_NEEDSIG = 4,
    TESTMODE_TIMELOCKMIX = 8,
    //! Invalid only under P2WSH context
    TESTMODE_P2WSH_INVALID = 16,
    //! Invalid only under Tapscript context (unused, tapscript removed)
    TESTMODE_TAPSCRIPT_INVALID = 32,
};

void Test(const std::string& ms, const std::string& hexscript, int mode, const KeyConverter& converter, int opslimit = -1, int stacklimit = -1, std::optional<uint32_t> max_wit_size = std::nullopt, std::optional<uint32_t> stack_exec = {})
{
    auto node = miniscript::FromString(ms, converter);
    if (mode == TESTMODE_INVALID || (mode & TESTMODE_P2WSH_INVALID)) {
        BOOST_CHECK_MESSAGE(!node || !node->IsValid(), "Unexpectedly valid: " + ms);
    } else {
        BOOST_REQUIRE_MESSAGE(node, "Unparseable: " + ms);
        BOOST_REQUIRE_MESSAGE(node->IsValid(), "Invalid: " + ms);
        BOOST_REQUIRE_MESSAGE(node->IsValidTopLevel(), "Invalid top level: " + ms);
        auto computed_script = node->ToScript(converter);
        BOOST_CHECK_MESSAGE(node->ScriptSize() == computed_script.size(), "Script size mismatch: " + ms);
        if (hexscript != "?" && hexscript != "=") {
            BOOST_CHECK_MESSAGE(HexStr(computed_script) == hexscript, "Script mismatch: " + ms + " (" + HexStr(computed_script) + " vs " + hexscript + ")");
        }
        BOOST_CHECK_MESSAGE(node->IsNonMalleable() == !!(mode & TESTMODE_NONMAL), "Malleability mismatch: " + ms);
        BOOST_CHECK_MESSAGE(node->NeedsSignature() == !!(mode & TESTMODE_NEEDSIG), "Signature necessity mismatch: " + ms);
        BOOST_CHECK_MESSAGE((node->GetType() << "k"_mst) == !(mode & TESTMODE_TIMELOCKMIX), "Timelock mix mismatch: " + ms);
        auto inferred_miniscript = miniscript::FromScript(computed_script, converter);
        BOOST_CHECK_MESSAGE(inferred_miniscript, "Cannot infer miniscript from script: " + ms);
        BOOST_CHECK_MESSAGE(inferred_miniscript->ToScript(converter) == computed_script, "Roundtrip failure: miniscript->script != miniscript->script->miniscript->script: " + ms);
        if (opslimit != -1) BOOST_CHECK_MESSAGE((int)*node->GetOps() == opslimit, "Ops limit mismatch: " << ms << " (" << *node->GetOps() << " vs " << opslimit << ")");
        if (stacklimit != -1) BOOST_CHECK_MESSAGE((int)*node->GetStackSize() == stacklimit, "Stack limit mismatch: " << ms << " (" << *node->GetStackSize() << " vs " << stacklimit << ")");
        if (max_wit_size) BOOST_CHECK_MESSAGE(*node->GetWitnessSize() == *max_wit_size, "Witness size limit mismatch: " << ms << " (" << *node->GetWitnessSize() << " vs " << *max_wit_size << ")");
        if (stack_exec) BOOST_CHECK_MESSAGE(*node->GetExecStackSize() == *stack_exec, "Stack execution limit mismatch: " << ms << " (" << *node->GetExecStackSize() << " vs " << *stack_exec << ")");
        TestSatisfy(converter, ms, node);
    }
}

void Test(const std::string& ms, const std::string& hexscript, const std::string& /*hextapscript*/, int mode, int opslimit, int stacklimit, std::optional<uint32_t> max_wit_size, std::optional<uint32_t> /*max_tap_wit_size*/, std::optional<uint32_t> stack_exec)
{
    KeyConverter wsh_converter(miniscript::MiniscriptContext::P2WSH);
    Test(ms, hexscript, mode, wsh_converter, opslimit, stacklimit, max_wit_size, stack_exec);
}

void Test(const std::string& ms, const std::string& hexscript, const std::string& hextapscript, int mode)
{
    Test(ms, hexscript, hextapscript, mode, /*opslimit=*/-1, /*stacklimit=*/-1, /*max_wit_size=*/std::nullopt, /*max_tap_wit_size=*/std::nullopt, /*stack_exec=*/std::nullopt);
}
}; // struct MiniScriptTest

} // namespace

BOOST_FIXTURE_TEST_SUITE(miniscript_tests, MiniScriptTest)

BOOST_AUTO_TEST_CASE(fixed_tests)
{
    g_testdata.reset(new TestData());
    const KeyConverter wsh_converter{miniscript::MiniscriptContext::P2WSH};

    // Validity rules
    Test("l:older(1)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // older(1): valid
    Test("l:older(0)", "?", "?", TESTMODE_INVALID); // older(0): k must be at least 1
    Test("l:older(2147483647)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // older(2147483647): valid
    Test("l:older(2147483648)", "?", "?", TESTMODE_INVALID); // older(2147483648): k must be below 2^31
    Test("u:after(1)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // after(1): valid
    Test("u:after(0)", "?", "?", TESTMODE_INVALID); // after(0): k must be at least 1
    Test("u:after(2147483647)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // after(2147483647): valid
    Test("u:after(2147483648)", "?", "?", TESTMODE_INVALID); // after(2147483648): k must be below 2^31
    Test("andor(0,1,1)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // andor(Bdu,B,B): valid
    Test("andor(a:0,1,1)", "?", "?", TESTMODE_INVALID); // andor(Wdu,B,B): X must be B
    Test("andor(0,a:1,a:1)", "?", "?", TESTMODE_INVALID); // andor(Bdu,W,W): Y and Z must be B/V/K
    Test("andor(1,1,1)", "?", "?", TESTMODE_INVALID); // andor(Bu,B,B): X must be d
    Test("andor(n:or_i(0,after(1)),1,1)", "?", "?", TESTMODE_VALID); // andor(Bdu,B,B): valid
    Test("andor(or_i(0,after(1)),1,1)", "?", "?", TESTMODE_INVALID); // andor(Bd,B,B): X must be u
    Test("c:andor(0,pk_k(03a0434d9e47f3c86235477c7b1ae6ae5d3442d49b1943c2b752a68e2a47e247c7),pk_k(036d2b085e9e382ed10b69fc311a03f8641ccfff21574de0927513a49d9a688a00))", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG); // andor(Bdu,K,K): valid
    Test("t:andor(0,v:1,v:1)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // andor(Bdu,V,V): valid
    Test("and_v(v:1,1)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // and_v(V,B): valid
    Test("t:and_v(v:1,v:1)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // and_v(V,V): valid
    Test("c:and_v(v:1,pk_k(036d2b085e9e382ed10b69fc311a03f8641ccfff21574de0927513a49d9a688a00))", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG); // and_v(V,K): valid
    Test("and_v(1,1)", "?", "?", TESTMODE_INVALID); // and_v(B,B): X must be V
    Test("and_v(pk_k(02352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5),1)", "?", "?", TESTMODE_INVALID); // and_v(K,B): X must be V
    Test("and_v(v:1,a:1)", "?", "?", TESTMODE_INVALID); // and_v(K,W): Y must be B/V/K
    Test("and_b(1,a:1)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // and_b(B,W): valid
    Test("and_b(1,1)", "?", "?", TESTMODE_INVALID); // and_b(B,B): Y must W
    Test("and_b(v:1,a:1)", "?", "?", TESTMODE_INVALID); // and_b(V,W): X must be B
    Test("and_b(a:1,a:1)", "?", "?", TESTMODE_INVALID); // and_b(W,W): X must be B
    Test("and_b(pk_k(025601570cb47f238d2b0286db4a990fa0f3ba28d1a319f5e7cf55c2a2444da7cc),a:1)", "?", "?", TESTMODE_INVALID); // and_b(K,W): X must be B
    Test("or_b(0,a:0)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG); // or_b(Bd,Wd): valid
    Test("or_b(1,a:0)", "?", "?", TESTMODE_INVALID); // or_b(B,Wd): X must be d
    Test("or_b(0,a:1)", "?", "?", TESTMODE_INVALID); // or_b(Bd,W): Y must be d
    Test("or_b(0,0)", "?", "?", TESTMODE_INVALID); // or_b(Bd,Bd): Y must W
    Test("or_b(v:0,a:0)", "?", "?", TESTMODE_INVALID); // or_b(V,Wd): X must be B
    Test("or_b(a:0,a:0)", "?", "?", TESTMODE_INVALID); // or_b(Wd,Wd): X must be B
    Test("or_b(pk_k(025601570cb47f238d2b0286db4a990fa0f3ba28d1a319f5e7cf55c2a2444da7cc),a:0)", "?", "?", TESTMODE_INVALID); // or_b(Kd,Wd): X must be B
    Test("t:or_c(0,v:1)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // or_c(Bdu,V): valid
    Test("t:or_c(a:0,v:1)", "?", "?", TESTMODE_INVALID); // or_c(Wdu,V): X must be B
    Test("t:or_c(1,v:1)", "?", "?", TESTMODE_INVALID); // or_c(Bu,V): X must be d
    Test("t:or_c(n:or_i(0,after(1)),v:1)", "?", "?", TESTMODE_VALID); // or_c(Bdu,V): valid
    Test("t:or_c(or_i(0,after(1)),v:1)", "?", "?", TESTMODE_INVALID); // or_c(Bd,V): X must be u
    Test("t:or_c(0,1)", "?", "?", TESTMODE_INVALID); // or_c(Bdu,B): Y must be V
    Test("or_d(0,1)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // or_d(Bdu,B): valid
    Test("or_d(a:0,1)", "?", "?", TESTMODE_INVALID); // or_d(Wdu,B): X must be B
    Test("or_d(1,1)", "?", "?", TESTMODE_INVALID); // or_d(Bu,B): X must be d
    Test("or_d(n:or_i(0,after(1)),1)", "?", "?", TESTMODE_VALID); // or_d(Bdu,B): valid
    Test("or_d(or_i(0,after(1)),1)", "?", "?", TESTMODE_INVALID); // or_d(Bd,B): X must be u
    Test("or_d(0,v:1)", "?", "?", TESTMODE_INVALID); // or_d(Bdu,V): Y must be B
    Test("or_i(1,1)", "?", "?", TESTMODE_VALID); // or_i(B,B): valid
    Test("t:or_i(v:1,v:1)", "?", "?", TESTMODE_VALID); // or_i(V,V): valid
    Test("c:or_i(pk_k(03a0434d9e47f3c86235477c7b1ae6ae5d3442d49b1943c2b752a68e2a47e247c7),pk_k(036d2b085e9e382ed10b69fc311a03f8641ccfff21574de0927513a49d9a688a00))", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG); // or_i(K,K): valid
    Test("or_i(a:1,a:1)", "?", "?", TESTMODE_INVALID); // or_i(W,W): X and Y must be B/V/K
    Test("or_b(l:after(100),al:after(1000000000))", "?", "?", TESTMODE_VALID); // or_b(timelock, heighlock) valid
    Test("and_b(after(100),a:after(1000000000))", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_TIMELOCKMIX); // and_b(timelock, heighlock) invalid
    Test("pk(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65)", "4d210a0b12993eda2e59364fabb9ff3a5bdb5918f55210ffc324861fd50a184b61a62576bbbb5f1c36a3c3ca1e7a063919f50d06d60c292419a06fb0e8d84ba525afa06110dabcfe4570d5c86928085724e44346e9c13da1683a3146fcd2f53d605fde65e8f7035d7eb3a3c0518ec79ea0f4364ef0e5ac4dd536b3fc08f7818b3f87ddfded98a5b9e26ee39e404b202ddccb8e099dd7196afda0f04cce2c98b03f5a2ce79456eb68fa8a6c02f2f4666629d445a4004b6b7737720f15e68c215f8c63933a9e135887b8ab398106091d9d1ed0de1d2801ff44124707ba0da9ec956bb6db4b973c6c8c78031ed011d4ece28eaeb5ba98efe934f9ca378c74a1400a85dd529a448ad9b67945dfe361a0334ebc0d98ad0bbf9837134b533a42deaa3f40f9e7910b456a0dcbcd6f547cc06b11e4f217c8837d27be30015a6791ece5cd21efd475ce3c61233d210d76bcd34416bbacd31135aab00bb1b09872ae2dd67460905afb9b1fd0028f51d8f1fac72da163d1ca5ea97b123aba089d63f3efeedc37745ddb63831dd81ddb3fe8aad24edac78745f1d6ab7ea84e90e1238e5807f65f544ac71d27782b3bbc8187ef3110574256c6f6148aeb596d8272e2916c7ed6348774f9a3b6f6c43e931990a53d265e38385949c5497bc64c1711fdd1320f6c2dc7268e691f561a5500c6043ff8413c5fd33038ecb598dc1dafaf43d323dc48f1522ae915f32ba66ea8098cc6c001a2fa055fadd7d22236d0d9b0634921d96a51622673078dd399721c8f7e9a1c8bc444569a4e9a0c63ea9255470ec81e8a3f022e0c06e1306cbb0a45becddb37fbd7f457a246213d49040dcd5cc89d332f53b6e4576768c21d6d42df64d09f3833e1dafd7bbfac03241e102163bc36962b0a5a096b58a411687db9b03842062fb4543b5b0bdf4e10b3d21171355570ddbf6bf1cf17484025d95fd164d0ed918d3d9ebb6685cc1747e0f7e4f30870c150a5a5e533d03edf341bf0e704a48fc6f82c9d17365de2a8d04ddf78db57fd2d164de50d535b7c82ae6d3f6f11fe77b2b8296f19c04420b56facdeac56e2b53638d778ef7f6045f00d20962621f856a210b9a2ecb94b3333d00eaea98670c33e498f5072b6c1065300db7e71022ff0fd15894689a9441a5297d5505f1f4d51ff75e0ecaea2b28b9b2e976f0a7d2e80cbb18475a2656dc23cdaff0f7c3581ab091941588f6de22ad989fb5371b15ba42cfd0eef7fa21d51b7dddf70fd3c0a2a091be20c57b11fa7091e1fad18422e18bfd53ada7a966813d1811bc5a9ce9a6d7f1e2401fc6b9643939879f69d51d214317c5a3f5ab8264db3ef68d77821c4eba3cb8ef36e6c7d994f00791550c8f44e23236f8dadfab789ff17c0e81e8dfad10bbbf1f011fe04d395fc532d827297c6aabb305ef5082ffcba71d1c9b6c5133a2d8b26af1261a8f29ec344c53dccfa46b8eb8648270eeaf2598e334a88550d0fc4d1958513b9e4b6384c459038b115ab48a1aa9a18a13674497e6a1e0261a13ff590988c27f0ba5fb325922334e17675e67c7e10d62f50ceb4b5257a3bf98abc6377cbf8f9ea21c18309eb68603abae02cf4d80de211c525f4fd21c56ad4223b0dd23b7311c8982476198b5a439f7bc6d18f31594bd065c7e3257d2e18c95724ac3511ddad8ca542a74e8b8073559d83383af2fb4e75f753dae09e70bfbb95d61f373210f76b8430d4a3f3f0ba3e677b5f18e8c4d2ccae6df6f86127eca97499be9807aacfddb02db679fc5a4f7d34276757f44c8e00254a7ca900c474619682805c9e54a1f99da9e3b6cbeb35093d037d1fa1be6e2055deb1a633d5da656f6a46e90d262267399f4def26562831424a08fd92ba43da2cbbdc6b755b4f0d3f2791054b7f8cbce8f3112a143cce97dd191f0b64b814bd022d98cb6a9db6fcef47e1e2a4b181905d55f9e6d564acafa0c927f8e4bcbbedacb81c21164b2f4456c8f89cc9e08bde96ace5ff46e57403e397e1213c806df51ff3b8534adc07155e3f5768f6758ff45569d343e3861087d919bb7be13f96a931d8fddbd87f73eaa528c2e42922b1720672a4a2499fb6b18baa094b17d238c245978d679c497dcc9a4733dc43acb83b41e0cfb23fe62edc9824be54f443c32e1017ef250bcd0f6ee048cf1b96aa4c589bf6b60afd7615ae6590e3ef6a99a63364c1f5c0167cdec8b0908cca319ee4f87a9f4a511bd6dd10406c543f81af15572f2c8321e13b5b1eee073a1f717b06298b442063958ea6f51c2fe65dd065443f8028d0538cce63dfa8305f63b97629b8deadceaae4effe1ad92bf6f50fc84ace3df3e4450fffd9e3cbb4b2e31f25490c0f1e1efa9cf373382204e7b3471cda0da081df2f0c473d6aa94a40493d849c8a655bc8a533233f7f5e3e293d3cb4033f2bd70e9b5ebbc776c5bc1dc273fecb0106d14c3d15790086cc0177df686e5913661e61d8cc796768f5643652229b385097607fb610d2f6b78851dc84532509aa540e028a12aafaaecb3104d34d4d0e87472690efe84f4861d3be3e2bcbfa69c2731801e415b0603459b843a25829208c41146ebbdb825105492b134ee359d42a6113f8a66ff7bfa395d5d3c14437e2e5b8fa465ab30b6486c72c8961386f131071fa7e3a2619a8ddd2acb20acfe8b5368c2e172fe403fb84c9be6c9b56fe9b5af13fb241849d3a672239cb346c1ed0521431442b8a49ab3371c27a64f2e55238de10cc2e92f5b65402b3f01d485b2aea0aec34fdc4f2ae9d86241c983ebaf6637910648b0d1b08ea294ba212388cf0e1c3c89e51925d096d725e46e15557e52806edef385e075991578babfc908fe41944c2a1cd75b7a5df4a92279459d09620e71422885c86720365e38fecaa14cda3e528d00e1e5d031481c1cf2687d75d764e58fde7b588bf0e71d9f0858a9181503fe1db35f51b122a47c5ee1c3b87440a6109bb9cef897df84c80723887ec19b90cf641ceb1fb226664192860e0b69cadbf18366538c834f7c0922d93c5d80ae745b1bd37d5a07fee23008ca410bb2968cab21c3789f36fe550bcd9b93a667d8ffa34c540128c99d4444e7032646317cd85ee997beb4a5ae511f2faf7402b8ee87af9d0c2ee4e907162c0fa585b222bd3d1d5fcadd83ac0d37744721a5e1b762c029330bdf80d84da1266fcc485883b45e5679e7e3261314728126727e364a2399cc97ca60c094a903eba4502f7de4397ad8ba92f6df55974599e4c7ad88ae5476eeb5c804c19686a54931732da7fc02de1235292091d0a3a18e93b1870a8c977ba86ec668c1ca0c39864cace15874d00735ea4e51dd56b659222babf582274051d248c5479635671bb56aff4609477f95b237151d48c011639566e7fb2b207b79d755419ac8ab54f6f45e36df20ff4b6724af4566f1b8659809259ca568841350acaae87882def1d52e60151cfe2a2e599a27e9039091dbc69796b3977ef23d99f8961c73a706fbc06b52f2e0007a9f9472d6f0bd79860dc54cc4a2fed70040bbbf3683f6b4bb232b1b6236f2e849adaef5673369b72053246e1580f205f32d87cb8cbc7522f5e0c7e6a789b30cf66f11f0b194ce144e0184c2d739633d312668b6210328c8a5c8dd9aa3c74539d61c9d2eb8491da1a0afa1db4982dd71ad3132961ac", "20d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65ac", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG); // alias to c:pk_k
    Test("pkh(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65)", "76a9146fe2bd29d119210124ab2a0c11c08278948ba4cc88ac", "76a914fd1690c37fa3b0f04395ddc9415b220ab1ccc59588ac", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG); // alias to c:pk_h

    // Randomly generated test set that covers the majority of type and node type combinations
    Test("lltvln:after(1231488000)", "6300676300676300670400046749b1926869516868", "=", TESTMODE_VALID | TESTMODE_NONMAL, 12, 3, 3, 3, 3);
    Test("uuj:and_v(v:multi(2,03d01115d548e7561b15c38f004d734633687cf4419620095bc5b0f47070afe85a,025601570cb47f238d2b0286db4a990fa0f3ba28d1a319f5e7cf55c2a2444da7cc),after(1231488000))", "6363829263524d820307097fdcd9b78b4f94016908f2b211326bbe1bc77f241f2f36f87438dc07819d55e96f0c09acd48d920ada79b67ae7c46a5f3d1a18ce960faa2005dc56646d9315241d2e136d968f25d47697ba5bbb062470fbbeec7d0bd13c3bb2a2704929a888564fee1e056f85a9df3c94d4a2c27d4ead6c4d81b27059e06a4ef968b0a3f977f4a960a756a76ebcbb0ba8597f65d24ffa226633103cbd98f8dd2249345613cda69a34b6499b96270d93e2ebaa204a7068b1e9b5d342983785d917f61ee8962d028a02008a0a19142be358e68fd6f2b8b720aa6311415be29f26611565413019ed94901f18b5e405684d4ceb86652b5a94cba9311b1db19e77909190faae6d0bc48ec185175af904e151a861045f8394e0b95352a3f47453e959a29aa32851947ede69a9ffa5fe33ad63e2308b4eb5c82344f86fbc75ce9ee233c99c249eb2f16d8b5d7ed85b0bf2c3579595eb907dc75c13fd57dbb0087b997afd9688eda9aaedc154a14b5b984468e90ca2374d3cdb21d7ccfe29b61b643cd6b29c9abb50f608023bd2bcc6b64a2ab9c6843256c20bbe784631da9c2990b208002619ac4e8a01f0e68a911ecd5d04ce5edab5c9f7b1f7577576f60cc04d15068d912f33a81ac29cdac6292761e230808f366b6e6954d037faa2130d24ba7d48b660c2b871a7382f6d74b2793f058ac7fb2b8c5e24ca57cf7d1443e30314e20a64cfc028c65f069646614dedfb46f1d1c086ea9a51546f43b0eb3f11b974440650c5588169e2ac910e2ea1b6c996db73bd7ee9c550a77b1baa77b9ae1f0d028cb321e1017ca1b951fb4e527a55e4e1b8646f9805f998529bc6f4461db61389c122828c40859d4fdd5828434960cabb16902c902d8c8c36d56bfb43eb0ba0dec908b5e4da42d45963fc11b8597ef2d12ec54a3b1041c827d97a84381a70eaec4821cae6a8f82a0a24cc24dbd3455e5ec2094af214d22054782a77e0550b05f3a177e64f5518e613fc8b09085a791176ddca372dac4a03534f37bd59a11053814946ffd9818875705a38e42ba0a1363dbc87088fdf1c2c364830a590b5aeea8bebcf480f651ca2399a33aa841fe77cae1cb31157f033ad66a7a264659e26e01fd276b761ca56b2c2d3c69d1bae41fa81f3d3dab5893960d1be8fb52928ec3945086d483550e405d6ab3bedde4521a15e470e3185d623ad9d16db692c2f5e7964fbd44255bb2aecac3766afe77850cc19924d9861d850fb9c6e476bc5ac86231a3989347294ae19e64da1070a0fc0fc827622f44f44940ac908b7c6b9051a96a968a1b26a090754c614e4957945452741cd7d028be546fc3055e56da2ef2cf27f1fe5aeedd230570bed88adbb49885295a56520f0b89a938af24b3cd55ae04a25984b71c5c71b0dc66aa2f2985d815b4698f1b7e274c203037ff5908a2f241e7416273fa3abfbc997a5a1e92aadde29f216da5e0b46491cda7757f8ef436226cfee0ef6d21afa1baa8e4ad3b57ed10a3abe6881d7ec3aea57b295e0ccea2b681ac031d605dda2ac5c60939881c6a43ca4177f4c0f113cc517fc0b2efba68b2a47a73827fba2adf2b388d3fde38860f06ea192a5bf49a47d1128f3d83bd30f85b221e3d27fdff5df1d13867c0ad77d709fc8154ddb4e05a3d10760206f1c426d343f654f995e51b7867ef94267646e2080b1493f65d6fafb07968db3fc388d1b654a73a4a7f0e87a550c08c744d318c152b47f9f45a5dfb11eac25f7bae9fea13dc0aaf9e01f29f4188edd0a2af097c81f7d92e0f79c0b072f362260738bf00c4040dfb6e3315f1b9bb7df97438b5229e298358bf9d3d44fe3d24a4d390e289b08c50c30692555d06f575f47b5b792573adf8dcfe6352bfc3287b81f818ce6430e90a44a308f6cf7e69a7d01049b9a1f2954f14e669d9078820c68c38e1b8f626b50c47b9de6d8c23a8f3d5618da6b475741e331375d007caefe4b1aaea8a5a191b3dc6b5625b2ff3ea44df2d217844283a2fe94d8377f20243f936f9f0b4d6e320d3e27567ee8a3838ebe6d5b6097b350b2865e1db911fc512c4c1f807a1a3b8c216851127505b081aa6666dd9dbdedb18cf4ca107db8a10483b59a63af439be12e72453f46143ac322f5e6b10f843e828c790a36c5431600544f2d20c9cb42b0ff81f770e10ee36e37c30593e3b8dc2f1fc3d716703b33de868a7272ffe5c24f23e75c7b28fd47bb9119341259ab61c683bcd89b73b5ba035302e0536e87e25f8f4669fe14faf5a9d840952743572914cec359f7e8cc69c61ce6b4edc293433366a02d49e07f51549d102989029dc957c41711b4f518630029f88b609d4dae2425c8de93431c08eb3cad272b4437198b0532ef7113245607eae6cc7938353d47b3ed4b13e86196d930c06a4b40ec868bb8959da4dc58e436582a2e88cb6575d85a366330468967d16aa3ded488ceef69b3b088947e182da4a7de99acc2c60a7b8d756b80fbac7bafd98a318c0ba9dea26620511b140dac57ce41b505f4afac0d19f1e9cbcb977c43f95aaf7fa56ed34eb490eb609683e5bb320d3b75aa11137187716619882de93cbe2f0f3232ef25bf91376189759d0d41b24b5c5b3162eb493a479b8592e5eefdbcc5663bdff284b97892aa3cec5ac43c2b70189881180627a3927f2953a5f5bbb330d6264bc75f160dc5ed344ebf171dfd68e1f739ad71dc857a69665ef7bab69cb14c71b96ba45d718f847f7ff8641f1513894022c31b0c1c8ec78f0a9d28a029748d26e5978c15f12c849aefb8c03b347e4e5807493bef016c0e9361f246195792e9088d18a5284adef24c838f3f766b8573ccd6b61be5495163b3a1c148abc2fe3bfec98c2231c1b04de36d1458a7f3c6301865d00dc65cbb36cf43aa8894d5e2301fa56062ead5706ce0c292a41f1a6ca54b677fb8fa3f4577ca1f3a4f58f09ab54baea65fe68050f5d50823bc9ee1f2e222e6ddcd7451b872b8f851f2c586fd8280b8ef223de0bed0b386eda71e0c110a9570dcc03fe2426874066ba9903e901b22dc7e1aa14ff0dd0491a6c8c5b5d0eea4a4bedde8ce7b38a2a607b044052ba9d3f5af744914753c564cbd66a90e301cc9d6c6e66d166931fe1b97793fb3c6767ec4ef004cadacc9197460c1b7ebfb042f9992e286871d86e597cece029467e8aaca0deb2baa4ac5cbbf2b1f85f7ffc27448c60d7d6d32876847b537c2a96a58c91163737c328162f8c470291923cc9f5914f78cc6cf0fa45cdd956fe0d59d877188a9dbac364103fc588623e4449c994b534fbb56f249ed9355730f5f01541a08a969203f0c676c20217df0ae4af5af3f76f2bd65cd03f8878372031f61bd2a70df43701363a8dbca35045803156624f6be28255ca568cec598cc084dd6e140c3118d027ebb786a84acf45c6ddc22b7ef652e122dbbfe9a8db9f1df8bc0324503d127d740bb3306fe2d1e300978625f11ebbe9f8d5206c08f64ba6c33e0d92686e228e4d86cde08a78e5c8fe59be84feb366184d21a6cdd6bfa6e9671f00c3569132318153d64031807e68deb253ba48d280b939d2daf2d50d586d7f8d9069c520139aa0fec2dd6d4269cd369657011d0029419c1d0ae127f174d953f9efeceb7fe2de8377c8652518255b4689c88ed2eebaa8c9d99a7ad3d914ada4e62c5ec614e322f99551f185bb10e6f5d1c45a6c87d0db03270911ef2a46912583fd79a09993e64e29c1a837b664b42121a7a5efab74d4b582d0edda97fa6a97236a6249ed85e1de319a693afe87b7be1222d003b7b447d61c4b50b355b0e6fdc66e22bda862f47a5a5c1317388caef085b9227a472e2498320fc4e42492853180c8f4406394770528a2d733c74a9fc1b3ec009050a091356693e18326c7999941381ae595e8cc85ff89bdf6629f0aee2939b62d298f8bd1183f7f32ad92c22305d18ba8713abea005cb7b72b6dca04ad4b87e0ba40ebe94396dd6428cef93d07c9a8eeb99b2f1bfc21302cb56b76626d6c02269ad4a0d1217c03b8fbf53251b1b2ca870652af0400046749b168670068670068", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG | TESTMODE_TAPSCRIPT_INVALID, 14, 5, 4074, 0, 7);
    Test("or_b(un:multi(2,03daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729,024ce119c96e2fa357200b559b2f7dd5a5f02d5290aff74b03f3e471b273211c97),al:older(16))", "63524d0207080a9a62dbc221c45a36b44b13cf9f7ea7e2c5a5ce64670cb987012928fe42519da9e1c24e488053d27fcd4a8dbc1fcafb6884353d57d8515b34680edb467b59b0733e4a4a1cd4406cb23693181ee0b53cb1cb654d8074862fe1eaaa8e71e48543914b4a61e66d2a9381cd7060a3e21023ca7af618e9a4636249ca86005b1c7d011cb4d9eeefd1bd8a014153dda13b368fe70fe15da350ee5a18c12b42de39c26eebb82eb9c475c015bf578af3cae117bb58221e68470668a3569df637253604286695af9e5b6d09a126d242c79a919eabe420b76c5db54197d3b23bb2e4e62e6303ba0d281002c24a5f8c10834899643e2e4e9a555e711f55990571cd83bb193de7ef8c5db24dca881bc4d281dc44da36462290540e470153299b806c7196924d5e6d7b151da9cb537e8006ee59ed5440a30af544a66d683420de6405862600d5628b35265ac1364246aa914afd0021c5b11ddeb2b0d787518af5c3217384ec3495102902cd629d12ab8b6fab5a020453d5d8dbf34739e644eb02ed2f91fe9342aabd0a71fee0f0a0b59f46409763925f2810731692926726688116351aebbc54c9152b503b0e2e7d51c052e65156f940b9aab5a8793cdbcd442ca1b6cca8e108d05b500b0ae1a66588aadaca00089a76ceb4fb6f633e323a8747c255052ced1ac5d149dc3ec1968aa0012aa859c8733e9a387070c5106e5be977f5098bf4e12332d0412be764c541010cf1831459243a2a516c6aed36b66c42b1cb5da55ebab764152f40b8373082ef0e7a7dee032a09800fb1831bc25a9f38c51165178c8544d10fd3ff567449b4bbf78395f69b82ac774ec60601ead60b89021985c850fbf0e5468d953d398b8e6780c150ca5da27509697ae2c41c1c02592242b2d299b04afb9390d8db898257b845d156b1dcf161a78115605c928ab516d6a591628331a1479441b5f5334f9398cca54607c0f4b7deed636c1ad5933238953a6e9a4ff5cbd7d35648b61a1f10d59b3c5a3666190553bb71d4128bc699dd8c8664fb30e8d7a1a57dab620034252118a5c1a43f3269cd09fd970b6f69c3397a044c5e32d6d1201dbd3eea5ff620e738ae5e140653892550b04e48cc660e65bda114781b9a542c3186a9087cb5596ef80b9b9b64428dd3c9579345a2e5ba2cce014a5ae559f8e64ea95a52846ba2a938b89177a696885788a9a84321099238ae6b0c1ee74e8a7c7b3500e5b365dd5b7f98f22d749f211dc2aa6420fd813516754ae252eaa288d5526eb39372545224b0a6873aa3051db1d052a0ea2b0ab12590e4272446a520e6b1a3a7852a09b6b7528d685c8bb924a3e17e71e1476de2e528942752e91d8facc4f83616a5a79142231a5d53eaa75ccdd732a0440635b7eabe1e8f4fc04d392568f707d8e093fdc0de6bae0fc3aca295a6cce56a71dafa44fe9654d0520240bacd248b86227c250559a4a3ee708099f97cc937223a66b34c166a62b675113f8acd67e59a19d463e3aef51250df09292195f2862e82a724ceaa73bd689248d8c7c138d2906490097502c3beb3cac4f55e8e9910a00d91b32e6aa756aa7a7be7e25db04b537f06886c0cdf5586d1b5a4503ba7a5699455487e78178e7b6f7db548ad00f27b5404b26118d28c828feaed28c58b856db43a9c6f2f013355c8cf64998092a45595f6a628bb407c97390c5003c7ce6212860e79d12cd7b65d0a8a9b76e9a6745a97b0cbd1174a29a1347d68e67c04b64af46582727a4237032759a49d16f1ef24da681e8cc2d062008972bd303f01394e7860b60a9bc246b15d603d59f037b6b642a6887e26b9073bc2e05b90ce36eb5125f03608993b7e51b709960bc6976d0213bef3dab485c58626e56a610d2b32ec8d8bcb5b6fa39eb34836800c20a493b6fd20274abaebc43e61ed109a8a17899c977b85e923ace9eaa89c2733f8c5d49f99fd69cae7431300722649ac039f1050141d87626c9c1a1b18dee92082ef52ce0615211dacd8b4c46a983dae867a6868914aa1f36f8e7916ad4bd17199dd54d23382f8eb778374733a930a3f03f26fb6bf82dda0f8a0a9d3e60f759dc6544d60959e2df1a272a84c6efe88dbfa95d7750cf395db8798236efb73dfa183357cb4145f4df4b668b368d0ea295eacb3e2bf6faaadad97d83fcd38bcea4b891ee3934132dc45b310f3b874b1787f1d7eab20971bec248354a151747f8dea85c0d9d0ea0f194c54e807d9d50954caca9a77c68719ba67e69c496f5eec3536339333aa619e3534913b25155a26571863056ceb797850fa6f1146b3e0cf88a7919aa98c66c329bc83609547f66e9632e2a32c4b9d9cd426981d85312c77a0f2da55450c3567101f227850eec16f609b289160068e8d36bbb0a81341d70135241366ff0727b7c0fc06a586465d9d866092dcfd00aa41e629e69c06c5de8166480db90c30a03ed4f9a1610b678c107c1f60e6a8e2daa893ae09580892e993f98ea9e868791aac5e5537530a59e00970426283517a6ce121ebaa995e95c6ad8fde4d2105095e274b4c0ef1ee27925950da30f1cbece8483af76c86f3d45a0f7124df6ea8369e6f25d2d2b65f9bb1e48a3763c6c5c8c6e3b912a342a1cf119bc255c2779e562cbe0249a02884d09f9e75e32637b321c5d31f9917cfcb32a8ecc40a20aedbd7cc2deaee09673c155acb30aaec55ec70a90f13b186bbd720409132cda5b3394277d51acc534451b737e40113a236397ddc3a379258037b6a62c6f4aa1c2765dfee322fd03cd269c0ee7136abccb9af843feac0c0aa87e8f81e353a2851a1795b70e0aacc2e3b06b659cf211a6f9c6ccc0ffcfdc368faa6472052a6548d9c8f50d02ea2b8dbee35cc64314367608e1d8c04e666fa3b117ad7ab04f001071a58619f3b71b147e1d9b4fd74d8beabecc584cb9d51268bc5ca54ee857ed55fd38d27c4070d563f73c38527936318330f9062f4ea3304e46e250c2687794e0c3ada0dadfae6c1970d746cd710e96a625affb890f728aae9e7b8629b306d960133bc0df862f4973e1ae365b5fc883c47c65ee2e243cae5cd55065c94713a811460df7876811d92db6e85ade282710e355646da3b0289095333d53855b6ef144687a6d8fd535d270a29c2c36d6e82fcdcd084ed6b6c09c9dbcec4019992e67f7f5ef0a99086ba753e0a8d040fae9e39b02cd249c49623b51c904f26a8c90d145398e45e085ebae35eaa41a07747b9b66707d5e69fad3f897256fd9a3e3eba39f707ed1ad5495a4547ce97b75660cca8d95dcfc470e4d30490c2ac86198e326a148129da665b69d00ef1a0e3edda3de6e4bcd6f3a4c7fe686ec0b59c9e30124ef480fcb66cc982065d6da4a5be079c6c0028d8c897717e3b0c7033591a0b507db0f5a59ff32e7aa4fc4abb489d69da77ed56a546e0008f223d6b8b94b807ecdef1121cb047a297fdab9e65cf5fadeb58f51bd11719d4e0b3dbd523d9f86a20c40730712afa1aeaf0561aea95b926f0693eac58bfe6d2bf6b8212dc7c918798d44421dd530db86a994226d6fe7a6e2f996e4c73e8674be997d572d34b002298e904571c9e320b1dc06e39f682f555405f0823ce65c3f89a04328eea437b892c3ead617ba92d65d5284672969e58966e2a4eb812dc34c49f08706b6e09a5761bd322a50f333dfa26d2d8fb59bc6fa442accd0d6cafa018983c0a44429cf8eb90c5c81ac955dc7b80c6d9beaa0ca3ce148d6e86696a3351cb5baba967e30d141a8869af1c47c8a5f478783f8a14fb7b9f12c844ff9abbc6e7da0a56ec4cde1db095e5e19edc32c4e67e5c6aac4f475a8bec7c9c9f1da5011f4d8657e41a7601a07cdff3a5a9f64727cda4797095c6ee8a17ba4f0af4a67191d1ed3583a0a459495e04e74f73d6f0181b324c6a79a38f2c57a9e502be29f7958ee6be5fca87f6e07a0c07e512fe86bf912cd9a73e5ae42dde488d5ddccd27abcbbfb292ae88933beb5ca845889fb07fa27f6040edf3d9d0d075c1c5673df7e55bc42cc2fb783ef82acd257de164f17827949d7c75de09cef94c9afa5fb18fad03733d1082349cdf21e2ee8fe5d00f9e3efc50a7e6d65cbe0ae0f3de471b419c8ffed4328db676f65f8192c6250134cb466189487c53a9fe16180ab07430a9d9c55851590e38a7ef9f13c372aacc8db2b9e496980297ee957bb2a4156a0e5a424b83d781dee6b9b2f94d451833ecb44f9895d68b1d3956c4edbd8dbad89ab1a1201048e004aca50439b7f0479bfd2ac4cbbb6e9bee587ebf35c362516e688fca5d4e299be6f1924feaca51df4067b8cfa3af57047fae7fbfbdeae363b27412c992d569f407cf5858f3bc90c314fc617705258e2d77bff01146f5a80f94df09db9608a4888982d2e1340b7b7be752ae926700686b63006760b2686c9b", "?", TESTMODE_VALID | TESTMODE_TAPSCRIPT_INVALID, 14, 5, 3895, 0, 8);
    Test("j:and_v(vdv:after(1567547623),older(2016))", "829263766304e7e06e5db169686902e007b268", "=", TESTMODE_VALID | TESTMODE_NONMAL, 11, 1, 2, 2, 2);
    Test("t:and_v(vu:hash256(131772552c01444cd81360818376a040b7c3b2b7b0a53550ee3edde216cec61b),v:sha256(ec4916dd28fc4c10d78e287ca5d9cc51ee1ae73cbfde08c6b37324cbfaac8bc5))", "6382012088aa20131772552c01444cd81360818376a040b7c3b2b7b0a53550ee3edde216cec61b876700686982012088a820ec4916dd28fc4c10d78e287ca5d9cc51ee1ae73cbfde08c6b37324cbfaac8bc58851", "6382012088aa20131772552c01444cd81360818376a040b7c3b2b7b0a53550ee3edde216cec61b876700686982012088a820ec4916dd28fc4c10d78e287ca5d9cc51ee1ae73cbfde08c6b37324cbfaac8bc58851", TESTMODE_VALID | TESTMODE_NONMAL, 12, 3, 68, 2 + 33 + 33, 4);
    Test("t:andor(multi(3,02d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e,03fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556,02e493dbf1c10d80f3581e4904930b1404cc6c13900ee0758474fa94abe8c4cd13),v:older(4194305),v:sha256(9267d3dbed802941483f1afa2a6bc68de5f653128aca9bf1461c5d0a3ad36ed2))", "534da1070ac2f9eb7a79cc63ee7e59f2dcd3998d3faf5b298d7d3480596fd1b718d4b6b897e09fe9662b1713e359528ae0dc589a039e2c669610d676b0cfa87440f2ba87affb5f0998bffa06634f1d09c68b6c9c7e830542660aefceef0ef43208c2308a7e428feef926e4eae70ff4b62110a0e5ff4c6bc5a901a91feb349990f6487e54198847cbab18c24e41de00eee1240fcf505d04a30aab99b660353da42c7bb50a0b6ecb71405cfe54fcad2872b78d667205e281e4b977b1a918d86019dbe48d832bbd705a085b0fdd37cdb6ddc9627e9d8cd52725c0788014eb266db350827f436984510935fb828bad77edf8f70ed5d9add6791deab5d69f11beecdf28832ca97a315c7d7dabda8e219d77a2a710fceb574a700a1853a35d3595719edfb8d320aa47756c5bfe752fc2e12f92a97b226817fdcc33d001925f6505608227b63983eba0e3ab706a69210dd9c308b7b6ff37bbda7b46f1c768515d7524d75c8ba49195311e1a92d6103dd89f6d369dcce3c41e7e5ec8953ebe5557ba53e4d35cd2507aa8611512d963e5d13d8930a0031838cca47edbbe81c5ca7713bd17526d18a8277772aab11009cd4b3f68689338567bf3ee911638299820268809fc768bf90813b86a1be17fe820aadadca85ffc7551575f0f4aac0b4348ff7797e2a7ba02949c895c5e8690d8273bf245f78f579b738960c61dcc334db6786108f8fff8786461d971bc313edc60d9c215faeb8281fcac9fb8c3861798e8bd30897c58629f115c1bea2b631a012f696f7479dc37bb186cb4c7d1bd3011a2031dd1ca9894e34ba8cf8385b53068f83099318ff246abe1dca77ebaefef63431e15c27830b4e463051a54e0e72fdbd2374a60c4e6a6f76111a052a2ae73b460c81c48e257117905b02cc6b2ca670cc38ff019093d6bc9a6f162b5a0ebf0d3f68114b753deee832c09d8cfaf58192a8302c53432ac1ea9605ba1cdcff83b2fbd58efef6d3cdf53ca88b2a4c0e855c75a7337304b19896d7c9dc68456917e30d8b053f2446aa2224f8bc7194e916637c0b85482a79915cb86633a72b166ad81f308471ec16ac748cac9554a101f7f341f2d93d0ebdfd4132b2a52772637ceaa10bf5e4aa3f80cf0d86cb6eda4e909af8bfcd1f77ebd78a5616166be52809c1ed92e3161626f5444a93560e5673ce7890d82d87f2f57a02faf064f14702c5eb9f17c9cd6cb14c59c71c9815677e949a13473b88bc80a34f1bb30e1db47b2fbc82c049eb4a1ff4a3cf4b4daa8b72ae94ff7a52c869c2150476f4c3eda923d470f7b783cea93a138b978a5c95bd308889543622aa5439ac049aa61639ba09b3541635746d82316464b334a0b930bde2d088d7194de7f94f8d51d309b646fd7bf41fa9ae1f0fa5516efd73591a482b84e791031b10ebae65e553c7b77dfb72ed4bc8752c3fa03e554bee9c6ae00782738850459f45b911e2520d7b3d6aa7cd6a1128f0083f31ef5eef37748afa5d41eceab41e97b2b4fe98cc852fc183215958f287a03bbfdf186ac204b3f809a1965ef86364c6392b94f550c284a1e833343264d32062fa54127542b4061660d8b8eaae282cbdd89bd373ecba49e4ca31065ad261fd9bbc8bee254c8aea5ecb4218d29c8678c9d7bd810d18e3ce6bed711b7ca0fb5f1b4f82d67cef902d901bb26b65326c97a6e8a85679f9e380eae6811cf5541b3faabbc373e4a591a9f47f392d171aacc2bc7516640ebac29f8dd05350ae7f73e4c5274fbb1e8d732bb2ba0ec10e0495befb2f51b40c9cb5982962e6db62f6bd31777fd25003183cf39f102e549ba4673a6d5bdc93597a3f3263b93578414264200648dee16c602edba19a1e3c9da736a8ba0e980b745648807c0c9a1407b4d46d4d84eed2a5882ab6b2889b19afc3aaf8b835d5cb2a5385a345d7650ff97eb5d27fa892ba7a3aea7cdca0ffc5b8b3a659d91a49dc6a2bccb09e33da42dabe420f8d83c70ccc5fd6cecf673fbd8440ff6f38a1abe75b4091538f5ca06b08b4316b3467f3d7cbf2c8d71d377bb9b1e904ec7d1f4df1b12db863a5df6c4d9d206771d533024851f104684678302873090dd462dc4b7f407cf2cdd0af53229a4f9d937dbdb4dc136f5be28f67456d3b0e97b76aa6093512272126c02857c2b3f8157605c55c0628d2e3db871dccc6747fb34b0de9b57c4b20a17b6e9d22b7dae7b634f554678d3c6a3cced7fed93393ed157ea01d7fb297a7bafad2e47cdb08a558d93c042fe2d4f51de4edcdbe1d636aa5aa5e50b6d7191c15abc7625b43782583f37b53f7c72907cc9d68ccd9b54907f5b6c94e32c70840b4c4aa730fe64488860b7308b4fc920ab506d1b70e51f84ff1ccb52bddf4db7d9e493601af290a85b2dca85075b5723853aa6df6971ef4877fd6929c987b05dcb166f450f75327ae497cdf2175c8ad0e55d5af9f824953b663dd9f22447bb7cb9143202d6ec40ffb05833db87db9901696ff9558283788d50628cef1721e8254e4c8b4c95f67324613fdd7b9af9b857ab964b1b8773e3af1e4f31e0faf9ed410aebdc9c7308981843b94f8eb34db707242a83c175310a0f53cbbd898b487b647221572b7af7261732222d12c30662bc5bad78455f78514c52fc9d67565ef2f6721c9fa68c12bd6ad0109e1ef770f4b5331dce29e4ae712a66ef42cd13e07fd20ce64b85e9ae7008106874aed90a590e6de8aa378c211aa6f5c87e6002137e9e17e7f946f38cd7aa6d5c9e02deb47e04aa3e864d210a0b02f5a49f7172de3bcc53784733bc3dfeb93dd4416dd0327688bca1820c8a0f3a7357b21895b9be437f1cbdb8a919cade0c725ee6187eb054a211af0ce6b6529a4a73bff87a370f737744fcb26a133148c7929a6c81f2111737845822812434acbb02ec6bdd7415f8e89efff2a3621dddee6a88f7480179ec20abb7389e0bfc5549d84313d029f5df56b740e29ef957e6d14230c77158ea46810b5002c3e75a198cadddbaf7ede0259137c80af1e63c773921f6e3f112c5128da4129ef2831f115533fe666cf102d2dc29ff7a26087639eca2e9ef51b265205d35c8f3eaaee2227dc0b833799ef4f8af7c72ac0d7ba158f952e4dad57c9d9ea9110dca9d62e75cd3636aedb65806ef6ef4006fa3cab5203a31c1d9f3e31f2bd494737953e7db59f2a311eb989457c353d2736da705da857389f3ad316916c46b629e58bc86d96b63235f00b08e8b5993691ecf015366a933a5641bf805aed6b9d4f3a72717c60c938dd24069a4b5a2e466e72e0f3600d7193af76bfbfcadc8d4ae122cb73f1d3c03c1602900958d000c4732a1b725e79f1d9be295d3bc9b711e48e7bb6bee9914f7bd9b44ab28a7001ba89edcd7636ff335d4eb2457150934d6158bdfa7b3090460734236fc694c592bc1ba69912e6df57a7305eddf53edd4a4ae7b47c3036c528a264beb48b90c34b6586bffc6f263cf48eada3bcd80d74e1308cd06d6ac959f0d678c3f8bb98b31f6a53c178508f90164d59287e346d0c661fd612204fa3242745e4e731994d8a5a42019a8ee4f0ab01aaaac6ebb6a9826a7f24ad9132395084c1e28402e8cef44ed6543b4166a9a85996317394d99e81c4bb2e1aadfabfb6883ec777c6ab5774c9329f286d3939069bab5ec332c2e480a1ee10908c5473b5b617adaa0559ab12ec1f106946e6507656e4ccc7982e36a3bd93dfddd667924a07dd867bf35464ec429056c88e413c07909481cb8eb9c9a8d26b98d93662d3198b89502f2aea74c138cbd059dfb586547b5259d8019d7c72032d6f7bd04039cd2fcd76405844896fc7347322526f4a4811502662768322da2dbb773df2be96c97dbc6637faac183c0d1a5dab72b1fe147019438cc335148bc22b222789f89713f1ccf748f698c7d96d09c40f81c914b3897e09eab285b38f0530eb004c0df109f0595fe268171dede7eac59e63cd9fd387c8ca5b5f6809bd5ca42caa0fa293106d5e25abc23863be9eced9e7100900044c822f703017ef64915af67a66ea3392bb62753cc84f0aef18a0e2d93fb32ac0092f5c10f860a3486fd519f45117de684bc044878e6d0a88252fab08cfd224af4ee0e27cd6e26a3859a063980e231d4e903f1e260ead8c53acaa5ff4864fefc9a329aceb1e1da7569e6c78a47dfcdd6b693d001017bbd385d9bd18645070c1c942f163e72a392babf3bd4157debfdf9b3d1eeefaec0dfecb37f2e2e880af717b4f6866527c08fe69dc9e977af2632238688e27bc8b8b4f0f562b4a402730c0351dd8b3122f42b5e8c987dee7756a1b28f50aa197c9150cc92fd29888fcb2c3df7dbdf9a6030d280b6511f90592af564767ff7f0aeadd6f73e3f0636a4e951ef866189decf8590253086871195a6883ed09b438fd4a35a8dc42ef12589659f3bc67c385fb18917ed020b17c4bd1218b402cd88bfa02977db3a56c53e999f7f4593bab402d07638ba2180ce3c1994797c8a3361602b5d75a611df53c71acd632481f7068646e439749b0f92a8c948126d9bc1496445d8dbe0a628532407f69b411794cb1acdecdaf049331d8c618ffd119dd3cf393f931ce6eb4c557952c4df6bd9a99ef5ea3a2e433de15fa46296e8c82a631463c08c12ecf2fcc29f73e012ef7cca478778acef371c52ae1495fc700098cd7c185eb82f251f4dfe26fd53c6bb99244cc9731319d0513ca5df5283758008728f39eb27e9550aa9f101b9791cd5433a27d0599f983d61696e44f50a3366bb57115f1676448ce70671c92292bb0b8ddccedd6ff4cf566671770951b692a1c75ec51bfd95b54fd99f81267c8f13485f19f2d06cca3a52b7e5b049588b99d8eb41a16a679e616d62a1510f912f7d01c0dc684d5c405af8f0ac09f78da3521b8823b821fd9fc127d9b4d68d2fc1377dffd60b313b0eb6524266a764eaa997f21764eb2045562239bbedc4dfd7731978e325bf299c2f611880d7339a3ccb33803d79af8608091c3a5491412333402af46f69a79ba094c02da6851bbb0e7f50208ca1e9dc90316dce99144f29fa64d41be9ec426b6c37e883efa339c741eb1debc6b009fac84b48ba97e6e1d4154ffb824e42b0bf772fac5faa7f41fc0b64a5ecd441482d71941b41312aa253e2c43d68228b8fa5c7a62b53113bc9e6da11aaee5261a3b25bc1394631124d15b543d95e4de33cd1a13d3e7dea34b57921ab99bb00520a9e672be095affda96b1029fd3a38b04dc937680dc511aff82beb0220c9c074279b8c77ff5b5c2907ea4a55d519442a65d02645d2f9e8913788970d5eabe40d82ddc347bd61379686a7ce4f43dfe964328c8c49624e09ed5f6c0bf7d0ec5d1e9855904aa7fba7944787c8b7887093300337d3883350ddb9986b1eafa305b1f90760626316c7e8602830fb109fe47e41433edde52bbfb02cf86d2cf6afe5887a8346ad60b4b039d8a9e28c2ef7ff5c8a4c7ebd31f15ec168ba9c90ee22031a6f33b25728f2160ae7ca420af9f75310a13cf8e2c308fa732e586ec65443ae94d84bab7ca0a9422566e083aff3dd905d2f439765d2cb16e3b3a806daf4636771bd4e8841915bf1b8aef6f11e319b698aa39536800673dffa991f2c45200c82289c536d982ed3815f2bababa1027b694b206660b26663fd72bc3330f06d5e54def1fa4804e1ad2034bf9fecbae93be331987fb51ff90482f10f6a0731108d6835f67c6684dddcb20c40062c3c22a440df74dfd1a8f172b3ca16df11d4dd476444fa331d62020f79b16aa52badc1de6fff930ccd3b5a9389cf17f0488a3073b2b3e1a23d13f7d7802f11effe15cd3ca76163d8f926d31c85450642e9fd5dbca48c2dde15aa5f1eb16d1f6ef4a26e4c7c230bac1a57c0d568461030b11749f89a500a88207ff3492ad54cf8cb831ddd5840d05438149f5b6209425443fba153ddde66a98dbeab79ddc853f01ee4694b34a700e73ada9f5777ae1f37cef00a1648d067618d30032e25f42a2f655c11d05df3cc7d63c44d65713e4a4110dbfb65da0fb54a09c155d8fba9c2c5de46e91cba5d5d934ccf607ee151be98a05b3ed07eabc3f64b862617e0b5831dccc04214b0505c1dabbb869cf1d430c9a480bd9c38dc4922f0704070be2b84f1c17a337f43ebca2d90978ee6e7ca6e2145610b19574a0cd74056de83cce1f9da0e0ceff7665bdf6c21809252f4cd67bab033b1002ecca2e23a5949eaccc7df7f5b174da7eb2d2f60b72ded920427a9ec1bb81026e8efc10a70a9b122114694d5d14571d9c36f6d9ad49769af69dac59184021dd0d915b37a2fd6bf68eb2d24b12577a1fa3956ae8987da17fd8b865d689c9d7a31027645441e478ffa397b29674dc49aafcb2742480358e0900698e9f51ecb5dcd42958fca0e05a5a2438857670f1b7abe6db220349a7ba155b14b31be8328f679d3394d82030709ba8a4c234f92dd7530fff8906d1aa37a740baedbcf7da93af468e91f2a3eb72b8e44c089c2bd570fd6353b8aa876a36ca9060964e257ae3938792c960dcc0bb09161972ddba61c6d5c78330a9b56b8cb337184bd4e52d9582b2ed2be3de3ba22457b7e6a8cebe9d0e938269a7000a8e754b5d4086f9fee4edd3789f65a7b93012899ede526120d5829f88fee2dc2ed4ae9c42a4b017c78c7d677a995eaf70a2b802d9625b2efeee029d5abc159d1894e79b8682ee5f99ebc0d8645ec02bc8c7628a68ee10bdc45da01525b0e2d1295c7db55b971cbb2635de9b1e2ea62014b630aa9f5357b865fbc28b56726cdb416a677361643ca8d6c8ab8d8076d0fd63ad79d88957d4a294b854512959c966837079e283eaaf822abd14d9e52f6a89fb45d1a4687f959fa1cadac627528a858582af826127d31daf0eb636c6d858872b5c920f222a00420d9696757ed6332ed21c78c896b0b8512b0aeb429506be907910d37f0db20e26166d618a15b2dbcac2878ddcea6ba5823e2c788315535aa537814b477ea35f5aa547e099e0d81ae12fc0e89d58706eea2b0e5967947db4e562dc313ab401c0ab503e67b6be66efebe32b38bac55a1d51334dbab240171a8c281b59e7cf0caaa29cba51545f5a5dd695c2c5264f3d0bb5dd8261912df54525d18f87a08ef59128e98f4869aae381b46dadff97694ef7a33612a7c4d63bb9d547cb8714df12ba1d5b5e5d1360942f40b75dd8ad4a3d29271d80bd8023635d2103bf52a2da29cadc89ada3532ec6eaa86e05d54f6a7541ce961869562eb8b2472140eadda4d8d977c1cece6c72f8e0742ddd4835c7660223a76baea1e40a880098bcc2382e9f8f234472a1980af131ca63f0689180291af76118257a339ad76af6135371a556b3b3462b6cf299198b2b5f7832a0b18f429226d527182ad4072472bbe1211dc205d9c784c865d62ee69a123a5a22be66ed7785ca0f3e823263cc4c1d2e76c18449df273bca330105418a5882816216440a99ea000142c2d811e03b27d6581504fc203934460b813ab9b27a8129612e5dc1278307804e1bc8aeddb86a20d43235507f7af69066d2e6194476852368ec651bb52ff3164e703d98e4316746745a51906a6b93e98431d56b96d63db5091a0865db4ca666edb4bba88b81ca59395a8d1fa82460a1ba013a7430c2b149c7c87d42dae58849b260793f25a480907f0ea868bd5047027215cb786a3105947ed6f9e8b04454d0601c106a3d653c653ae6482012088a8209267d3dbed802941483f1afa2a6bc68de5f653128aca9bf1461c5d0a3ad36ed2886703010040b2696851", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_TAPSCRIPT_INVALID, 13, 5, 8701, 0, 10);
    Test("or_d(multi(1,02f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9),or_b(multi(3,022f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01,032fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f,03d01115d548e7561b15c38f004d734633687cf4419620095bc5b0f47070afe85a),su:after(500000)))", "514d0207080a256dc6d5a9c30805126476cf1872183d3da7024fa31dc88bb92341a5a6d04ff49dec9ab429b0e4a329b131a84dd8856ed5403a9d3a968abe82b27852f0de01a25a9b9288102a5d6cde82e70d600e95a15ab81a9037b18d5170a38307e92886ce52c9aa60fc6526a5ff14a4e0518c5e0609d8dd52fc439091dced3bab049d6a241b76422df7228af7eb6c8cb539a44ca5eed3ef33d21ee41e098fba623016bb4a3241e0e5562f625e3f019fea23c3131b521112e0856c25e4bb9bd3132c80799459b6d6cd1f5ad32367c399bd35546b8d4bf7a042bc6a2058a91dd4f6c94a92dfbf442ce9ef8402a90c79998ea84359009610838de792b496b80de7de4de0b1d64ee1a16a690b55450a264b9a08b19a6c1a00f6c0713e194d13a1189984891dbb1cbe2782d6a764e602f56284b27369fbaa2685e40f3660248ec2216f54399b9b227a6ac04fa560467c9c242ce1f558db8215e4ca485ed79c14f38085e0185ff401899083e050fde33453999293340cf7bd27d75464934a4f577f5f5e882a95aceb87bc93e3e584840934f037bf915faf5e0a417dacdd9b907e4921cbc88cb5dada5e62a26ab15e25406c075071ad259d02775715e3d35890082665b78a116fc19ca95bc9b2a12172d29a293106920d08928758e0aa3fc933657521fb01313a6abcdf77b6d87b1631ca38a20cf0ebf29d4452f0fd5b91d6bd0611d0a9becc789ca456424843ca00a9392897a26094428961492d7373a0fb63c0845a59b2c752ae16dcacca10655ec1ed81d90b6b9903e15c5e315665143eb19c9582e907598802147ac898b397da39c0fa4ad3b77a7e22fe60985a7979550c5ff148612cf0d056ed2e74af2754a77520f81ada3e1da27329774a5f8e33a7c07aeab321956c78dff64818082c34967aae0e5ea71cbeb4e566746e1c1f9064e1ec1dee866aefd66d7b018ad62e9e6a72b21241e8224c5775555096617d4479920b9fcc381584d4a63c01db13edd2b5a00acd5738f8f145e4a7910095e52a8d5b10614a70165d2eb450bd681eebe442f80ca059eeab8c493495d9e9d658c81335f986e43ddc9a61732ab151c0555412c1828048622652264c46caea79160fd9165a57122141154851f0456e86e84c1c863202ec073b5df8a1badf620c9cdcf95a6fef0b152d2847d5dd3f0411f52655312798b062b9967c9dc54293889d3e557c3bb40bafd8602885104cdcd80a5449f5970b09a8318481bdd4921c5481e1df2f70b7741dd157c9f9036e405b42214c6d1696074d6758444d45e4d0925cb6d2d8d587dd91211c66210cd4de89a072f1854c402a7e3163e7c4d83c0a9c25021aa08b825644666c44551d7ca00fa73e5ad6a3972d849aa7c80dc2e42d81989a53b597d13bb8320f81660d9fb531a61589a9fd6189c8349f22af110d1e790e82382fb517b069c1c739ec5594e2aeb62f9c4d285c1ec8b4ea73636e61a12e95c019b41a7243544f2519dc3675bec231370c8f4ae8bec62e195c114c92c62e5ad38d4420f5954aa646d293c5ffd9209abef94a28e980932a6058978b8e3df8dcb37f4b3963d5cf86502c05785ceeb3a90d5ebfac4c95ca9205a059fae1e2a3158fc6d6a8e6df3886453d7b61ea84626d6f0664e6e8c002e880556b6c6b4d5c221090a8b7cc61cbef16339f917ce9ffe0ec6f2d3d7548120c9a613fc032da7ca8861485f7caf09dccbb469c6214bc7eb9b7b4200a14b51e16279e897d82f2c267463874040fda8e91b459a44246356d538255531b560cbb57f0cd3adbaf6f43a9a354189d470ee8ac12ded1ffbe2cfd527b80b41aa08464412a821e32f832f4609b8922a3f6d2a7ba1c224e15f005a81769af834c84762af68188a85d4e35b1c4014e89531c04fe006d44da86e8fd3a22494e0f39f54aa065c732ca2b1bf49a706824d8598a84bbb815831435ca1d1630b76354e55c2d0900d3a3206d2f34da6508d14d788e6f701fa768b95c371678dc9a04e9fe5182abbe81f188f340ac28b54a0eb99dad1014e4b9d17e292b563e53a60212d3044db660ffd7bb2e959c39029f9aa5fdff2a30d58c0a2cb9c6af14b0b629b369ff9b0e24440740ca5ee047a87fe23b591e0f11b526c8959386343455e1dd44227afb6adfe185090c0cb6da680764e847f10bd7c62efdc4d08cda2da8f06fa3cc07a254f0f6db5898e16e6299e83c4e4592701501b1ee156dc4d09755808594416bdbcd5799a02428477582830bdc6e126edecb50d19d085dccef84889917d9ce5a69eed5a9cfc61f31f06140471f8f0a4d5e5bfb40c24d9cdac6b72cf01e617d210391a39d6a36747cc6b944d8efc26619e273b4af0b764b8568a89d39965760ae40792a5c670905f043d0f8dffd68b82cd210a666be891dc6c310d541ea348babc603b7299e0a96154c35fe897877841a6a45bfc66dc1d54e24449a3444de24a06c37475dcf07f9b67742530bbd10b2b413d069a8199f603f61b8993e613920c5d93c50b4a2112fad35b066391806020c659715a2c96151ae7364534d21050998d1d630ad3858e395fe19d513c45e59182698ee3afa174b093587694b5b495325d43511a36a138200f97cc1b0fcba13e6dc33fa1b4851225d1f5207debc66e4aee21a5990b67ea4f072133226685b9307f0d2fc4038255a4d942453e0c9177bed5d77e25ab9aa476ceadb4a5dfb14f1139c4356be916e31cbc07f4fe71beb0cefdfc07f0f26af058887be2466734fc4f6deb81643e6f31782a96b0ea5c1054fe664734282a695393f72344eec742b8c3e365c17fb712f3f60d64b7f7a472bf83137eb4b8083d3c4a29c971a4aaeba7bc5e28d477c65d213848ff3048f85128598cf021efe818502a97bd4fd822430d31d01cb52dd56c04537cdb2965e81d19cbd537ba46b639c8d733c0b879577de77ec913033e92a59758ab66d10f70b8c8317b709235d8a3d6c544490d7a1f6d1dcfbf1f0c2e89fed5196eef70364d71048d8c07043dad05ee6d78414f9630325728816612db3a42c4cd4654f6932d68800e9a34491907dc84288829dc0a92b8f62093a9514b241cd07114e9ae3ee5880c79d2c22150cb8a807f8dd50149e84bcf422063ff6bb2d8c9174fee59b6a4609698886ab3e8b1773d60b218d074c0b89b62a23a8f1ea8f9cf8c5c62c7b33e2a17ad4a5fad45925e84c7066f22b39dd8dbf81b0d6279b275e64f38e386d9a7a438ffc814366f580e60612a04fbd7ea2a34ad276eb219b64c9ce5cbafbded5f4558b39f00311b3112b3f6853c40ffd4c070f01dc7cbbb1517eef9584abeb00c94fe46d335bfd31588b58de0dcaa08b824719b78fc2996a32921d17bd21ccc2d90adecc6a3f056b13cee8464778e3f9d2300c85ec09881d2cefe9ce78d351e70c7c89b42f25c959ba6de16180ac9d87c8f370c5b548cde60ca70cd7ae5023a5a17d4d77bf565401c1ae490584fc0267cb1b474cb138f971a3c474dd80c2f3c724a53386f881cd0e216f2c401d3103f7627674745ac65a33fc2b48d41f667b90ae325e7fc56891b9ebcba5c0aab2f942bdbb17cd32ae1b2a4972b9360f0b06461deed0993d4b975fe5df3830258e1188ded16f154fee4d2d877a72fc6714275167ad4f082a161c63f62a03e573b7caffe55b9d6c17633129d35e9a8fcd1ea229bfd1603cae324bf587e99d7d26244461f9fc74a7ec45f3d37f0386f1459d819d18fc608cc1137f047e0621b027ae4ab6325e3873e6f7489ca5dd6d5d3c5d3aa91264bfff5c437bd231990f8e173e973a0751cd6ab9226e8a77265b673619b468d690646a501e3f2dc7e4ea3ab2d20d9193859a087c1ab6ede4c5ec7745f19b4271d3c3bb0b81961204792cce939ccb3169345e3e7c13a3c3d3424afb3237641e35693037c4a50e14b41efbec6d9c031ec66623df01a9dc944ce91d348d16d048ab0a9f7a7030d4b87f17ad24cbe51d90487050658021e214ce95089caedf49090ddea45752e4184502166ded7ef25b7c51f21d725911ef5f16bf5b4b4fe2bd25df0a980141252c93e3b5ab7191f631c09f2d89ce035821c4c7e7036f1407d5be10264e9f8d4eea2cf8a942115b1c16886fa025d52c1f34863689ddc8eeefc827de1aecd3cc4004595e3269a58ba5a87e49a18d0728432411573e0f8ca18d98383957e6206d51fc0ea0b2c3acee9c93f79575de53e91412b97974a8ddbd646b7b6122b059f4af85c5c99ae8dcf9b4492c642a1374579064a1b3387683bb55229a5026c1f72b26d4556c26d25688a2d685aba52b378a6c2571e4289b451d7c66c0c1fd844cfccf50e0df4611292cb6c421d0a7f3992cbb050ba05a8ffabf8820e11ecf30cbdb67e00192dbc322aad6f749fd761b481008f8c28938773dcb6e3220195aec4da1070a7e86a70d6716245f87a558e2a93f480e03037161aed60342a7b933e3d040e4fa96783056c6294effa79ea3803a70e9f9663f9f5edd6e92055004bc789f2511e3c25c179c9adb47831c2489d02751e592bfa1b28d992d4dcb2dcdc91089a9f426ecba552b07531b566d5c7b619b3eddd93a7e388898390fab709fae7f3512b48e34a5f1db93d33e5412db1b5c28bc901dd9027e08c538070b283d2aedd7516cf7553582606e84973a366e17fef8894b7c1cf101b26ecc7f96f5beda019c055873fd36b0d9a67681047c7d5e71bf3a1c3de129c6a58fa0bb3dabc77798725b09b260e1853f99c41df6f819adfba0d36ad8acd1c1bf80d1fc792a485fc5ebe2ce47bb912782248c34ed61b23aa31a7db0313a54dd998852dcb1c508c0ac685348e12c47551e4f8b30aad899f24666f9b2c9e5cadb196ece98c75a80a9f4ff0aeda65316444633f17ab0e9caa9c08a2d326565854c11380480fd4bc5f7d467c3f7feacbd30c5f0fef34afe6ba70d7ba92ce7d4985d6c93c801cb74f5bee1c84b954faae15486c983725cf56400dc0dc271e658c73377c4a47470b47b11f59bd79b488c535f48cc1417d97995967ceb209d5bea91505a316682ff6334d5db2848b173e3f43dc4f19494500ebec68ddd7e97e988b54ef9bcd9122148ca5c50ea764c4a1c6dca0d3b1f9893fcb0902bcaa11661a81cd96b4e3b868781f9e2ff2d36f897edaa9dd17a50a924f049616695a93452bb98b0364d7ab005416c52e4f1d608b47e0dda47bd2c2e8621a66d0df409acf9cec5fd76b43872c8eb5bf91afd7dc1cff098e195dfb695a7ce636879ab5e90f5590b0bd3b898af6b34f97c538c1b189f13ef405c0de4cef80bffe7b6aa3c94de69d75822fa12df5c980a8bd03a1a8344ad1ee84d7fd6c62601de7910f578e9d4f049e973a7e9191b698ba1f4adfaecac520ee1b37e5ad52c150c3ad4b56bc62b9bf4434cd393efdc8882f2e53beeb8a189492e88801b52e8e449eb02512fb7b5242570f3d1360c11eb4185eab71a58289e250a441a748e0733b58c32e11b28a2afc98e4f9bc009f413f664e894073ad50b1fc79fb28cb0756451380f929922a02a15dfc44bb235b162efb0345603fe2c9f36ab0e222b2308abec9ceac6c504db8d176d51a54734d21c7d80c7ceb9012149cd4e432be1933c80e77ecbd37f99eca1ff25f3d9f21c1448405aca0667985fee75fdf07e3eddb65b452883c6204ffd31a09e4c88be9140b4167fcf18b0b078dd026c460357657a5eca3f00841141c18d0831df820a7ce0521a9dd683e68dc025eca6fa419e3e3ec6bae8aa9d4f306fa487cc226303dbdf590438efc94e5fb933cb93b0f819c9597721c5d937ce267d0fd229025ee0f5463978c7da659c9fd7d1f666ba316777b09bf12bcfea6b80228020b2c1934130c2e64867c1b4719e72584ece9bcfc87a6cafb52eb736ae2c5411e76cc7394ee4c98bdc0dea1b5e689498aa7d37116fd214dc7c748d29753b777bd85f3facfb5ff0ee5fe7ff86e975edcfbcdf6873404e184e9d38fdf41480204e9e1d2be7a760cf99869c17f80254c37cf4723db4f35d0b9437311e26330aea1f3516624f9f1244ee9936913a0c93e3495253aea749e6bc413e5d231fd2406d2089512fb54a3b99e79a236d8ab6768f2a5a88086864b075c80b0aa87f3b17e593628b819f5aa0d39fe00f80ad2e71cdaca6c2e18bfea493f6c11d57c5d43602310a4b5b606cf25cc88cfebfec793e7fb7c61e3443577e6300b2fa25f0513bea128a2f82bbdc4bc27d724b61d74a27db0f2c860b3da70c477e93977513f4f61086dbcf801fde97cab0e151835cc5623a213305488b08cb66f9bdec7e0428090ffeae9937887db37d08dbf457211e14b8395cdb6143a2f779960f7bcc6f4c34d558ffdda3ff7c84c38151ea73cfbad20c4b091e76497902602003e98b40af7703acf96424591959413b4d5adabbf551475f6443311c4fe018a326fbab091ee117f7a2110ebe9d80e3a068e48bbf3757888852e75e643fb298193959887eb0229ff633f57158eaf9dc5053d88e8d169a38b4469c4ab6e7790a1b473d21995cdb92fa418739ec69a5fbd6f7c3978e7ec305fc7bd20634c53bfc2f7e278b196d14f5b2703cf3100b09d70b74699fb15fa46d9498e092f7ccd386b3a5b9bcc0b0a81d791e8583d473fbd16ff83dba575e1f0ca3825d3670b91808a4184398f565f1a532bc3f7561cc5bf528e515377b3e985640b4768ac23e866782016c87bef059c7971293ae041b371ec34b508f78acd592e0177c6aae6ea8d5bdc0506e8ec1377e1a2b93cd90a3809b6f5ecee59baeb232c9b339b1cff87184510adf23d54712f6ba117b66ba4c1a42d6fe007628db0d215d655247607a3ed623797e65e687392f616bd98f307fead2ecb6724cb9aa28b1c01522efa64d9a170b27b6640c2ffd7f7a7fe4edfcb012ff4de0541f02e70d6288bd121fb77130ebcc12a9b2cb3fe251d3adc444ee53cf5aa16b4186f9c4afab4704658123e9115f5a54c59720219aea96bc924415b3e1d3779a01c13283174a2ba6c77bee2113b407af92415ffa7c39e0312d5c2ed17525273247c11122bf6decdac60f1693ae194deb7798e1684d38ab273dff383d2b77644a25df06dc96d27a55b19662b0ff60547286251d5feced5daa577e84d82dba4a91265e8f1f5e51fc66645ea25a19b991ac06cf6b85972fc06238d96158e4e7195da10316f3e2f34d820307097fdcd9b78b4f94016908f2b211326bbe1bc77f241f2f36f87438dc07819d55e96f0c09acd48d920ada79b67ae7c46a5f3d1a18ce960faa2005dc56646d9315241d2e136d968f25d47697ba5bbb062470fbbeec7d0bd13c3bb2a2704929a888564fee1e056f85a9df3c94d4a2c27d4ead6c4d81b27059e06a4ef968b0a3f977f4a960a756a76ebcbb0ba8597f65d24ffa226633103cbd98f8dd2249345613cda69a34b6499b96270d93e2ebaa204a7068b1e9b5d342983785d917f61ee8962d028a02008a0a19142be358e68fd6f2b8b720aa6311415be29f26611565413019ed94901f18b5e405684d4ceb86652b5a94cba9311b1db19e77909190faae6d0bc48ec185175af904e151a861045f8394e0b95352a3f47453e959a29aa32851947ede69a9ffa5fe33ad63e2308b4eb5c82344f86fbc75ce9ee233c99c249eb2f16d8b5d7ed85b0bf2c3579595eb907dc75c13fd57dbb0087b997afd9688eda9aaedc154a14b5b984468e90ca2374d3cdb21d7ccfe29b61b643cd6b29c9abb50f608023bd2bcc6b64a2ab9c6843256c20bbe784631da9c2990b208002619ac4e8a01f0e68a911ecd5d04ce5edab5c9f7b1f7577576f60cc04d15068d912f33a81ac29cdac6292761e230808f366b6e6954d037faa2130d24ba7d48b660c2b871a7382f6d74b2793f058ac7fb2b8c5e24ca57cf7d1443e30314e20a64cfc028c65f069646614dedfb46f1d1c086ea9a51546f43b0eb3f11b974440650c5588169e2ac910e2ea1b6c996db73bd7ee9c550a77b1baa77b9ae1f0d028cb321e1017ca1b951fb4e527a55e4e1b8646f9805f998529bc6f4461db61389c122828c40859d4fdd5828434960cabb16902c902d8c8c36d56bfb43eb0ba0dec908b5e4da42d45963fc11b8597ef2d12ec54a3b1041c827d97a84381a70eaec4821cae6a8f82a0a24cc24dbd3455e5ec2094af214d22054782a77e0550b05f3a177e64f5518e613fc8b09085a791176ddca372dac4a03534f37bd59a11053814946ffd9818875705a38e42ba0a1363dbc87088fdf1c2c364830a590b5aeea8bebcf480f651ca2399a33aa841fe77cae1cb31157f033ad66a7a264659e26e01fd276b761ca56b2c2d3c69d1bae41fa81f3d3dab5893960d1be8fb52928ec3945086d483550e405d6ab3bedde4521a15e470e3185d623ad9d16db692c2f5e7964fbd44255bb2aecac3766afe77850cc19924d9861d850fb9c6e476bc5ac86231a3989347294ae19e653ae7c630320a107b16700689b68", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_TAPSCRIPT_INVALID, 15, 7, 6497, 0, 10);
    Test("or_d(sha256(38df1c1f64a24a77b23393bca50dff872e31edc4f3b5aa3b90ad0b82f4f089b6),and_n(un:after(499999999),older(4194305)))", "82012088a82038df1c1f64a24a77b23393bca50dff872e31edc4f3b5aa3b90ad0b82f4f089b68773646304ff64cd1db19267006864006703010040b26868", "82012088a82038df1c1f64a24a77b23393bca50dff872e31edc4f3b5aa3b90ad0b82f4f089b68773646304ff64cd1db19267006864006703010040b26868", TESTMODE_VALID, 16, 1, 33, 33, 3);
    Test("and_v(or_i(v:multi(2,02c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5,03774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb),v:multi(2,03e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a,025cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc)),sha256(d1ec675902ef1633427ca360b290b0b3045a0d9058ddb5e648b4c3c3224c5c68))", "63524d210a0bc5a4c9ea680fd0574b0eb6280c3dc439f0edc0ac27a89090dff3021af9dc22c899734ba9aa5e4a6d7f4ee563564daf2df21e4c49b155dd08cae6d583add14c5bf4d0a8f4f19a5501ec9cbc50eb35db034387b2f52ac43c5372d1539d69d53c27d3d672edc6aa6a54711725e223c13531208b7d0ffd89d0fb9e034d7ee1a05b6f19a8a96c47e25992d07516a90e12e60cfc45f09d53ce455b6a7eaa474e6ee0f44946bfc69927b15a6124e9107ae0b5455306a7965bdfd705fa756d57be80ce14eb139146eb0358ec843a0ab91d77d119e77311eb5b20b6892c551ce2e10c031d39ce2e83999b19bee0c0a76f1330c0df7d024cb8a3299de8762459c7a6f33e40a20893455777428215c1b26ced4fc7057bebd406a1580ec7876b860f48653ba14bc4ab8df32faaf8b8604a84d5a69da3b2adbbe5436aec57a1fea3491c1e2253f30de385a291666c5db01ad2c1a8d9bffddf2bf61c5db5121feaf517cda9c69d8a6f5ab9d99aa54e8cf730f935828783616fba186aaa5324e4e82516ee6bc3e50cec7801f3efcc5eb79a7262ee3336d3fb85f80742292788cfdbfecc9d7ab8c3ffd8d1b7800e78075bbfe337150fd6d29d53649592ca72f57292d7da341902dbb28133110e3107c13c114fb9cf111939224a50cdcf61e853f716fb9b2e5502086eb676ff378e2a19d7702c0119619f762e68aa04d5444a80a12cd8f864420e89d116863d4995c5a4b3d7cea38bce674a25b4f53026d27921e2e7f7c580e9c5278e96a2eb06ca39685607478f659df8d10fdf9d23c7bc8717c32db13dfce1834fd7e64840632fec4fd163a1082b34cbc7752f399a16881b49d2844b16751d710f6991a89a121ac6e56407d20a0a707ec73e0028e2b0214b7fdc559ebe720828e3e393f4b1976b05f02b05774cff49b8c3848c0fa6accc75588cf0ecb031b499819b32b18dd46606e56d1e1e32d4c849f34a58d73cd420f0fc9ed87470e461da27d7997845e7ec02ea6800e9add5187302f00f088e76307e862832ec2937348ccc00d6b6e06814c975b588e868514bc0ac35198ceaea0c3db92f6875eae9169598dfc2207bca4f3412fa7f8bec7d4af39c57ae72619fc068f820afebf7e100e529575de7a056399a0797a3951f661560b2a6fc4d509fc2556fab29dcb2be61dcb36d662698653e351075f10f459aeb6c84660f14808d50060fcc1cdc2604e44d631bd8bb8b3da026e34112feb1f0812f7bcd239a0c9ae3915f6daf7c64a3fa289352ab4a9cade36b551c376392b88de27630c09ca421c8f3374745ba8f99552496ca7c0d99bb5f6dccd1b6fde8ee47654cc330f368b1a22f2d26d8ef11877ab40fe94c05a7c4624ce37e3afe6caf705e4b645f8d76439ea5e497593c66c5f1f6fbdb01adf84388f99317c3b0dad60e9aa55014e27049d713063e90e3c5bd2dac1931596ae4520bd4394533d17515e5624a1960b50f7eefb0efdf81f9701bc1c1201b7d1076c00f30c1ee4b357ed06fe92c539971e475f49fcda4fec4eb68949c5116ce8e6549f0caee7c96348e363fa3380238022667d192bc7934ac301c1a5afe520151f836a6820e7610f8e51702062da68db0f4b8cb67e09a37e3212b1049175ad80d0d7290c45c6f175b84907269e12a09f2404ac5ce30193ab6945718f6b124f97cd9f9afefd12cdf169264e0720b10c09cbf2b7c3fd3afdc8f396acae293d5dd56b0e8eb82bfaabfbe1ecc3a2e160439da2ed3279af57d6994b177ab9991e39a68aef99fa20082886c00e6c8b078c6ba9bb81d53fbdb57587c7c471a76458c734bdac61097bd6f49e3067b7cc5171673d7248d6afde79267e0e36b4ea31639e3a507f162d91488abaff15771fc4932a3c8a53626dd2eb41e9901329a1006371c013daca7e8ba101c1f12d2c92637ad1027ee1ab3409c37947245c4f09b8b672c958e433dc7d5dbf41a19f33f00b05037cb22cf64a566e512beb1c1dcbb913b8e838fba6e667a90682178177595356b4dce03fb93a61d3839055b32fc533314f0ca999051a8db6193d6559226df7a379939bcfdf2f299831f031521d361304d2d01a3e7392c83a031cd6cb0468048bef0f11771f3fb8a07a88c7295466eb8656cd8acc19dee6e3460ab436559ba58d14763065ce52a7a77189756e19dee2de9beef11d269a04d0ce482f0ebaed1d5d1396bf627d12c7fac90251b8323c53a2e78d6c2441fbf7ca978a9f509fb29454f5c3d8a9c813884b160b1a3e964bbb1cd8b5ae56bd4024e6ddbb72572492aed1f12edc97e5b055cea630d8691f399db933f8efb61697ecfa328ca48d754f540f4a157219445ac80c47a0adbd7c5d71ee26e163db0d01ef867633ed0d96b4e3dab3e6c584581ff3ae3e95efbc7ffb8275554a5522cb06b655741d7759ff2ae444967556afe90c6aa4c06e62a3960f3697b0fbd819328d69d5a3b684be5a69358327fe8801172672a5a33401a02d6ed92c425b28e21d543f2a4bafbcf382061c3f42b763134985a6967e0285f291045f798361388e3fa259049bf2c810408f1dc3829dfea482dd49763017de71ee26c0d9332888c10d2198e20ad50ea8fe0d9ecd66bdaad844e9eadcdacb40ade3d53366256f1adb25d7e8a38135d565eb21f309b2c10aee74e8c8dc51f9c3e9355a9e1f2ac253b0742254ed8b72267ebb1d0e9166c8734e7654ba0d8da5720fb76bc8d03307121e65f6bd8132deca80bb117b35d8d754ad92a80108a1f87b2e36fc7ef5b1582b388e2c128345442e221d8af5a6868fe702b8d23bb65009c8ea4f9ff85f7b1a459484c7379952203f44605a983fbc3237aebfa67fc00c33a4905535421f601592030e5a8c754b7722140711737f42a667cd2446d4a614d8ac9fa4718aaeedf4021c2a31b04aacc9a643f702dd06bc2ac364f4558de9616260f5d51f6c26b434b923f5d507ea67bc2d8331fee6665a3a2b0270bc2ee08b840b232d52567fd6b1486f0f47e482507c35cce171e058f3fe5744946e8b5ffbaa9a18a40105cc01c227d2ae84efac5a57f11bc3d316a72231e917bc9d4071718117789ee758abeb0776cbbaded96aa04a162c1275156e91e3249715b00be4570d2c3ccfe98094f20af0055f8a0afec589b6f7a2c5edce7531a2608256905d675627d2761cab01b1a53a14e3deef9e7d6c68c2dc280930bf9ec6e5e0832bfacfe208cd52bd1fa2488e26c411990ecca2e71a22d5ac59ab268a97cd42a96e9f93bf46ed06b4a9d36cc8511d2887ad28af8109da050cb6cf23c862f25489e1598a031009041815c7a72a7f187e0a73e27db12a60fdc34f01e01c9c1fb7f60d33152f2dc360a9677abb6325f95011975f709a4d66ffe397fde004813691eb7de39e72109d0a4737681631fb37f3ee5779944d38e8b2bb55c5659689c4272e5ec112b5461ff10451fb5b71df20091ddd2c9dc9fe8b9e4a0c5955b61d8c07c6ee0ff775427528bdaa808e3ccc373e948ba10be3e80660b113a1005daf4d883de14b6db6308cca28cd058715704ddc5bc70084b4ff198cebae2445bb902719f266804b50eaae716edcd322b2aede1a12d61f1b4f3a22a450881702a214f6ba8d5deb59554105bf746b219ff670bddf99c0383df8ba9ef2931d72943bc721f15b57270d065bc119e60cd4d820307099e0690ca67d217123aea048447c06bd10aa6fb644da00ad306892bdf5d81953b2a5be2289c8b287fa2ab75dcf2981c18f147cd826550d3677a825153c9e22ab50695a2591432b5f4ab87aa20b407dd4ce126ac3746dec4e5792fef33091721b9971ea39ea9b73cc11404025ee19e262037f97177129ddf7a213df71098ce574c1b65c953c8acf68a9b14d8d09015909a90681d1aa4f52a2b519887313c565169222be5f2110119364e955c9111a8f7a12edb238a9bebbaf655f4ae9c63b8d5f09027256fa4ae6c5270c5beb6e16af65dd88016712d4796dd73741a7cc53c86ed86304a6a799b5e54a04670afa1f222492e4b7f95411b8c688bbd0e2d303e5a740b8d810c7adda0566b5e95ce5b07934361bb2430f1f1e1c991c6a78757695776f2a2916d0e1578e5cc83e21e3d181699181c63e5889227151204a025d450b0f5439fa53a6016eb9270bb9a3de90420ad8678ad61919c6013d091a24f209b4501e530adc89f4e421e3a60984302b4de17f3ae8125360e749853cf7405ddc18152c616415c93d9439bbda0db934f45479b05954396427556c529348b2c81661e4f72324751aa048b0a79c4d2bbfe3fb9d9d99d2879e787e5668f1fbed7a5774fa94f89c4d6295cbf7064a4faf4a19136c95302a959b1b2e0cf9a8dd1cd233430e1bcdafa28add9c1cd68146619b104f3677d2001fd0a6c90610915a0da52a72d393da2d204088d84f5f64ad04ff072b4ec858e64671266aff579c005bb11bc9284e6816965a669659ed9bc02e3f41d51b474563107d544723bc03836c624ddb9a92f003a9794aab65dbb4cc61126cc2bc87395525584ebb097ab3897610481071b1d4bedc599ac9a4d58d598a38761175b148f36e89a9057dadbf6e8132c0b6a91e2a1ea8c2dbc37380b9c8c156a23a23b598c1efcb642384960b3602ab834918e04c2c0b12fddd334fa311578d5b15b05df51772e232fd09348522f8b2abcc0212520525a75e8b858409d193e9e6bbca5ae20d9b89a20ed0b7bb9f169819e09652c287a22824e332ddfc5c718ca4d521e345f97989f75f804064027669e2520862ed1810271c78fc11699a490bbb185033602a2b7dedc57140aa3c19f910d63b053136c5cff9141c9d89d5d7b5d66f6552d69814cfeb2050d00b12e3abe7842558a021adda24ed5fd4879b8d64f5ff1281ed047835eeb309cadc1ddda4c6cccce158221a215221886be2eb3684ef1b8a8529e8e2923b1d061d717cc3f095e59f252af67524d0207080a51f061a99be43b1d4452bb185cf1b7894b86d0278701ad5ef2cc215f07e8ea0229e77293acbb33df266d6fbd56683352875b50181bb90cf68a802d27c2d0c87d8cbd25e5d52e0bf09cb6a095a029020bc7dc06848be5e05a4ddd0596fdee40da04ca66e828c6ecc23f7ffac92bc6864cb5565d6592c3a58859a8c0a38e7791929b5167693f284c05499550ee6e4d30c167a230aed851c713a4eba8f4bbaa87c4160e40f09109d3aa045803c91dc3684b8d31fa72dcc68f26a3f50801ee13a960b18a4501a640ee55382a21985df6f358259862d44654a22185859c61eaff1da06f4e09fbcf2a93a9916422c9201d8c42f08abfda921541221ad017f8a69c6f641890566700c4da79ad25954ca92529cf3bb430d97ae5d1d7ae39921a69063534f04a61fbddcd77d27803bb93355b94faf8f15d0e26a2f50a8f4d11295087665220b82382a2f144971e26dce590241ccb6f31f3d6c187f5a39e2bb49066e93bf8c1152eabcf2f1cc9f591d89514b586456e1a8c1b4909083d6a66a97648a0d289f854cd5e19ebd51c718efc5acaa4c77b54056749d979148a57f9c3843551481417cdd65855a1348339235f8f814f5a99c96e5a247b3363dba243c4a6791d6539752c5c60374b009b2da564c853347bf84aeb2497ab9a59a29b51e5f35d858cf3bf15d475466708b0d36957811cf0dfc808757645f0badbb20c889656a9c1c16302cbcb9563d750ca3662eb11c2764ee4476dcfbb60d9eeb701d0feae0803a21e5003b0b6772719a2976b04022402997911990a67a184f699700a4b190ba253e14f79c01bb453226ca4ec9eb88be2c5a73444627f2a35f8e68b6d4d5d425601e2129f983fabb791dfa2655233d22b29593ac510e19e2057b86bb554c88e9dbe8dc8c598013bfdff82eacf9b29b54c65fb03006bd4d4327f5b87bf1427d973575678b6b301b50b80bf12ac508d2f820e7ac0a44bd346182ad374ae95dd4816c8965359e4911613045acdfd077db308560e3956e51542b5a822357ad433e946099fba21c35a9bac4964f2917314de9acc25763fdf3e7ab86e620324c520ce93f1b6a41473583dabfc4ec2b1146240b4ed0b63aaafb7fa0e2c30452a88678f1a8914549a76e9e51ac50ac6b7dff45c99eef4854e6c712edfa663911d355ca98b7c6c60251446b32e6bab863e66a77389af7d8afa51aeebd813ac0ba313a0fc4400fe226711003b22639aa25ca7a8eef7d24844b78d310b37c0af5d154eb7f74e1f5861299d336ac7dc0f30f63597a2a76c2e29283accf16066ddbb6d1c5f123a6797d6cb4062965ab4f42bbe745ed6c3ffc20850e222b7f98c040496cb1990ea05a9f571a7f215e1400e009abf68aa229ef59a3207d149147c2aa46aa302b58c4528e8032105f8e247128b547a9d618fe46265c43b21fbc31d70e4a293f0cca700dc196b7a4b8f5c72680508a26274aaf0454d1a4a7b34a3b3020b7701926ef1932dc8af113818e66af2657ee3d86195a87d609e61f94b57bbb973b71d830097a5f268ab9c8d767cadc70242f483a44cd485d2d5576555b2640cc4319a1bd0d0c90d7dddf7a7a0a35e71fc3e22658bbc7a58fd0a1b19b43ef93846cf0bbc55902c931311891c214f028e9938a978efd52d8d197c4289fb330e68639c50ebae048b6566cf01b28faaa75cefc8081a47063507f11c1c3022a844955d5e3b3674f184778df70df150588e5a43b340cc22d563f02ae1b6a5d6e0de9e6855e5fc654772f48d97d7677e6ee192210a52512c05f800cbd3fa1f793dd42b1a98a6b15787ebce17a21c24e4baa14d52f59f185e6b467a9120d3091d2aa4955ca36d53946ab4b3a15c67204a106d62a0172918a47ff9b85cda19149944d1de790a244019f8129d43c5d6abdaa9a79ea6db06be933888711514b1c9be6faa7ab85deefa6ab6ff31e4244346440d8ba11503a31674a23d6b6d67d859c143221e85718fb2000f692bac68670aef959d28f1db2c994045f24277981605be01ffaa264194bbb26112696dbb7841eaf8b6a3c353d86e24de038fb4784689eddd4234caea7b218cb71e36698ad6974c68b173102319f866b5cb7574c06cae201c4a3957ab10f835077cde40b5c8de7121ab1f87f08220cc00b941aa94533400df84daa21a2b91100204057359077b60f0f17b28dd83041240721b1be599a2d3921980dd4c1aa7029f9bda5e0ae77a33495f06ee1918ace2d9adcd5d54bd18c105098c01fb086b45700706fdca4778618842dfd3550a988d461d9fe96d181de6971c380300768bade39f49d183aad491c596123419ca9b2db3a121e3120e4d81f1a05bf81135a2c6f067aa90b110f22977ead3e071918b7a4d628609d5ace43f97f922a1f1650401e64beee2f594977228eeed15a05c9a7a06b5521da93c62667694deeeaa29acd5401c6d5d361953669f149d83fc283789a7b05792e5a1d363e2675ca6116ce8b204429b47f39da65b44c7bb7dd53e8f327b53aed4772c9441b418e103a0564ce03159464d2105094e5f8046a7af0635cd8c68bb8fa36fd980c696d115bcbe685810e80df5d121402f3a96f2ecc26c2a798e2a26e53d1c113c05638b1bff08adf132e00fde7426f5c80859ccf954c9e6da1455d4a9594cef1b5537616c500e2d50a1f7a3b52ca09568e7da371e1ad72f9d7baa37a3b06b3c27cd9d5b93f5016bc0af0bd738a48f3a94cbde458045127843b767ac01dd101f47eb36b7227cf451b33d4925e9f2b499a5521491f2a41796a04a41485b7f59d4104bddee5b8ca98f7f631e34dd4a0ae2b6e835d856b58cd5e4645ef9b17a08c35de3e878dd704fad9990f62c45efdd617d7188bd1165fd4465fc2ee91189f0638eda99d233788de9f29ebd0a49f5a927ba92d1ebf5b62433f43f8e15ddb250c7940753d5b223275f9fd3c4b45507129d06a3d08d0604e8c6898f3056dedd1e8412fc956f74b441898f7abea090b12d47f4a98d6c491b6c132336b6880470c63834bfc3d8bfc266b7cc3c94b49182c35ce2470e1ee7df00dc5623e4d2da30f682729daea134afa1a6017204820aa0fa2fa49f504188c1a39086ad026e8c11a0c999e3dd450c16a488a9893f2734b7499b4bdba4f9138b9aeb549727b438d4ba56a6c771a9e4d56ed7d32d56a5bd9ff606d10ef4d18a7c0315e3f0d6f8f71b8d9daa44cb44c27ea2863a8e5cfc2ea9515eecd90903ff7490ab2860c40e0bc93438e22510f27433d3826bd8574f013892adc3ed0046ad0e38e37f48965a73db293fdb82af7898b1027dfa7640da1443fd43d3b1cdef07af44a264818236844cddf04bcff2f983d64d6ddb864a55a8e12310c059ecc5757f3663a1cc9843733b2d7087faf9a96907085735959a42bc0886518fbfbb336e4de31d53972b20659a362dbfed5af0aa8e95c5ef84bc82711a13b917142f993fd4c9615c1b03b1f3a23ce253dcb3bcbaa7a37096928787644585c55b78927a506702454cef40cdbe171d9fdcbbcc98363652165769f23de9416abca5e3419635e19317dedb02f040e12ad0905286f27c357565570ddef419012f9ea91b11d1a72557297dc0f424f4a624450d8ecb12938c3dc56043c4ad8b4fdc7535a767eb8b16e08e069a899725950e343e6b302accfb8927ded468639e657fe0be59e13b25c8fcc98fbfb2371ae472dc02a32cb356c3080f34b28cccb7c5733881fab57739e0c9aea6d8f22866e6ff69e594a14121244bb4c9aa8a0d82c7a0e4cc3e2b78f35152faec19eed77bef87719423f3e12da57fea53f1b15d8af0a0eac5b752898a9a77aeadbf95746bf576c1627ccaffe571629ac2be65baccdc59a219877ff33b9715e3453c7e9da61540f3d5e3f4bc9d563cd9a131cd9ef261f34663e235bce121c7c0f67599e9d5569d6ae76c40544c671845ccd2bee53fa24f8d1976d695c9021d03872376b8ea1c3b9662e69f6b8273bf221ec0ffb3c6f1a02934972e032bc9eda697213849c32f0fc334f7326daaa1b3e6112a5c77de2211f51a7fb33b3d86db9410bd157aedd5a9de27023c5e3165bc846483717aa5955032fdc27839dd12a7e3f4d34046f635e7cb08b1fc1ea9bd646efdc891a226d100b0b34741dfcb6623781df1a50a3dff7bce300de4cad389d5bd8faef58c573ce14bc17257f9752f20180471da2c48946d0ab6a724f6ceb71042ad5fb660fd994d995c0d4a6742cf6614f46984bd5b6ee39c9247a5dcb87ce4b880c8f79e5fb0d39d115bd769b40f7b4c12397a658d7d59afbe8e3a28653fcc6cb49c9cf41d5ecc762882e82ab033d765a7666f766e8e0c1d2acea221d53c989d74859e71cc0913204f0d88ac06520c9bebce32ab73396cf78925f436db5294ce6072c7ce7aa6695e52af6882012088a820d1ec675902ef1633427ca360b290b0b3045a0d9058ddb5e648b4c3c3224c5c6887", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG | TESTMODE_TAPSCRIPT_INVALID, 11, 5, 5423, 0, 8);
    Test("j:and_b(multi(2,0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798,024ce119c96e2fa357200b559b2f7dd5a5f02d5290aff74b03f3e471b273211c97),s:or_i(older(1),older(4252898)))", "829263524da1070ac3f4c9d9bc2c0c573cc6f8028a0f90d028c9c6a4e1a279f311789c08a2006bad431229aa4027c18e1d47777b3fcd1e2ba44e562ff72df331a8784c193dcd13c6d025bbb3218fea954cac794a5936250518b74a819549d5021058871c77419e81a1cc983a662a59086a26aaae8df2aa24668ac7cdf73ba0ab469219ee88c837d73fbd3a846decda8e21f484a680cb25764bc78dd8d452cffe271ac126ef2b71adcf0925fd39b00764d5162f94b08e7abf62a0220666871f4cdd38f96bf8152d19c5199cfc73a5d017eed2dfe607d226d6586ba0a474d2da2b720739a77765b8cbfcd9035b0ca50c665cf74c42c3cb7b2b29ecfbc05684ee4d593ce204d5cbb2af1929d9e4dbad57f57e4dbbb6d562a9d6876449c0892b72ccff363c649345578ac9ffb9cbe79118c4e2fc8611742cc589f77a23de0a9731a5c6b492831b3e2dc0c90209110641a54a98bae00cdce6ac521e69f11d7f30c2c937bf1b152a0e076bb7fb2c2cf00a9335e0f747f9f3a8279f1bcdd9f8d489483f5d489b81c6e439bbf303095fa46dcf9b1372fc8a297ec616add90a5d0e1b65534ecbcb8d71590012624b183c7e53ec438319f57edbcaba6689c2024d16aecc4f08e9faa9eb80f526b05726a41d98748b6031cf7a0b5839021ead78e2b3602090cdd4e2b4370074ac69f5fc31ec1d6755f4e8eeb9528d9c96623ac6c32f71620a76b99e63fdfa94e11be8197f264365ffc40c0b1ef1a47efdaf3125146e728a64ee9a09b4ad2d148974b0f6d581e5d70b7771e28c40841a624f6daef4dbe7f7f778db56a8267817ac1971860ef8877e2fb2ed649c5553f2a8fa05a5cef8241fa6adb6c2140ca8e438dd41f2fa6b779ee91ddc9f31ce27cb5538b96e24285e8a9e57184c750e0aaa7447a8e515dac886a0e51b5c7d09256de331626622562ea559f761d2ca634ef5656dc82e5e73462e5a2d5ed2eca446c2f842500997a1153f0ddf28a10376743f1335d9a18cf9a32e38c3d78d77f29da91d22dd129ad3ba468ac0b0e7ed449100cf58f7e24c422cda41f5efcaf25fe9a78e28538d5faa02ee8a7d7f10c79cbbed08189082ec2d7d02d4aa69ac9599e62fd9665e04e68125103b97dcbcd984a08da2645c392e8de04c98bb7d8ee822ee519f02c233abe67e1073f22459dd69b74eba83265e277200cbc61091a2a9c9bee0db150ac4506159f490864e8c7f235b3e8ef95f14be5d3becfaf1250f91fa5794b155957ea4c84e35750c9ee61f291971113989b9100847737599e33ec706acf4442414e11f9bdbcda3be0784be55ba2aed3331927407f31adcb48a8a4d84e201c836be9c3a30b343a93d4462a2fb84c2cec44aa39f9675f6b820cc8085601b2c813a197e4742e7535093a449eb5d3298471bc48d066de6f8ef8e23b5962fdbf6dcfa0add28a837b5888dd935039deca84dbd203e23794a410ec2e0dbb6a31065e0fdc50ff9f01a9242ca244da43ff9b6dd61a747dc1030ed65e370a8bec645b0dedef7402e1e7ee839a60764f82c344b01390905fb606178b0b851ed6b00444936db27fadf4ddba1ce9142959aae539764d614c54fc2b1ab2bc260020be003336547bd59e8fb224845e51fe352d47853aa916a5c64c717a33f6c86e3954cb18e77a152426890c7abe4d79d6bb764d98414fcb489081bb51f6b6690f319a97b02016b4abc6a367c8ab132557f02e175bcef1aa6b2c28e04b905e8b090c1d18aad23e67ac4353a2092e43e125df5a0ffe8d5b7f5398f66050b5e18f89372f227385c9d97013a82531a957b61b677cb862b73d3ee4e5cf38bcc09b9908b7f6589a42ef95ad12166bcf5cce8bb73f9b8babbbd1f0d8dcbe851fd932a8a439a08ee344b7b95da63750a6a1db7f6d15960190fedd356d77f5aa684c1a7671afa78e0ed987916a4e8f41a5d72f864ae45a497157441a9e02c30b9331e27c4b39c9560b8ce3495ad908106729896ca427f4696ac7e05b2a2380407364d7f1aa3602e07a9c9790966bd400c436f6e81f98ddd01059e1f6df6367e81b9a88eb2358e7353923713f2987888b6cbf323e435e4e216e726d715263c5c80c293ca96df40a99768cb07a26605976ba42f398c1d5fc21367173005cca710b696fa0457f87ec905d789feea133abc1e0260d3ec246ca79e55142a11604197b080caa04e2b83d5884301eea04a3553454339f45d91e88fc6f09bea3f8165a5ed93d9c69fdc67bce75be1b574237c7fa93f91a27af9d391bf645934922e923100c3fdf71a35284b80118d43d4bdbd32dd5b4b2dfe55e89f646eb0cfa684abfd3401f310b4fa7008d02387a4c318e97e07cd06864f6b5368bfcd31850fc70ca77ae1e0e5b359b13279b86eed88bd6b633f3b8085f2e1eb0b4f52ae8a0f1aa491e5e74f93e53a26f2d9e0c359515715191072db1866f764c940d1cba4693a9aaad25b5c0495f711af0a504648645936293a29e99c4b65d520c572b93282d2890c3dfcae83a7096c767e2def894f64a6fe2dc967aeb28d7bb1eb268c5f93f07addf0d7e4a8bfb994f729ad32c9ca5514e10cc623bb52420f167079053f962faf2bff5ebd5f4bd3275ef5a75f4b54d404a5edc474265642ba8c895a66a3170fb357e070b7edff78791f3cccede43a8f42ee8cb45393374aae2484c617e3f53ef74e0f44e602ed327408849fc8307a28e5ad0cbdb09c16838fd6b3be2904b871c125ed5a2368548586f5f9bb857ff3da305e8c692a3dbf06a4ad19f4704d2105095e274b4c0ef1ee27925950da30f1cbece8483af76c86f3d45a0f7124df6ea8369e6f25d2d2b65f9bb1e48a3763c6c5c8c6e3b912a342a1cf119bc255c2779e562cbe0249a02884d09f9e75e32637b321c5d31f9917cfcb32a8ecc40a20aedbd7cc2deaee09673c155acb30aaec55ec70a90f13b186bbd720409132cda5b3394277d51acc534451b737e40113a236397ddc3a379258037b6a62c6f4aa1c2765dfee322fd03cd269c0ee7136abccb9af843feac0c0aa87e8f81e353a2851a1795b70e0aacc2e3b06b659cf211a6f9c6ccc0ffcfdc368faa6472052a6548d9c8f50d02ea2b8dbee35cc64314367608e1d8c04e666fa3b117ad7ab04f001071a58619f3b71b147e1d9b4fd74d8beabecc584cb9d51268bc5ca54ee857ed55fd38d27c4070d563f73c38527936318330f9062f4ea3304e46e250c2687794e0c3ada0dadfae6c1970d746cd710e96a625affb890f728aae9e7b8629b306d960133bc0df862f4973e1ae365b5fc883c47c65ee2e243cae5cd55065c94713a811460df7876811d92db6e85ade282710e355646da3b0289095333d53855b6ef144687a6d8fd535d270a29c2c36d6e82fcdcd084ed6b6c09c9dbcec4019992e67f7f5ef0a99086ba753e0a8d040fae9e39b02cd249c49623b51c904f26a8c90d145398e45e085ebae35eaa41a07747b9b66707d5e69fad3f897256fd9a3e3eba39f707ed1ad5495a4547ce97b75660cca8d95dcfc470e4d30490c2ac86198e326a148129da665b69d00ef1a0e3edda3de6e4bcd6f3a4c7fe686ec0b59c9e30124ef480fcb66cc982065d6da4a5be079c6c0028d8c897717e3b0c7033591a0b507db0f5a59ff32e7aa4fc4abb489d69da77ed56a546e0008f223d6b8b94b807ecdef1121cb047a297fdab9e65cf5fadeb58f51bd11719d4e0b3dbd523d9f86a20c40730712afa1aeaf0561aea95b926f0693eac58bfe6d2bf6b8212dc7c918798d44421dd530db86a994226d6fe7a6e2f996e4c73e8674be997d572d34b002298e904571c9e320b1dc06e39f682f555405f0823ce65c3f89a04328eea437b892c3ead617ba92d65d5284672969e58966e2a4eb812dc34c49f08706b6e09a5761bd322a50f333dfa26d2d8fb59bc6fa442accd0d6cafa018983c0a44429cf8eb90c5c81ac955dc7b80c6d9beaa0ca3ce148d6e86696a3351cb5baba967e30d141a8869af1c47c8a5f478783f8a14fb7b9f12c844ff9abbc6e7da0a56ec4cde1db095e5e19edc32c4e67e5c6aac4f475a8bec7c9c9f1da5011f4d8657e41a7601a07cdff3a5a9f64727cda4797095c6ee8a17ba4f0af4a67191d1ed3583a0a459495e04e74f73d6f0181b324c6a79a38f2c57a9e502be29f7958ee6be5fca87f6e07a0c07e512fe86bf912cd9a73e5ae42dde488d5ddccd27abcbbfb292ae88933beb5ca845889fb07fa27f6040edf3d9d0d075c1c5673df7e55bc42cc2fb783ef82acd257de164f17827949d7c75de09cef94c9afa5fb18fad03733d1082349cdf21e2ee8fe5d00f9e3efc50a7e6d65cbe0ae0f3de471b419c8ffed4328db676f65f8192c6250134cb466189487c53a9fe16180ab07430a9d9c55851590e38a7ef9f13c372aacc8db2b9e496980297ee957bb2a4156a0e5a424b83d781dee6b9b2f94d451833ecb44f9895d68b1d3956c4edbd8dbad89ab1a1201048e004aca50439b7f0479bfd2ac4cbbb6e9bee587ebf35c362516e688fca5d4e299be6f1924feaca51df4067b8cfa3af57047fae7fbfbdeae363b27412c992d569f407cf5858f3bc90c314fc617705258e2d77bff01146f5a80f94df09db9608a4888982d2e1340b7b7be752ae7c6351b26703e2e440b2689a68", "?", TESTMODE_VALID | TESTMODE_NEEDSIG | TESTMODE_TAPSCRIPT_INVALID, 14, 4, 5740, 0, 8);
    Test("and_b(older(16),s:or_d(sha256(e38990d0c7fc009880a9c07c23842e886c6bbdc964ce6bdd5817ad357335ee6f),n:after(1567547623)))", "60b27c82012088a820e38990d0c7fc009880a9c07c23842e886c6bbdc964ce6bdd5817ad357335ee6f87736404e7e06e5db192689a", "=", TESTMODE_VALID, 12, 1, 33, 33, 4);
    Test("j:and_v(v:hash160(20195b5a3d650c17f0f29f91c33f8f6335193d07),or_d(sha256(96de8fc8c256fa1e1556d41af431cace7dca68707c78dd88c3acab8b17164c47),older(16)))", "82926382012088a91420195b5a3d650c17f0f29f91c33f8f6335193d078882012088a82096de8fc8c256fa1e1556d41af431cace7dca68707c78dd88c3acab8b17164c4787736460b26868", "=", TESTMODE_VALID, 16, 2, 66, 33 + 33, 4);
    Test("and_b(hash256(32ba476771d01e37807990ead8719f08af494723de1d228f2c2c07cc0aa40bac),a:and_b(hash256(131772552c01444cd81360818376a040b7c3b2b7b0a53550ee3edde216cec61b),a:older(1)))", "82012088aa2032ba476771d01e37807990ead8719f08af494723de1d228f2c2c07cc0aa40bac876b82012088aa20131772552c01444cd81360818376a040b7c3b2b7b0a53550ee3edde216cec61b876b51b26c9a6c9a", "=", TESTMODE_VALID | TESTMODE_NONMAL, 15, 2, 66, 33 + 33, 4);
    Test("thresh(2,multi(2,03a0434d9e47f3c86235477c7b1ae6ae5d3442d49b1943c2b752a68e2a47e247c7,036d2b085e9e382ed10b69fc311a03f8641ccfff21574de0927513a49d9a688a00),a:multi(1,036d2b085e9e382ed10b69fc311a03f8641ccfff21574de0927513a49d9a688a00),ac:pk_k(022f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01))", "524d82030709b639b93bdb431d32edaec707826543c284c730442f4224cbd14ed8b92b3055b497d5564462f661f596cc16288fb45dc7343e48b4c0812ec9ab256cf4165ba43f0ea8e4a9ce83995cad06df15c343d8b3c089a2114f15c0ca8d9d2ea1e1a0e36ac96f57c04b270804d833249cd89b9d1cbcf65241ae5ea0914c6fe0882315371e25654f850d51cd3e3ab1dec02bd0c949d3e56439b901b1331e865f7a8151fadb159011faa97a63c08d3a30c4c3a2a38400af1555cfdd2b1462b8faede4113dd83988eacc7d544e4334887f6c5a73ebdb6d9d3aa8fcab6ae9cf23c083f668a2a3189aebb6e128048fad2f4ad591bf45c0ec0544934f1f7ee5b538a0e36d2905f02d9c1a2b8da398aed0c239f2e7366a0e441bc025077340cb68800a11f8563879553c62516f493442b7163e45fc2f9d26f6a2d5ec6e41d747f72795a1257b7afea2cb9fc5e870a482d3aaadf8b08a8f7132f98d63878e4675a8560aad1f8275b960992897b5864cd8c1726bbf79a4311291e02857b91726e7d6014e82eba2971234a9ce14f33ac4125a3ab2d581ac485768b1c33f911e9aa2c9a3fe5fe049ce45e5011ecb03c0ff82fa1767485113e7b2e19895ed13755a219a661694b47fc7eca5ba76bbf7261b6346cb46ea65226eddba6ae7953e621ede34871551a322950545840514401e343a8256bce264f61e04b392d484790fa363a644c1017140bb5bac5ba4af5ea318eddc603416933c520210fb2ab190ba7d55c0ea588951b7f7151a6b1ee8ac52994010272d8880094e0c3fb682857d0969a27250a2202d019695fdba0a87e66deecbe23888ab20c17a4a47904a2901b8ab3cdd1dbdb871624ed428a8ac86a26890f97ca6a7453fee426bde099a771b8d11092610c72a434c70c8e81ad56f858495b5b3975b1fd262ab77631d1b4468345e1b641a1de8283b9ef06fee1d77098e8676e2c70322590e377c23d75989c4a7e42001626d093ea0df95bcec7d8722e2b5b943b00fb202379b27b082149204b7a8d55a5dc844c3131a795af5b35c4f76204c82e8c0e9593c4283c98b2292bc9512747f9b4facae32876e1aca8b7c7266e6462d4366b9490ede3c01e13a294fd67cb3088355350cb8610aada54d8bea0515192bfd2d6915fadbe0b5e86a4b981a3704a4e0a80c503393ded74f788e219dcc565d34601b90c67d8c2db6e82c9b15856da4096a951e919defb589a717045401951d920abc811c89e0a4259cd99c410095b95b04132042c5984d0207080a1f68b9765f469f0495ada43f5e94b9fc19427b4b75a5a88529b01c6707fcf971a4d96195d5544242c95d045e72c23a2cb063e29a99c98dd82a691029728b33a42138f34c5577b05a7cd7601ceca92d3170f0dd0d8a34ffa1a8a1d12fe45de2a3110465be3465505261583c47988a45e175265fe95216ef03a25882fd8e3f28fecdf70c4bd14dad501a32d6709df68c5b8158b189dafab6040165075d1af20f46bd4b84bb541b578a0faea908168cd47af61bda1de6d4681985b620dfa1336cfd279d66b10260f3db38006c024dca19498908547ad57b281b8f4c5a9c72e5a2bd38bd7eb07042b322782d81a29b5a0ec2fb6b89d48ebe228c45591e1d2c143f0b1798e421d01357cee0f968a137d46861469c0ec4c1a9a7fd6e9e7d21ddedb99876428628141ea19011861c89b541a26555d01cc52046e148d45e88623e2ebbc365c4468e4e59feab71395ac6b1bfe2b7a93522a0e4d09f5e4abea67f499f311de82bee613b42da917228c9a280fd2c3bc86087b46c085202601997d260032f8a8d5eee8dd5bb0c6d60c6fe29dbd8b7aaed3e975d2493629176698a828e26bdd7a8b869871509794a2388875eba4c9a0bcbfb8908c46a8723df00747850bc5ac784683815b29f334c344f43a95aae23356df95e57212f880949bf0c15babc02ebf4900e1a2c2db7224b1c4119346204a9b568ccc198cbe69c3f3a4271da18cc6e9cb1b731162a03294a3038c151afd05e484660aea2f433e567a1dc214c1810b8ccb4a9cef064d7258a6ffcc086fdcda47f285d88cc5a707c3c494b16ddd1b84d12d716db32bdec16a85f51863ca59a96f580de79097b26e6022a70c60fdbc4a5a80d8616c97253ae165606b3ba54dbacfd27e54f56b51bfc7b26fb095122fdb6cb27d5cd4dc1d8012a1cdf6bcde40a33d6d90c066d71a0da7982d20030d5c7a646e9a1247d918027a548b9051c5fa35a2a836a506940a9da345ccb9691b562e8ed416938cd6122d799a685b20e18a5c4ea43a6fde8190a860fb50836874cc8226d7e62135828a541b0a4d75ef9434448e6ea5f5eb942b875f62abf18dc3756fcc3bf715909f0895bf32bc6ff00ad026860a41332ea5b7795361626280edfb1e58d29639fc1b5c570a6e8426d2300a385686fc8730d7cf5d9571d1ec2238a3f0b80b8a6c8d1daab9026b8aeb44ac90c7e9e90620beb6980741b53dc6d281c9cf0578682a2849ec7fbdd8ab63090711a5b8a6356e65870bfaabe7341757a1a68ce52909272d612761a4c18b7ee0ab884ad3cd96322b482e25bb9fe2d7523f6272277949849a4eec466549f3b862b6672dec9955d17d495d96e4aa8bfb09f0e3935f13453ae421e03b8b4f1b618fb3c11deab9094157b099cc611ac3f96540deb45acc87581869502ccfdaa1df484bb6127181152713fca843c42b155e7c1443ddaae86abcacb17719811b79def15057432639b4c717c92b3a3d63abcec1bd0cecf1111aa18e950d38755f2ceb5862ae34d11ef49389419950e87272901e95332e743d98493a226b04795ab60af504815ec912d280506875850578dbd6936589faaa2925aa94be875942234488667148a7a0119159c73001a5b428b9abdbd91c763bf1c7b3e696ba45ec1a51765dd30e75739bcb2e9c93041fbab7e0cab5203d53b2114006005bc20c0b5aaeba8d6268d60761490d0623c3ea87d191abfe8e2135504f7a44ace9b382c51ae98b0d9882a1202561bf13d46a93ac911c2e898806021fc1a96401d3aaa95d5bad85a04713309b1624d3118751928609714ad2b8b29954689865cfb6180d9543250c28152320b5194995e91be0ac627e859854aaaa4ec76ff4bad116d38525f94c775a11450dc4d032b2008687cd17532b94ad67ae3291afadcf9ffe39b6c581d13f256a88fb866a71a4e8373bc6479dc54a62645dbd49fc7de40d6ca84de17179d49ab7314149daeb80177c05c075a180eb4d519c3020c0e8070a01a5c01ddc97052ec6c0450a80614a939eadb60bf8c4f195dd6cbb38ae0772604f035dd88723d8e297168a6a3e5d29ba844f20aca148bee9fa05a9e3ab24547928d6a85007d8cf960a4ef45f121a26d150ee441df6e7956d9737685c1a61018cab4142292521f6a165cc067d9380260cee12bb92b408b52955acd7281a5d27909fe04270f91119c8cf7209c4b3b9372b2eb0e595e159634b10a99b39852b6194852c2a575e57ab82b0809f0d325025a27090cdad16203f919329078671b74b461f8c47bea0c79b12fb2bf133719d4f75056c5e1126c60f0f8d56cb24149e3ff9dd472d56164ef911d1621e7bbacdf070786bf1ae42877bfd5599651eaa207d279a3ae580fa2cc7bc8b4c38260f13b67cb15727c20bee312cd2b0161895b12c4edad4d838728c68311281b90255a555605f558221dc35b76c89abb43184a062df7650259665afc25ecc076972c504adbe3120028a502e0124e1d9ce08b9cc26da63d28405e68e97ebeb4d603d4c091f4b48072a715a7647e0b22ca2b52ae6b514d0207080a1f68b9765f469f0495ada43f5e94b9fc19427b4b75a5a88529b01c6707fcf971a4d96195d5544242c95d045e72c23a2cb063e29a99c98dd82a691029728b33a42138f34c5577b05a7cd7601ceca92d3170f0dd0d8a34ffa1a8a1d12fe45de2a3110465be3465505261583c47988a45e175265fe95216ef03a25882fd8e3f28fecdf70c4bd14dad501a32d6709df68c5b8158b189dafab6040165075d1af20f46bd4b84bb541b578a0faea908168cd47af61bda1de6d4681985b620dfa1336cfd279d66b10260f3db38006c024dca19498908547ad57b281b8f4c5a9c72e5a2bd38bd7eb07042b322782d81a29b5a0ec2fb6b89d48ebe228c45591e1d2c143f0b1798e421d01357cee0f968a137d46861469c0ec4c1a9a7fd6e9e7d21ddedb99876428628141ea19011861c89b541a26555d01cc52046e148d45e88623e2ebbc365c4468e4e59feab71395ac6b1bfe2b7a93522a0e4d09f5e4abea67f499f311de82bee613b42da917228c9a280fd2c3bc86087b46c085202601997d260032f8a8d5eee8dd5bb0c6d60c6fe29dbd8b7aaed3e975d2493629176698a828e26bdd7a8b869871509794a2388875eba4c9a0bcbfb8908c46a8723df00747850bc5ac784683815b29f334c344f43a95aae23356df95e57212f880949bf0c15babc02ebf4900e1a2c2db7224b1c4119346204a9b568ccc198cbe69c3f3a4271da18cc6e9cb1b731162a03294a3038c151afd05e484660aea2f433e567a1dc214c1810b8ccb4a9cef064d7258a6ffcc086fdcda47f285d88cc5a707c3c494b16ddd1b84d12d716db32bdec16a85f51863ca59a96f580de79097b26e6022a70c60fdbc4a5a80d8616c97253ae165606b3ba54dbacfd27e54f56b51bfc7b26fb095122fdb6cb27d5cd4dc1d8012a1cdf6bcde40a33d6d90c066d71a0da7982d20030d5c7a646e9a1247d918027a548b9051c5fa35a2a836a506940a9da345ccb9691b562e8ed416938cd6122d799a685b20e18a5c4ea43a6fde8190a860fb50836874cc8226d7e62135828a541b0a4d75ef9434448e6ea5f5eb942b875f62abf18dc3756fcc3bf715909f0895bf32bc6ff00ad026860a41332ea5b7795361626280edfb1e58d29639fc1b5c570a6e8426d2300a385686fc8730d7cf5d9571d1ec2238a3f0b80b8a6c8d1daab9026b8aeb44ac90c7e9e90620beb6980741b53dc6d281c9cf0578682a2849ec7fbdd8ab63090711a5b8a6356e65870bfaabe7341757a1a68ce52909272d612761a4c18b7ee0ab884ad3cd96322b482e25bb9fe2d7523f6272277949849a4eec466549f3b862b6672dec9955d17d495d96e4aa8bfb09f0e3935f13453ae421e03b8b4f1b618fb3c11deab9094157b099cc611ac3f96540deb45acc87581869502ccfdaa1df484bb6127181152713fca843c42b155e7c1443ddaae86abcacb17719811b79def15057432639b4c717c92b3a3d63abcec1bd0cecf1111aa18e950d38755f2ceb5862ae34d11ef49389419950e87272901e95332e743d98493a226b04795ab60af504815ec912d280506875850578dbd6936589faaa2925aa94be875942234488667148a7a0119159c73001a5b428b9abdbd91c763bf1c7b3e696ba45ec1a51765dd30e75739bcb2e9c93041fbab7e0cab5203d53b2114006005bc20c0b5aaeba8d6268d60761490d0623c3ea87d191abfe8e2135504f7a44ace9b382c51ae98b0d9882a1202561bf13d46a93ac911c2e898806021fc1a96401d3aaa95d5bad85a04713309b1624d3118751928609714ad2b8b29954689865cfb6180d9543250c28152320b5194995e91be0ac627e859854aaaa4ec76ff4bad116d38525f94c775a11450dc4d032b2008687cd17532b94ad67ae3291afadcf9ffe39b6c581d13f256a88fb866a71a4e8373bc6479dc54a62645dbd49fc7de40d6ca84de17179d49ab7314149daeb80177c05c075a180eb4d519c3020c0e8070a01a5c01ddc97052ec6c0450a80614a939eadb60bf8c4f195dd6cbb38ae0772604f035dd88723d8e297168a6a3e5d29ba844f20aca148bee9fa05a9e3ab24547928d6a85007d8cf960a4ef45f121a26d150ee441df6e7956d9737685c1a61018cab4142292521f6a165cc067d9380260cee12bb92b408b52955acd7281a5d27909fe04270f91119c8cf7209c4b3b9372b2eb0e595e159634b10a99b39852b6194852c2a575e57ab82b0809f0d325025a27090cdad16203f919329078671b74b461f8c47bea0c79b12fb2bf133719d4f75056c5e1126c60f0f8d56cb24149e3ff9dd472d56164ef911d1621e7bbacdf070786bf1ae42877bfd5599651eaa207d279a3ae580fa2cc7bc8b4c38260f13b67cb15727c20bee312cd2b0161895b12c4edad4d838728c68311281b90255a555605f558221dc35b76c89abb43184a062df7650259665afc25ecc076972c504adbe3120028a502e0124e1d9ce08b9cc26da63d28405e68e97ebeb4d603d4c091f4b48072a715a7647e0b22ca2b51ae6c936b4d21050998d1d630ad3858e395fe19d513c45e59182698ee3afa174b093587694b5b495325d43511a36a138200f97cc1b0fcba13e6dc33fa1b4851225d1f5207debc66e4aee21a5990b67ea4f072133226685b9307f0d2fc4038255a4d942453e0c9177bed5d77e25ab9aa476ceadb4a5dfb14f1139c4356be916e31cbc07f4fe71beb0cefdfc07f0f26af058887be2466734fc4f6deb81643e6f31782a96b0ea5c1054fe664734282a695393f72344eec742b8c3e365c17fb712f3f60d64b7f7a472bf83137eb4b8083d3c4a29c971a4aaeba7bc5e28d477c65d213848ff3048f85128598cf021efe818502a97bd4fd822430d31d01cb52dd56c04537cdb2965e81d19cbd537ba46b639c8d733c0b879577de77ec913033e92a59758ab66d10f70b8c8317b709235d8a3d6c544490d7a1f6d1dcfbf1f0c2e89fed5196eef70364d71048d8c07043dad05ee6d78414f9630325728816612db3a42c4cd4654f6932d68800e9a34491907dc84288829dc0a92b8f62093a9514b241cd07114e9ae3ee5880c79d2c22150cb8a807f8dd50149e84bcf422063ff6bb2d8c9174fee59b6a4609698886ab3e8b1773d60b218d074c0b89b62a23a8f1ea8f9cf8c5c62c7b33e2a17ad4a5fad45925e84c7066f22b39dd8dbf81b0d6279b275e64f38e386d9a7a438ffc814366f580e60612a04fbd7ea2a34ad276eb219b64c9ce5cbafbded5f4558b39f00311b3112b3f6853c40ffd4c070f01dc7cbbb1517eef9584abeb00c94fe46d335bfd31588b58de0dcaa08b824719b78fc2996a32921d17bd21ccc2d90adecc6a3f056b13cee8464778e3f9d2300c85ec09881d2cefe9ce78d351e70c7c89b42f25c959ba6de16180ac9d87c8f370c5b548cde60ca70cd7ae5023a5a17d4d77bf565401c1ae490584fc0267cb1b474cb138f971a3c474dd80c2f3c724a53386f881cd0e216f2c401d3103f7627674745ac65a33fc2b48d41f667b90ae325e7fc56891b9ebcba5c0aab2f942bdbb17cd32ae1b2a4972b9360f0b06461deed0993d4b975fe5df3830258e1188ded16f154fee4d2d877a72fc6714275167ad4f082a161c63f62a03e573b7caffe55b9d6c17633129d35e9a8fcd1ea229bfd1603cae324bf587e99d7d26244461f9fc74a7ec45f3d37f0386f1459d819d18fc608cc1137f047e0621b027ae4ab6325e3873e6f7489ca5dd6d5d3c5d3aa91264bfff5c437bd231990f8e173e973a0751cd6ab9226e8a77265b673619b468d690646a501e3f2dc7e4ea3ab2d20d9193859a087c1ab6ede4c5ec7745f19b4271d3c3bb0b81961204792cce939ccb3169345e3e7c13a3c3d3424afb3237641e35693037c4a50e14b41efbec6d9c031ec66623df01a9dc944ce91d348d16d048ab0a9f7a7030d4b87f17ad24cbe51d90487050658021e214ce95089caedf49090ddea45752e4184502166ded7ef25b7c51f21d725911ef5f16bf5b4b4fe2bd25df0a980141252c93e3b5ab7191f631c09f2d89ce035821c4c7e7036f1407d5be10264e9f8d4eea2cf8a942115b1c16886fa025d52c1f34863689ddc8eeefc827de1aecd3cc4004595e3269a58ba5a87e49a18d0728432411573e0f8ca18d98383957e6206d51fc0ea0b2c3acee9c93f79575de53e91412b97974a8ddbd646b7b6122b059f4af85c5c99ae8dcf9b4492c642a1374579064a1b3387683bb55229a5026c1f72b26d4556c26d25688a2d685aba52b378a6c2571e4289b451d7c66c0c1fd844cfccf50e0df4611292cb6c421d0a7f3992cbb050ba05a8ffabf8820e11ecf30cbdb67e00192dbc322aad6f749fd761b481008f8c28938773dcb6e3220195aecac6c935287", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG | TESTMODE_TAPSCRIPT_INVALID, 13, 6, 4649, 0, 10);
    Test("and_n(sha256(d1ec675902ef1633427ca360b290b0b3045a0d9058ddb5e648b4c3c3224c5c68),t:or_i(v:older(4252898),v:older(144)))", "82012088a820d1ec675902ef1633427ca360b290b0b3045a0d9058ddb5e648b4c3c3224c5c68876400676303e2e440b26967029000b269685168", "=", TESTMODE_VALID, 14, 2, 35, 33 + 2, 4);
    Test("or_d(nd:and_v(v:older(4252898),v:older(4252898)),sha256(38df1c1f64a24a77b23393bca50dff872e31edc4f3b5aa3b90ad0b82f4f089b6))", "766303e2e440b26903e2e440b2696892736482012088a82038df1c1f64a24a77b23393bca50dff872e31edc4f3b5aa3b90ad0b82f4f089b68768", "=", TESTMODE_VALID, 15, 2, 34, 1 + 33, 3);
    Test("c:and_v(or_c(sha256(9267d3dbed802941483f1afa2a6bc68de5f653128aca9bf1461c5d0a3ad36ed2),v:multi(1,02c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db)),pk_k(03acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe))", "82012088a8209267d3dbed802941483f1afa2a6bc68de5f653128aca9bf1461c5d0a3ad36ed28764514d210a0b9a77fe365574b1346c8d578e4f8cfc462df210aa8a5b3282fa0e1eb943761ccda9ee3073e3135a94bd17707c81f3abb0c51a983fa6a24b6489fa4142f6d52cebb184fe2bcdfa06cd5746c28d96123efa6e7346a3237833e09b4c6109548a6d263998951d194495c6a73db32988726f592eea3462f16d0e07a4fe04eae1ef84b610c2b9d59a96dfea36b17230ed2a9ea43f9612d9fcc3bb816dd5b4cf239a903b151d5a7c3d6636f7af35c2ec3cbe51961fab4183e8d2d5aa599d9a1ab595f4ee7b42f4751fc34aac32730f5007bc58f358e807270b2e6dc844b113c63e1417006c70d69014942a0676791fd78c792ce5c0442a162b5651663c4a7f6c6f7d8fc24201d8923df385ea3b2ae70728aae53ffe1636eb1b269a67fdfe0afb897e180d430704cd0dd1bea907f3436e93ce871c93e029a1772513408eab770ced906357a4d2513baeef1d452a49abd19710699c999d5e56c87f30f1edc49be29e6d57ff4e1a5f94f427bf5b39209ae2c48285818f00ed305eaa46226d17bfedc8935b4ea314f42876934e95602f06c15ef0f94827c6f65b9095771c6cb0b9f63e0ab4adc1325ed158bcd065f540ea5e0c0a5cd9c695ddc2859787a2234d6e3df876a7c35e18cfa7668992cbc8959e02bd4e2832b2dd06782160d37ede48e894f9b3698cb3797a27b02b168ffcc3cd8deda538fced375bb35141b71b9fad172a2edc7a58d404ee72770205349a8a15b7565862b154d5a9ad1f997e9481175fb9fff9162b421443b49ae9d193345b33da6a2766e4490047933a6b595e0d0d0a7f6331d6aca9b0e6cd93272610929c35fce33dbd5237ae4bda6cb110b625335e8d3d8dc254dbfef42b4e9b59c922c38bd889a86187fdeca8cdd3f3c22a886d2e3378bd5fa10b8af430f80af5cd9dd0cb2ff6285aa841e43638376a2b9ca2047f8b57f66b85918108e3bb2add18ea47c40ba5d4c972ccfeba37c2751a5d91fce0f327fb7f8b1d8327ef112323f6913147ea11f2fa02ef297d893d851f90e6eb3df19673908970a0162c1b4560bb81622e33bd8b4d098ee457b1053c6aa824d1aa50001429d9151c9bf56daf36b173666302b49e0d039597519ab745497c22239f131d81449425bb1c09f0d2fe5ed630061745c7f3e424045dc219a8865814629901676919f3017b7374e2dc4f23418666b338f0f517743777bca7e1b678afbc40eb9457b0f6f8b9926c74f1f328368479f7c2a8dab8cf6a27505ef3e1060f79a2135d7c7fd9706e3c6b36b4db482c181e94277abbd44e90bea434987f5c111ed76ac37ed5234e054b0a2d220ccc85e5f17ab5dc74058bc64a2625ff53276c24b6e51280bd821075019d24f3d615843d22f4d1bdc9cf6cbc548d4942d36597e30e4d8912549480dd15482ed60e1d3f58ba3ec2eb460cdfcb342e18649ce2a3866a0ec84ca72eae93691ae5159948d0fc94120d5bd4857132477b6dad6d94ebfe9b7126e97777c2469a8fa9f4646cb5b0ef8b4f1e96eba1d5c2e0fc32742c58dc75df184b49d59af6abfb191227b4c4ec4e692fcf881ab5c8245faafd567ebf303e578cea80eb5a0e3a868a87b76398fb29a06421234c54478e4a9cb7bd19ffe5504604166137a0eb7005cc4a95cf9c955d7fdb1a994b50c88a20e59eb93d3a1c1bdf54baff352696490e0a1d0dac8734e201cf3da3130733c509292564cd508c3294610935107bb25ea9e9dba24ef12a905f695aadde05fa9a3d8975f94d63621f65eb71d6aa2a010c11db81794eea26e82138cca5d7d4ec7bfe2016e675b77e80b91a9f637ac2716530d0c084fa3a4b78ada56b00722095c324a011824d359885c9eec9fea23e8e3c852243d5ed75d655754699468bbdf204ac3a2f382cc614b1bed4271273326ebc858f5e04480bd62f9fb567ccef5aa7457e7f9d40fbac0856de9762fd7d9213aacf8046d1d7fea9050d81786fd69c9fee0480046a5850a2522250366573d5786f2ac1909ade46d2b980314ff0c108c3bbca4bd4c666ffba2e453f5eb46422f46cd586732aefc52e51028e18759a575c6a49f07abe1d1e5101542ff655460692323b7ea8c2c48ee489782d39dedb59c8f86bc306f9b98966a95a459f1b876c7f611add3ef44f7f827fb0a4ed491a8713df355823c7b7f4f886ca322585612ebb1b4c00aedb94d2decd4cf9c485ac219c442fd6f0245445fe4a7ca7a271441fd2698abfe9bc693825dbd357cd0aa2b67b3042bfed7e4d55ec35b3c7f1a5caf83af9c55668c9e57bbc8978c9f338e4dacb2084d992db2307a4ad5dfabe32ab717821dd0f47c66674cdc802cc6e4ec1c9665045c2c520d32a1692d98afcd39fb6fa011eb4ed2ba0626b1425fce80c1dd70819de7dd3527242d352673f74d64d35520ec75e2bee88c07887e32e2c54b3fc2c206b213c8aaef9273e43f0a623f53dc76d4a0ab271909e2cbaa8b75865d4e35025b20d845e19890cff3ea47a65747b1a90234d811824ac8610621fd6e16044a909b780e3fca3d7c40e6a160fb8f7b58dae0b7dc1af2c66cb06f0ea660998fb184f6be9497e4354fab5ec3e34991c81053fbb2a7370c844114e4b84ba1085eeac02bc3a60b8b019561b546d7f4d7d3ac5b6cbd2bd3406d9a9dfa991af9bf0c2d7baec127ed21007659bbb214d8310b08fd41d474b5b37202e6c383dd70ec06f496e8e8d2bf84afa07063abb6dad712c70be7ee32260b6b4fb9f7fb463fe979dc21d4f0e5eaab804b0f97c95472eaa03468ad63a85b6a5e64a934ecf636b82632aa779e56a7b0d2ca5f4d9c6589794e178f00b0ece668197bb16f4acace21511c4fe623afd6f0da4652b6766b0159c4356888908132cc0c7275da09ad2425337696159980e2ea2d0295310001e65f6ecb5beb117cf514f827ee547a7f4de670525ed2c969df55e1b0b4fdf76f7fb9d50dd17e9be18eb60e6d20731090eec16c814f9ad8de95f10914b27a0cf0c399b457a29636689f7816d0983e86d7a28c94953b86198bd0241ee2fdc353eff2ad35768ce997f7becaed07dc664c1d7de38f6835b505562897a4aa7279ee8027aa775abee823bb65df6ae7bb708a76b19691d118df9ce3efa46ec9ed1936bc9c5a08321c1c182ed7d0f48e6bdae962bb60cdd3a9c10d5ecc00c8f3a79f3769b091d5f9fd8da09039c68c83ba7b3643af8d132159928e048a43f05765507c0914e6c3376940dd34c0bb0ba20fcffc73aba4df9f9a1668652e968934ce5aa1a7f19b2ed88ef3574944dd515bf223794a1f8825d608e84dc8a6b77f61bd8ab0d0cd1d8a7498bd9e37f6a421abc1d576fb33597572f68b5716b595b9e5b9bd23a80ba55454a26f45eae4851ba5494148e5ab489e8cbe6d1130f60e1a12574193e319a65bff521a856ce641bd3f65efa674f52990a7ce4ba389d3d00a8f25254473d2b25426b7713337c6bd41dc63574cf6eea488c451f4eb2a6f625692ef3faf168679784018c830e59c1386c08bd15a8e9a20b1757f1fcf30f950a91e0fc7a1dac01b00e0c8edfd39b89c0cbad541673d9a5eb96fc2ced61df3d64fe7ce9d1cd7c9d69e212d7076ef9dddcf1d7591524519f9f1873e1acbdcac692856086bc8e973224b8fa5b4c0fa1528872d1c85655d27496180df4ab4a817b1cd5b98ba39749228e51af684d820307098b4113e39d1f90211c0a981aa2661008d9c0d7cea80eb592e391ee6e37548ed4ac2950159d9657281e96b09e42ca3ee8dc7cb2c6a5bcd177688d69c70c1342491ac544fa4a8004e1bf17c42baa41bc68d9a5583c4868be329cda4cb404214388ed7622ba4e99401e370ada02e3e9aa791871b036daac1fb31e763a3655e0883a8f549cccacabde164278aebd428acb7470d111b3768a98d00074ba651a746b895783febe65885ee48459396738868a4c72ede441a032a274928211874a59ea8e757521f40f89e1bb72190c47a9cc06045f485b60a9518f9e6a00b20c0142a46b1e3eed804f98eb0f76d7f120d0640a388ed5ec14a19a51024370aab7839070c09faa8b4ed54d310447b9136c2450a1a6495ba556861e612bbdfd5aa296ed8ea2317f3283a073134595350f1d83a142ef797513ec54ddc6e8095fe59b022460cfdc3477689a754e6b636ff4814b3087ae47ba218819145b43f65b813bd0773a95ce151c5c7768ee12d3af84ac031c964a091dc790354c588101a214e428d7048cfe344c9ed28f06ee80a555628157483b3478d1cf1dcb8212d284216a4ea27264b3d55a7aab022da73649cc63e24706f3ec758aaeb0a772cd985a2d75152b83dc2fb11b33f14fc22aa139274b1a6dabed07995dd9d0b0e590d2aaeece474982490c0b4357d6c8abd4eb688d396fd68e59d205258fa7df607f6fc0a0ab1a9b9a0138f7c6828ffa21320a58d0e491ad2e2eab86a67e571ae472b4d92d3e7228d64acee757e02da5b000725c3229f79a5d956002e231ddc6be94427108e987cc210e48a0d405c217d46f12f01f5b308d42f8c22cce3fb005b3dc44e1bd5aaec28f8b56387c1779019fa2bc1535356308ad886a626bd600059742b25877a107854a47eb686db2aecef1d1eb0e704a19cb746f193d5a6ad8b2ea53ca8f3a94b035574689f0502671566e7a853523c3a5b10a9e1aa9e9e2c39ac554a8580c1539f4cc3154a887af287204e311072fbcc192c2d34c05ca91d4348603040a709a2ba2bd65b88d69401fd06edd8f133f8bd15be29297e90d4d872600bad86e2a1d013467ab111d3d712fb6662e58974e124a538eb75ca9ea74e264c168edb772ba485f57ea7d16c509dcbb701eb46c4ca90c6415b5908ae371def281b781c4617def85c713385e3699fbf0152079a902ea2263d377069d5abee6742f662426cc2572a6c49f87bad276401eecd815003baa5a4cd91086993de09830e6e9a49e5e1dc0ff8521ac", "?", TESTMODE_VALID | TESTMODE_NEEDSIG | TESTMODE_TAPSCRIPT_INVALID, 8, 2, 789, 0, 4);
    Test("c:and_v(or_c(multi(2,036d2b085e9e382ed10b69fc311a03f8641ccfff21574de0927513a49d9a688a00,02352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5),v:ripemd160(1b0f3c404d12075c68c938f9f60ebea4f74941a0)),pk_k(03fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556))", "524d0207080a1f68b9765f469f0495ada43f5e94b9fc19427b4b75a5a88529b01c6707fcf971a4d96195d5544242c95d045e72c23a2cb063e29a99c98dd82a691029728b33a42138f34c5577b05a7cd7601ceca92d3170f0dd0d8a34ffa1a8a1d12fe45de2a3110465be3465505261583c47988a45e175265fe95216ef03a25882fd8e3f28fecdf70c4bd14dad501a32d6709df68c5b8158b189dafab6040165075d1af20f46bd4b84bb541b578a0faea908168cd47af61bda1de6d4681985b620dfa1336cfd279d66b10260f3db38006c024dca19498908547ad57b281b8f4c5a9c72e5a2bd38bd7eb07042b322782d81a29b5a0ec2fb6b89d48ebe228c45591e1d2c143f0b1798e421d01357cee0f968a137d46861469c0ec4c1a9a7fd6e9e7d21ddedb99876428628141ea19011861c89b541a26555d01cc52046e148d45e88623e2ebbc365c4468e4e59feab71395ac6b1bfe2b7a93522a0e4d09f5e4abea67f499f311de82bee613b42da917228c9a280fd2c3bc86087b46c085202601997d260032f8a8d5eee8dd5bb0c6d60c6fe29dbd8b7aaed3e975d2493629176698a828e26bdd7a8b869871509794a2388875eba4c9a0bcbfb8908c46a8723df00747850bc5ac784683815b29f334c344f43a95aae23356df95e57212f880949bf0c15babc02ebf4900e1a2c2db7224b1c4119346204a9b568ccc198cbe69c3f3a4271da18cc6e9cb1b731162a03294a3038c151afd05e484660aea2f433e567a1dc214c1810b8ccb4a9cef064d7258a6ffcc086fdcda47f285d88cc5a707c3c494b16ddd1b84d12d716db32bdec16a85f51863ca59a96f580de79097b26e6022a70c60fdbc4a5a80d8616c97253ae165606b3ba54dbacfd27e54f56b51bfc7b26fb095122fdb6cb27d5cd4dc1d8012a1cdf6bcde40a33d6d90c066d71a0da7982d20030d5c7a646e9a1247d918027a548b9051c5fa35a2a836a506940a9da345ccb9691b562e8ed416938cd6122d799a685b20e18a5c4ea43a6fde8190a860fb50836874cc8226d7e62135828a541b0a4d75ef9434448e6ea5f5eb942b875f62abf18dc3756fcc3bf715909f0895bf32bc6ff00ad026860a41332ea5b7795361626280edfb1e58d29639fc1b5c570a6e8426d2300a385686fc8730d7cf5d9571d1ec2238a3f0b80b8a6c8d1daab9026b8aeb44ac90c7e9e90620beb6980741b53dc6d281c9cf0578682a2849ec7fbdd8ab63090711a5b8a6356e65870bfaabe7341757a1a68ce52909272d612761a4c18b7ee0ab884ad3cd96322b482e25bb9fe2d7523f6272277949849a4eec466549f3b862b6672dec9955d17d495d96e4aa8bfb09f0e3935f13453ae421e03b8b4f1b618fb3c11deab9094157b099cc611ac3f96540deb45acc87581869502ccfdaa1df484bb6127181152713fca843c42b155e7c1443ddaae86abcacb17719811b79def15057432639b4c717c92b3a3d63abcec1bd0cecf1111aa18e950d38755f2ceb5862ae34d11ef49389419950e87272901e95332e743d98493a226b04795ab60af504815ec912d280506875850578dbd6936589faaa2925aa94be875942234488667148a7a0119159c73001a5b428b9abdbd91c763bf1c7b3e696ba45ec1a51765dd30e75739bcb2e9c93041fbab7e0cab5203d53b2114006005bc20c0b5aaeba8d6268d60761490d0623c3ea87d191abfe8e2135504f7a44ace9b382c51ae98b0d9882a1202561bf13d46a93ac911c2e898806021fc1a96401d3aaa95d5bad85a04713309b1624d3118751928609714ad2b8b29954689865cfb6180d9543250c28152320b5194995e91be0ac627e859854aaaa4ec76ff4bad116d38525f94c775a11450dc4d032b2008687cd17532b94ad67ae3291afadcf9ffe39b6c581d13f256a88fb866a71a4e8373bc6479dc54a62645dbd49fc7de40d6ca84de17179d49ab7314149daeb80177c05c075a180eb4d519c3020c0e8070a01a5c01ddc97052ec6c0450a80614a939eadb60bf8c4f195dd6cbb38ae0772604f035dd88723d8e297168a6a3e5d29ba844f20aca148bee9fa05a9e3ab24547928d6a85007d8cf960a4ef45f121a26d150ee441df6e7956d9737685c1a61018cab4142292521f6a165cc067d9380260cee12bb92b408b52955acd7281a5d27909fe04270f91119c8cf7209c4b3b9372b2eb0e595e159634b10a99b39852b6194852c2a575e57ab82b0809f0d325025a27090cdad16203f919329078671b74b461f8c47bea0c79b12fb2bf133719d4f75056c5e1126c60f0f8d56cb24149e3ff9dd472d56164ef911d1621e7bbacdf070786bf1ae42877bfd5599651eaa207d279a3ae580fa2cc7bc8b4c38260f13b67cb15727c20bee312cd2b0161895b12c4edad4d838728c68311281b90255a555605f558221dc35b76c89abb43184a062df7650259665afc25ecc076972c504adbe3120028a502e0124e1d9ce08b9cc26da63d28405e68e97ebeb4d603d4c091f4b48072a715a7647e0b22ca2b4d210509837e432b2a9c729110b4670fdc2a5bc54eb88c1597b4981478702eb7e9db10303bbb7cf864d46db1c324df205c53b42b9aff34ff4d6a28eae5df2dc85710b8016dc63806c1a0e69a59a72fba7ee954b5887f56b78b4ce892d1e3ae7210156b3677f886a3d02987a6e1ef6792e4cd3661832b4937adcff79bf9152d76e8a1baf5aa74871fb089f295b152c7fe4706eb6f62d78dc992327575f0295f7b7dadc9b38a77df50b1aa29a7e7dca7e22f887bbf951aa09d4206b3992975c301903c609e3ce523aa5f973922f55daa5d570becbc33945c2de61f4f089ca3fb54da36f0b47caf2891a1ea5eeca0abc939b75d00807d53dc6e0c95fa2f5f8079398cfbc0a4710084c235ad9257d896a810e341fbce984aa3635320990cc799f809de41d04422f49724329402e6ce93cac6b6826c6cb1b65a893b445d6911cbc13f5da0e8eb5030dbcadd03e2c777fa26763e5bb96532fb4c67121fb98f315d68891ddfb00eee1262aa290a9f8f99f8f4f3e17507d6d34e2e2d36913145893b3e7e3b1da51b96c5b17c97936d93c3bf44b136389dd33513a4502328de278e911803ae9ff98a6557a1cf045a343c500f139b44d1efc2b91830be70cf9e9949144032fc0ac3dc0d2a14e24f2dcf239f85bee3c3bf11e1da30a5741083b16b35e3b33c9d087c388db4dfd27eccc8426f4b05a9263a66aa6f17038f7e226e47cd9dc7880ead45db4384a657e2e443c5920ac7c402693cbfdeccf4175b72c3580d32a87175dac57a412ca4f8a4c1de7c3f1ed36e2f1eb44d7d29bec7cc8bddc9dcd10b7edb567ba820c278fec9f2efbcf191552e84bc2fde5303c8ff1bc44e1b817777fb7de5aec951175c8915fc69d658796e299fab6a5f0262358cd7f5b5949123b481679cb7f3f7116f6091ff0670a2bb0e2117916daabb3f5d41d8f1d673e2e2e3c405619b7c9a3f40f786c7692d9dfd7606e0f0c8bc885699584745f390b4dcfae610c3ffa2d240749842a7d44e3347ba12e3023b7df336966fba48397dd980d89ea8615bb85c0c264a926a5fe68fd6a59d4e4a3738cf397fbdd7190d62e684388cd2fac97bfa04117e062080a2f63a84bbee39e5d039281fd0a20bee74e58212eeef6b3598d76b98f1058c3de86cbe99f106418286e9feeb293910e82b13af6d61a8da248903f29e266f15df1dbbd02db95f85dd55aef7f2a31b733a33ec0d58b89731225806da351acb64d71af6fcb615ec4ef25456bac6bd8bd06b8c0a96bb934911e648fd90182a1aafaa1ee16ba24028c95684444457386b70e0180954c13ffff93efb73ff1582650ccdc22cc4d178d206f114968532178a585475e2596e9f4726029b72ffa1172c9022a72fc984bd6308454bd9120df1e5f43ef331bfb406ce99c5e7c4656be7bc01e603e6175288f06199cff760eb253d8940ab484546dc67955c7c2c7d194d0131d1f5a2d7bee1dcc492c6fe4ab7ddb1f120e114e1ad9fc62320c41c8ae45d9642dcf0b989eca9a9095c1dbf7c10331a33ca8a91618e8a62309e35f22ac7e49f0bce11bb457c91625d4f63effffbcd44bcda855788e25495340fe9fa59333564817f00e92a9670ee4cc848b196ba6d7bbdd73f619700c5cf38ac330eed25d6f164fbf9213153373b661c6b64d72838069f8a6f84152372ea047c4428a5554bad519a23d90d21bb776fa74a59158ff922bf4b6498efdd0c645a298c883a8ab1f1a2f782f1fbf195c2345a22f50c274b7a6eb0dbf7cc2dbd012aae56d3ae12c7b90584690827224e67802d49ac3b403c194c3bcedadd644a380d1eba8d737a53b448efd6091414640d9cc56500d663954afedc40b951d44f6bc2ece852ae6482012088a6141b0f3c404d12075c68c938f9f60ebea4f74941a088684d210a0b02f5a49f7172de3bcc53784733bc3dfeb93dd4416dd0327688bca1820c8a0f3a7357b21895b9be437f1cbdb8a919cade0c725ee6187eb054a211af0ce6b6529a4a73bff87a370f737744fcb26a133148c7929a6c81f2111737845822812434acbb02ec6bdd7415f8e89efff2a3621dddee6a88f7480179ec20abb7389e0bfc5549d84313d029f5df56b740e29ef957e6d14230c77158ea46810b5002c3e75a198cadddbaf7ede0259137c80af1e63c773921f6e3f112c5128da4129ef2831f115533fe666cf102d2dc29ff7a26087639eca2e9ef51b265205d35c8f3eaaee2227dc0b833799ef4f8af7c72ac0d7ba158f952e4dad57c9d9ea9110dca9d62e75cd3636aedb65806ef6ef4006fa3cab5203a31c1d9f3e31f2bd494737953e7db59f2a311eb989457c353d2736da705da857389f3ad316916c46b629e58bc86d96b63235f00b08e8b5993691ecf015366a933a5641bf805aed6b9d4f3a72717c60c938dd24069a4b5a2e466e72e0f3600d7193af76bfbfcadc8d4ae122cb73f1d3c03c1602900958d000c4732a1b725e79f1d9be295d3bc9b711e48e7bb6bee9914f7bd9b44ab28a7001ba89edcd7636ff335d4eb2457150934d6158bdfa7b3090460734236fc694c592bc1ba69912e6df57a7305eddf53edd4a4ae7b47c3036c528a264beb48b90c34b6586bffc6f263cf48eada3bcd80d74e1308cd06d6ac959f0d678c3f8bb98b31f6a53c178508f90164d59287e346d0c661fd612204fa3242745e4e731994d8a5a42019a8ee4f0ab01aaaac6ebb6a9826a7f24ad9132395084c1e28402e8cef44ed6543b4166a9a85996317394d99e81c4bb2e1aadfabfb6883ec777c6ab5774c9329f286d3939069bab5ec332c2e480a1ee10908c5473b5b617adaa0559ab12ec1f106946e6507656e4ccc7982e36a3bd93dfddd667924a07dd867bf35464ec429056c88e413c07909481cb8eb9c9a8d26b98d93662d3198b89502f2aea74c138cbd059dfb586547b5259d8019d7c72032d6f7bd04039cd2fcd76405844896fc7347322526f4a4811502662768322da2dbb773df2be96c97dbc6637faac183c0d1a5dab72b1fe147019438cc335148bc22b222789f89713f1ccf748f698c7d96d09c40f81c914b3897e09eab285b38f0530eb004c0df109f0595fe268171dede7eac59e63cd9fd387c8ca5b5f6809bd5ca42caa0fa293106d5e25abc23863be9eced9e7100900044c822f703017ef64915af67a66ea3392bb62753cc84f0aef18a0e2d93fb32ac0092f5c10f860a3486fd519f45117de684bc044878e6d0a88252fab08cfd224af4ee0e27cd6e26a3859a063980e231d4e903f1e260ead8c53acaa5ff4864fefc9a329aceb1e1da7569e6c78a47dfcdd6b693d001017bbd385d9bd18645070c1c942f163e72a392babf3bd4157debfdf9b3d1eeefaec0dfecb37f2e2e880af717b4f6866527c08fe69dc9e977af2632238688e27bc8b8b4f0f562b4a402730c0351dd8b3122f42b5e8c987dee7756a1b28f50aa197c9150cc92fd29888fcb2c3df7dbdf9a6030d280b6511f90592af564767ff7f0aeadd6f73e3f0636a4e951ef866189decf8590253086871195a6883ed09b438fd4a35a8dc42ef12589659f3bc67c385fb18917ed020b17c4bd1218b402cd88bfa02977db3a56c53e999f7f4593bab402d07638ba2180ce3c1994797c8a3361602b5d75a611df53c71acd632481f7068646e439749b0f92a8c948126d9bc1496445d8dbe0a628532407f69b411794cb1acdecdaf049331d8c618ffd119dd3cf393f931ce6eb4c557952c4df6bd9a99ef5ea3a2e433de15fa46296e8c82a631463c08c12ecf2fcc29f73e012ef7cca478778acef371c52ae1495fc700098cd7c185eb82f251f4dfe26fd53c6bb99244cc9731319d0513ca5df5283758008728f39eb27e9550aa9f101b9791cd5433a27d0599f983d61696e44f50a3366bb57115f1676448ce70671c92292bb0b8ddccedd6ff4cf566671770951b692a1c75ec51bfd95b54fd99f81267c8f13485f19f2d06cca3a52b7e5b049588b99d8eb41a16a679e616d62a1510f912f7d01c0dc684d5c405af8f0ac09f78da3521b8823b821fd9fc127d9b4d68d2fc1377dffd60b313b0eb6524266a764eaa997f21764eb2045562239bbedc4dfd7731978e325bf299c2f611880d7339a3ccb33803d79af8608091c3a5491412333402af46f69a79ba094c02da6851bbb0e7f50208ca1e9dc90316dce99144f29fa64d41be9ec426b6c37e883efa339c741eb1debc6b009fac84b48ba97e6e1d4154ffb824e42b0bf772fac5faa7f41fc0b64a5ecd441482d71941b41312aa253e2c43d68228b8fa5c7a62b53113bc9e6da11aaee5261a3b25bc1394631124d15b543d95e4de33cd1a13d3e7dea34b57921ab99bb00520a9e672be095affda96b1029fd3a38b04dc937680dc511aff82beb0220c9c074279b8c77ff5b5c2907ea4a55d519442a65d02645d2f9e8913788970d5eabe40d82ddc347bd61379686a7ce4f43dfe964328c8c49624e09ed5f6c0bf7d0ec5d1e9855904aa7fba7944787c8b7887093300337d3883350ddb9986b1eafa305b1f90760626316c7e8602830fb109fe47e41433edde52bbfb02cf86d2cf6afe5887a8346ad60b4b039d8a9e28c2ef7ff5c8a4c7ebd31f15ec168ba9c90ee22031a6f33b25728f2160ae7ca420af9f75310a13cf8e2c308fa732e586ec65443ae94d84bab7ca0a9422566e083aff3dd905d2f439765d2cb16e3b3a806daf4636771bd4e8841915bf1b8aef6f11e319b698aa39536800673dffa991f2c45200c82289c536d982ed3815f2bababa1027b694b206660b26663fd72bc3330f06d5e54def1fa4804e1ad2034bf9fecbae93be331987fb51ff90482f10f6a0731108d6835f67c6684dddcb20c40062c3c22a440df74dfd1a8f172b3ca16df11d4dd476444fa331d62020f79b16aa52badc1de6fff930ccd3b5a9389cf17f0488a3073b2b3e1a23d13f7d7802f11effe15cd3ca76163d8f926d31c85450642e9fd5dbca48c2dde15aa5f1eb16d1f6ef4a26e4c7c230bac1a57c0d568461030b11749f89a500a88207ff3492ad54cf8cb831ddd5840d05438149f5b6209425443fba153ddde66a98dbeab79ddc853f01ee4694b34a700e73ada9f5777ae1f37cef00a1648d067618d30032e25f42a2f655c11d05df3cc7d63c44d65713e4a4110dbfb65da0fb54a09c155d8fba9c2c5de46e91cba5d5d934ccf607ee151be98a05b3ed07eabc3f64b862617e0b5831dccc04214b0505c1dabbb869cf1d430c9a480bd9c38dc4922f0704070be2b84f1c17a337f43ebca2d90978ee6e7ca6e2145610b19574a0cd74056de83cce1f9da0e0ceff7665bdf6c21809252f4cd67bab033b1002ecca2e23a5949eaccc7df7f5b174da7eb2d2f60b72ded920427a9ec1bb81026e8efc10a70a9b122114694d5d14571d9c36f6d9ad49769af69dac59184021dd0d915b37a2fd6bf68eb2d24b12577a1fa3956ae8987da17fd8b865d689c9d7a31027645441e478ffa397b29674dc49aafcb2742480358e0900698e9f51ecb5dcd42958fca0e05a5a2438857670f1b7abe6db220349a7ba155b14b31be8328f679d339ac", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG | TESTMODE_TAPSCRIPT_INVALID, 10, 5, 8522, 0, 9);
    Test("and_v(andor(hash256(8a35d9ca92a48eaade6f53a64985e9e2afeb74dcf8acb4c3721e0dc7e4294b25),v:hash256(939894f70e6c3a25da75da0cc2071b4076d9b006563cf635986ada2e93c0d735),v:older(50000)),after(499999999))", "82012088aa208a35d9ca92a48eaade6f53a64985e9e2afeb74dcf8acb4c3721e0dc7e4294b2587640350c300b2696782012088aa20939894f70e6c3a25da75da0cc2071b4076d9b006563cf635986ada2e93c0d735886804ff64cd1db1", "=", TESTMODE_VALID, 14, 2, 66, 33 + 33, 4);
    Test("andor(hash256(5f8d30e655a7ba0d7596bb3ddfb1d2d20390d23b1845000e1e118b3be1b3f040),j:and_v(v:hash160(3a2bff0da9d96868e66abc4427bea4691cf61ccd),older(4194305)),ripemd160(44d90e2d3714c8663b632fcf0f9d5f22192cc4c8))", "82012088aa205f8d30e655a7ba0d7596bb3ddfb1d2d20390d23b1845000e1e118b3be1b3f040876482012088a61444d90e2d3714c8663b632fcf0f9d5f22192cc4c8876782926382012088a9143a2bff0da9d96868e66abc4427bea4691cf61ccd8803010040b26868", "=", TESTMODE_VALID, 20, 2, 66, 33 + 33, 4);
    Test("or_i(c:and_v(v:after(500000),pk_k(02c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5)),sha256(d9147961436944f43cd99d28b2bbddbf452ef872b30c8279e255e7daafc7f946))", "630320a107b1694d210a0bc5a4c9ea680fd0574b0eb6280c3dc439f0edc0ac27a89090dff3021af9dc22c899734ba9aa5e4a6d7f4ee563564daf2df21e4c49b155dd08cae6d583add14c5bf4d0a8f4f19a5501ec9cbc50eb35db034387b2f52ac43c5372d1539d69d53c27d3d672edc6aa6a54711725e223c13531208b7d0ffd89d0fb9e034d7ee1a05b6f19a8a96c47e25992d07516a90e12e60cfc45f09d53ce455b6a7eaa474e6ee0f44946bfc69927b15a6124e9107ae0b5455306a7965bdfd705fa756d57be80ce14eb139146eb0358ec843a0ab91d77d119e77311eb5b20b6892c551ce2e10c031d39ce2e83999b19bee0c0a76f1330c0df7d024cb8a3299de8762459c7a6f33e40a20893455777428215c1b26ced4fc7057bebd406a1580ec7876b860f48653ba14bc4ab8df32faaf8b8604a84d5a69da3b2adbbe5436aec57a1fea3491c1e2253f30de385a291666c5db01ad2c1a8d9bffddf2bf61c5db5121feaf517cda9c69d8a6f5ab9d99aa54e8cf730f935828783616fba186aaa5324e4e82516ee6bc3e50cec7801f3efcc5eb79a7262ee3336d3fb85f80742292788cfdbfecc9d7ab8c3ffd8d1b7800e78075bbfe337150fd6d29d53649592ca72f57292d7da341902dbb28133110e3107c13c114fb9cf111939224a50cdcf61e853f716fb9b2e5502086eb676ff378e2a19d7702c0119619f762e68aa04d5444a80a12cd8f864420e89d116863d4995c5a4b3d7cea38bce674a25b4f53026d27921e2e7f7c580e9c5278e96a2eb06ca39685607478f659df8d10fdf9d23c7bc8717c32db13dfce1834fd7e64840632fec4fd163a1082b34cbc7752f399a16881b49d2844b16751d710f6991a89a121ac6e56407d20a0a707ec73e0028e2b0214b7fdc559ebe720828e3e393f4b1976b05f02b05774cff49b8c3848c0fa6accc75588cf0ecb031b499819b32b18dd46606e56d1e1e32d4c849f34a58d73cd420f0fc9ed87470e461da27d7997845e7ec02ea6800e9add5187302f00f088e76307e862832ec2937348ccc00d6b6e06814c975b588e868514bc0ac35198ceaea0c3db92f6875eae9169598dfc2207bca4f3412fa7f8bec7d4af39c57ae72619fc068f820afebf7e100e529575de7a056399a0797a3951f661560b2a6fc4d509fc2556fab29dcb2be61dcb36d662698653e351075f10f459aeb6c84660f14808d50060fcc1cdc2604e44d631bd8bb8b3da026e34112feb1f0812f7bcd239a0c9ae3915f6daf7c64a3fa289352ab4a9cade36b551c376392b88de27630c09ca421c8f3374745ba8f99552496ca7c0d99bb5f6dccd1b6fde8ee47654cc330f368b1a22f2d26d8ef11877ab40fe94c05a7c4624ce37e3afe6caf705e4b645f8d76439ea5e497593c66c5f1f6fbdb01adf84388f99317c3b0dad60e9aa55014e27049d713063e90e3c5bd2dac1931596ae4520bd4394533d17515e5624a1960b50f7eefb0efdf81f9701bc1c1201b7d1076c00f30c1ee4b357ed06fe92c539971e475f49fcda4fec4eb68949c5116ce8e6549f0caee7c96348e363fa3380238022667d192bc7934ac301c1a5afe520151f836a6820e7610f8e51702062da68db0f4b8cb67e09a37e3212b1049175ad80d0d7290c45c6f175b84907269e12a09f2404ac5ce30193ab6945718f6b124f97cd9f9afefd12cdf169264e0720b10c09cbf2b7c3fd3afdc8f396acae293d5dd56b0e8eb82bfaabfbe1ecc3a2e160439da2ed3279af57d6994b177ab9991e39a68aef99fa20082886c00e6c8b078c6ba9bb81d53fbdb57587c7c471a76458c734bdac61097bd6f49e3067b7cc5171673d7248d6afde79267e0e36b4ea31639e3a507f162d91488abaff15771fc4932a3c8a53626dd2eb41e9901329a1006371c013daca7e8ba101c1f12d2c92637ad1027ee1ab3409c37947245c4f09b8b672c958e433dc7d5dbf41a19f33f00b05037cb22cf64a566e512beb1c1dcbb913b8e838fba6e667a90682178177595356b4dce03fb93a61d3839055b32fc533314f0ca999051a8db6193d6559226df7a379939bcfdf2f299831f031521d361304d2d01a3e7392c83a031cd6cb0468048bef0f11771f3fb8a07a88c7295466eb8656cd8acc19dee6e3460ab436559ba58d14763065ce52a7a77189756e19dee2de9beef11d269a04d0ce482f0ebaed1d5d1396bf627d12c7fac90251b8323c53a2e78d6c2441fbf7ca978a9f509fb29454f5c3d8a9c813884b160b1a3e964bbb1cd8b5ae56bd4024e6ddbb72572492aed1f12edc97e5b055cea630d8691f399db933f8efb61697ecfa328ca48d754f540f4a157219445ac80c47a0adbd7c5d71ee26e163db0d01ef867633ed0d96b4e3dab3e6c584581ff3ae3e95efbc7ffb8275554a5522cb06b655741d7759ff2ae444967556afe90c6aa4c06e62a3960f3697b0fbd819328d69d5a3b684be5a69358327fe8801172672a5a33401a02d6ed92c425b28e21d543f2a4bafbcf382061c3f42b763134985a6967e0285f291045f798361388e3fa259049bf2c810408f1dc3829dfea482dd49763017de71ee26c0d9332888c10d2198e20ad50ea8fe0d9ecd66bdaad844e9eadcdacb40ade3d53366256f1adb25d7e8a38135d565eb21f309b2c10aee74e8c8dc51f9c3e9355a9e1f2ac253b0742254ed8b72267ebb1d0e9166c8734e7654ba0d8da5720fb76bc8d03307121e65f6bd8132deca80bb117b35d8d754ad92a80108a1f87b2e36fc7ef5b1582b388e2c128345442e221d8af5a6868fe702b8d23bb65009c8ea4f9ff85f7b1a459484c7379952203f44605a983fbc3237aebfa67fc00c33a4905535421f601592030e5a8c754b7722140711737f42a667cd2446d4a614d8ac9fa4718aaeedf4021c2a31b04aacc9a643f702dd06bc2ac364f4558de9616260f5d51f6c26b434b923f5d507ea67bc2d8331fee6665a3a2b0270bc2ee08b840b232d52567fd6b1486f0f47e482507c35cce171e058f3fe5744946e8b5ffbaa9a18a40105cc01c227d2ae84efac5a57f11bc3d316a72231e917bc9d4071718117789ee758abeb0776cbbaded96aa04a162c1275156e91e3249715b00be4570d2c3ccfe98094f20af0055f8a0afec589b6f7a2c5edce7531a2608256905d675627d2761cab01b1a53a14e3deef9e7d6c68c2dc280930bf9ec6e5e0832bfacfe208cd52bd1fa2488e26c411990ecca2e71a22d5ac59ab268a97cd42a96e9f93bf46ed06b4a9d36cc8511d2887ad28af8109da050cb6cf23c862f25489e1598a031009041815c7a72a7f187e0a73e27db12a60fdc34f01e01c9c1fb7f60d33152f2dc360a9677abb6325f95011975f709a4d66ffe397fde004813691eb7de39e72109d0a4737681631fb37f3ee5779944d38e8b2bb55c5659689c4272e5ec112b5461ff10451fb5b71df20091ddd2c9dc9fe8b9e4a0c5955b61d8c07c6ee0ff775427528bdaa808e3ccc373e948ba10be3e80660b113a1005daf4d883de14b6db6308cca28cd058715704ddc5bc70084b4ff198cebae2445bb902719f266804b50eaae716edcd322b2aede1a12d61f1b4f3a22a450881702a214f6ba8d5deb59554105bf746b219ff670bddf99c0383df8ba9ef2931d72943bc721f15b57270d065bc119e60cdac6782012088a820d9147961436944f43cd99d28b2bbddbf452ef872b30c8279e255e7daafc7f9468768", "630320a107b16920c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5ac6782012088a820d9147961436944f43cd99d28b2bbddbf452ef872b30c8279e255e7daafc7f9468768", TESTMODE_VALID | TESTMODE_NONMAL, 10, 2, 4633, 2 + 66, 3);
    Test("thresh(2,c:pk_h(025cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc),s:sha256(e38990d0c7fc009880a9c07c23842e886c6bbdc964ce6bdd5817ad357335ee6f),a:hash160(dd69735817e0e3f6f826a9238dc2e291184f0131))", "76a914a05e142a7e807627da9f9ca1fd3ac6ed69447cf388ac7c82012088a820e38990d0c7fc009880a9c07c23842e886c6bbdc964ce6bdd5817ad357335ee6f87936b82012088a914dd69735817e0e3f6f826a9238dc2e291184f0131876c935287", "76a9141a7ac36cfa8431ab2395d701b0050045ae4a37d188ac7c82012088a820e38990d0c7fc009880a9c07c23842e886c6bbdc964ce6bdd5817ad357335ee6f87936b82012088a914dd69735817e0e3f6f826a9238dc2e291184f0131876c935287", TESTMODE_VALID, 18, 4, 1383, 1 + 33 + 33 + 33, 6);
    Test("and_n(sha256(9267d3dbed802941483f1afa2a6bc68de5f653128aca9bf1461c5d0a3ad36ed2),uc:and_v(v:older(144),pk_k(03fe72c435413d33d48ac09c9161ba8b09683215439d62b7940502bda8b202e6ce)))", "82012088a8209267d3dbed802941483f1afa2a6bc68de5f653128aca9bf1461c5d0a3ad36ed28764006763029000b2694d0207080ab5989874824f0eae5087219862ca45a099b523d24e6cb15b65ebcc7da4f82fb2a629134fce8093af217c88419a188ccf421785739a0143fb28da78a3fdcc7e68b6895600517670e64733bc14a14929122ab75e9dbe588916f3ec394d32cabad4e8650b4198e504aaf3a9d4d9b2d8485d85a8bec20550d6887847306b273c8ea83b78458fb66a859a41cc228db3680fe74c41e29dd4ee5a2ec81e4aa45b55571f978cda3656bc59ecacec4f5b9f94345e484373e75a715e06532bed109c0a7656f7f2ce5cbb6abc824124351e06f9e88fde7eb582a6452e87c28729008161073bafbe143a4094820fa6a24b46803e459c20aad59b7295fad743e750a5b6e8233ab3ec9434a47a7581e95040c63100afd2fe9a42252abb1ef652d120e4580ab2b54c940be2d690a1b8b0c23ed52556b8b0986e2fda585ce966e9c8234062a3b0578f7aaa189d402224f53808911886dec77fa07e59ce14704548127a2d9266294ea7c71c4726745a3b268ed85b8baa77838cd234aebaff2047ee93a45d0e7b680027bbf15be2b40e486c154c41eb8f09ae4801a3fb20c24795c4c3b71c64899c86d6450ef2b6cd63a1c0e8a5246df7eaf7c5fa2e6e87e444e3f34ca814fa2c8b61aea8d0b2195e7b551c4b1259c582b581143157975a2a0425938e6d7f80ecb080601ef25e5a2799b54e0eb54e926930cac34b1ae0f537aff22428f127a720f12b7e8abaac55fd8bd45b870342a819987abb1d67784cb6bf34ae132f1775731958abc485367ba7e5621762780672c84475af615ed3db556b224014686945087c08cf07c0d6d13f05852840ad2bbb46bc29e5dca5b0b263f0eb6aed50718d04ed5db366bc27fbee243694a884f09b4672bc611f3af967a014464a47654d7649590f474e69310efd2c8340d5b780aaf78a6ddeabb6a6a124c82581b414b8033047e333ed5bf1dc191c42fe8cc01f1b842ba62f41e26b4b30a4bd865662725e6a1bd8ace6c433fae1f4f0aeae77d1bcb75c63fb575d4b79e129710fd567f134017618ce10039eab3555a4ea03b7867b62899ffac7ebb974e277633000df1cedc93317a796b560ddb40e26137249f6d46e1f579cb6354a108fc36c420b123454f03c06e33331982b430a4eb280ea968dcdd2e7eaca1f9d6c3eb6c6ea141ba9b199d5e9c8acf012e2c540e80b65c5d6cd992e1c051ab4ae075b055950c1cd2238b28c0de4d824852f36048847627d09be3f791feffa2b10e1b3f2e601afeeb652a88ed954609239398d6a8edc87718d22961e5a6be51cda8849bae262c10fb495801a90d3803b5cf6eb487386686b7197bbb6cd2a90fd54d42a17669285cbeac7809180245b22804338033571aaa6560540650f47a2e641677a9d0901172f45ecb5627d131a5d56f4717aeae464208286e012db78b07eb4758b6c365280d40ea5042ec446e5f309d79420ec40df4e2286c085b75754900d46879a16812d11cca0e3126a6234763a94a95be189362a5a9a010e4d6cb4d7dbacfa0ae81c63922a25483df7482d2bf543adad3217aed48eadba69ca47978c02c342975cfe8c60cb963243935b45f75b1e593a3b3a131b762ebf0d8c886013d1ac65c044f8eb8dc47f14b600a28b294e3928c4aba4021d08da93eb4cf62ac1b8400b8fbc7cc6bad7c249b556fe4fb859a11b003d61233909603e1d74fa9f9465bba937f6f7e62077c4084321d3d20c80447b08cd3242f14f0350913e6af5f1ab7a8e443072e24651cc793715a22ba34a4d1090b144e16ef51e86bf769f46f76908cc389b1ee53bac4771f666cb342985c68b4f8c58ccddfa6e802c7c58d4450c64a756f40daaf155c689e52169f6062e9ad999e8e8d0e93261aa89ad2945546e12c0e0d715313c2d172b83fc381dd313020f6faed56a1ac396883ef8ba2764145e751ce80884d1f4400d73a8e741e237c8d3f247144b22c6243b84cdb5bd5193771d86bb7d96bd25099bababd20a324e53d85df03da0fd25e56ee99d8817e9e0627c7cb96d254561b0449b25c757a90017299ae4d8970ea2462a5152778420abd485f43120bc05daab8d572d0a6301dec61f148ada90e2a17fd03fea47959e890239b3b593dd66c2d6b8a69d0b27a4eca8c816bd3c3884154f4bd893c5bc93cae39f83c6ef8bd428e73924a941f1205aac0ef0f4bc43b28a046e6549246c4c5ee0c138d43e2985ebd6b6c3444204131a20639ba990bea050493321396d07d105aa84bef0a3ff9cc500a0be99de0d6f4bd9d37231515c3ff91cb9c887389bdebee2c2e7b513581645a3cb4c3e051048685ea95f6ddcf2dd244d015ce9009e819950e554e980574598a2db82f6c625ac567fe1e54ee92dae05a38b801f5e115542b5836786958a39e1af1fa2886c55474e2a4c6e9776d9aa4c2fb650410fc1343a884afad7d8b063ce2be4bde53d2cb583ba328e981b046af93be0842f21a0047756a85f595ea35c280d8f0018599e8dcfa9815e82a6cadc1e3e98163c8879844624e01357761b10ff1947073cac67006868", "82012088a8209267d3dbed802941483f1afa2a6bc68de5f653128aca9bf1461c5d0a3ad36ed28764006763029000b26920fe72c435413d33d48ac09c9161ba8b09683215439d62b7940502bda8b202e6ceac67006868", TESTMODE_VALID | TESTMODE_NEEDSIG, 13, 3, 1501, 33 + 2 + 66, 5);
    Test("and_n(c:pk_k(03daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729),and_b(l:older(4252898),a:older(16)))", "4d0207080a9a62dbc221c45a36b44b13cf9f7ea7e2c5a5ce64670cb987012928fe42519da9e1c24e488053d27fcd4a8dbc1fcafb6884353d57d8515b34680edb467b59b0733e4a4a1cd4406cb23693181ee0b53cb1cb654d8074862fe1eaaa8e71e48543914b4a61e66d2a9381cd7060a3e21023ca7af618e9a4636249ca86005b1c7d011cb4d9eeefd1bd8a014153dda13b368fe70fe15da350ee5a18c12b42de39c26eebb82eb9c475c015bf578af3cae117bb58221e68470668a3569df637253604286695af9e5b6d09a126d242c79a919eabe420b76c5db54197d3b23bb2e4e62e6303ba0d281002c24a5f8c10834899643e2e4e9a555e711f55990571cd83bb193de7ef8c5db24dca881bc4d281dc44da36462290540e470153299b806c7196924d5e6d7b151da9cb537e8006ee59ed5440a30af544a66d683420de6405862600d5628b35265ac1364246aa914afd0021c5b11ddeb2b0d787518af5c3217384ec3495102902cd629d12ab8b6fab5a020453d5d8dbf34739e644eb02ed2f91fe9342aabd0a71fee0f0a0b59f46409763925f2810731692926726688116351aebbc54c9152b503b0e2e7d51c052e65156f940b9aab5a8793cdbcd442ca1b6cca8e108d05b500b0ae1a66588aadaca00089a76ceb4fb6f633e323a8747c255052ced1ac5d149dc3ec1968aa0012aa859c8733e9a387070c5106e5be977f5098bf4e12332d0412be764c541010cf1831459243a2a516c6aed36b66c42b1cb5da55ebab764152f40b8373082ef0e7a7dee032a09800fb1831bc25a9f38c51165178c8544d10fd3ff567449b4bbf78395f69b82ac774ec60601ead60b89021985c850fbf0e5468d953d398b8e6780c150ca5da27509697ae2c41c1c02592242b2d299b04afb9390d8db898257b845d156b1dcf161a78115605c928ab516d6a591628331a1479441b5f5334f9398cca54607c0f4b7deed636c1ad5933238953a6e9a4ff5cbd7d35648b61a1f10d59b3c5a3666190553bb71d4128bc699dd8c8664fb30e8d7a1a57dab620034252118a5c1a43f3269cd09fd970b6f69c3397a044c5e32d6d1201dbd3eea5ff620e738ae5e140653892550b04e48cc660e65bda114781b9a542c3186a9087cb5596ef80b9b9b64428dd3c9579345a2e5ba2cce014a5ae559f8e64ea95a52846ba2a938b89177a696885788a9a84321099238ae6b0c1ee74e8a7c7b3500e5b365dd5b7f98f22d749f211dc2aa6420fd813516754ae252eaa288d5526eb39372545224b0a6873aa3051db1d052a0ea2b0ab12590e4272446a520e6b1a3a7852a09b6b7528d685c8bb924a3e17e71e1476de2e528942752e91d8facc4f83616a5a79142231a5d53eaa75ccdd732a0440635b7eabe1e8f4fc04d392568f707d8e093fdc0de6bae0fc3aca295a6cce56a71dafa44fe9654d0520240bacd248b86227c250559a4a3ee708099f97cc937223a66b34c166a62b675113f8acd67e59a19d463e3aef51250df09292195f2862e82a724ceaa73bd689248d8c7c138d2906490097502c3beb3cac4f55e8e9910a00d91b32e6aa756aa7a7be7e25db04b537f06886c0cdf5586d1b5a4503ba7a5699455487e78178e7b6f7db548ad00f27b5404b26118d28c828feaed28c58b856db43a9c6f2f013355c8cf64998092a45595f6a628bb407c97390c5003c7ce6212860e79d12cd7b65d0a8a9b76e9a6745a97b0cbd1174a29a1347d68e67c04b64af46582727a4237032759a49d16f1ef24da681e8cc2d062008972bd303f01394e7860b60a9bc246b15d603d59f037b6b642a6887e26b9073bc2e05b90ce36eb5125f03608993b7e51b709960bc6976d0213bef3dab485c58626e56a610d2b32ec8d8bcb5b6fa39eb34836800c20a493b6fd20274abaebc43e61ed109a8a17899c977b85e923ace9eaa89c2733f8c5d49f99fd69cae7431300722649ac039f1050141d87626c9c1a1b18dee92082ef52ce0615211dacd8b4c46a983dae867a6868914aa1f36f8e7916ad4bd17199dd54d23382f8eb778374733a930a3f03f26fb6bf82dda0f8a0a9d3e60f759dc6544d60959e2df1a272a84c6efe88dbfa95d7750cf395db8798236efb73dfa183357cb4145f4df4b668b368d0ea295eacb3e2bf6faaadad97d83fcd38bcea4b891ee3934132dc45b310f3b874b1787f1d7eab20971bec248354a151747f8dea85c0d9d0ea0f194c54e807d9d50954caca9a77c68719ba67e69c496f5eec3536339333aa619e3534913b25155a26571863056ceb797850fa6f1146b3e0cf88a7919aa98c66c329bc83609547f66e9632e2a32c4b9d9cd426981d85312c77a0f2da55450c3567101f227850eec16f609b289160068e8d36bbb0a81341d70135241366ff0727b7c0fc06a586465d9d866092dcfd00aa41e629e69c06c5de8166480db90c30a03ed4f9a1610b678c107c1f60e6a8e2daa893ae09580892e993f98ea9e868791aac5e5537530a59e00970426283517a6ce121ebaa995e95c6ad8fdeac64006763006703e2e440b2686b60b26c9a68", "20daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729ac64006763006703e2e440b2686b60b26c9a68", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG | TESTMODE_TIMELOCKMIX, 12, 2, 1467, 66 + 1, 3);
    Test("c:or_i(and_v(v:older(16),pk_h(02d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e)),pk_h(026a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4))", "6360b26976a91440193c145bbc4646bffe2c2732d731842a0829e5886776a914da761cf739bc15a93f9f6f42cce7e1ef0b6d16ec8868ac", "6360b26976a9144d4421361c3289bdad06441ffaee8be8e786f1ad886776a91460d4a7bcbd08f58e58bd208d1069837d7adb16ae8868ac", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG, 12, 3, 5271, 2 + 33 + 66, 4);
    Test("or_d(c:pk_h(02e493dbf1c10d80f3581e4904930b1404cc6c13900ee0758474fa94abe8c4cd13),andor(c:pk_k(024ce119c96e2fa357200b559b2f7dd5a5f02d5290aff74b03f3e471b273211c97),older(2016),after(1567547623)))", "76a9142e13a3079b99d47adcad4f39522849fd9116e28b88ac73644d2105095e274b4c0ef1ee27925950da30f1cbece8483af76c86f3d45a0f7124df6ea8369e6f25d2d2b65f9bb1e48a3763c6c5c8c6e3b912a342a1cf119bc255c2779e562cbe0249a02884d09f9e75e32637b321c5d31f9917cfcb32a8ecc40a20aedbd7cc2deaee09673c155acb30aaec55ec70a90f13b186bbd720409132cda5b3394277d51acc534451b737e40113a236397ddc3a379258037b6a62c6f4aa1c2765dfee322fd03cd269c0ee7136abccb9af843feac0c0aa87e8f81e353a2851a1795b70e0aacc2e3b06b659cf211a6f9c6ccc0ffcfdc368faa6472052a6548d9c8f50d02ea2b8dbee35cc64314367608e1d8c04e666fa3b117ad7ab04f001071a58619f3b71b147e1d9b4fd74d8beabecc584cb9d51268bc5ca54ee857ed55fd38d27c4070d563f73c38527936318330f9062f4ea3304e46e250c2687794e0c3ada0dadfae6c1970d746cd710e96a625affb890f728aae9e7b8629b306d960133bc0df862f4973e1ae365b5fc883c47c65ee2e243cae5cd55065c94713a811460df7876811d92db6e85ade282710e355646da3b0289095333d53855b6ef144687a6d8fd535d270a29c2c36d6e82fcdcd084ed6b6c09c9dbcec4019992e67f7f5ef0a99086ba753e0a8d040fae9e39b02cd249c49623b51c904f26a8c90d145398e45e085ebae35eaa41a07747b9b66707d5e69fad3f897256fd9a3e3eba39f707ed1ad5495a4547ce97b75660cca8d95dcfc470e4d30490c2ac86198e326a148129da665b69d00ef1a0e3edda3de6e4bcd6f3a4c7fe686ec0b59c9e30124ef480fcb66cc982065d6da4a5be079c6c0028d8c897717e3b0c7033591a0b507db0f5a59ff32e7aa4fc4abb489d69da77ed56a546e0008f223d6b8b94b807ecdef1121cb047a297fdab9e65cf5fadeb58f51bd11719d4e0b3dbd523d9f86a20c40730712afa1aeaf0561aea95b926f0693eac58bfe6d2bf6b8212dc7c918798d44421dd530db86a994226d6fe7a6e2f996e4c73e8674be997d572d34b002298e904571c9e320b1dc06e39f682f555405f0823ce65c3f89a04328eea437b892c3ead617ba92d65d5284672969e58966e2a4eb812dc34c49f08706b6e09a5761bd322a50f333dfa26d2d8fb59bc6fa442accd0d6cafa018983c0a44429cf8eb90c5c81ac955dc7b80c6d9beaa0ca3ce148d6e86696a3351cb5baba967e30d141a8869af1c47c8a5f478783f8a14fb7b9f12c844ff9abbc6e7da0a56ec4cde1db095e5e19edc32c4e67e5c6aac4f475a8bec7c9c9f1da5011f4d8657e41a7601a07cdff3a5a9f64727cda4797095c6ee8a17ba4f0af4a67191d1ed3583a0a459495e04e74f73d6f0181b324c6a79a38f2c57a9e502be29f7958ee6be5fca87f6e07a0c07e512fe86bf912cd9a73e5ae42dde488d5ddccd27abcbbfb292ae88933beb5ca845889fb07fa27f6040edf3d9d0d075c1c5673df7e55bc42cc2fb783ef82acd257de164f17827949d7c75de09cef94c9afa5fb18fad03733d1082349cdf21e2ee8fe5d00f9e3efc50a7e6d65cbe0ae0f3de471b419c8ffed4328db676f65f8192c6250134cb466189487c53a9fe16180ab07430a9d9c55851590e38a7ef9f13c372aacc8db2b9e496980297ee957bb2a4156a0e5a424b83d781dee6b9b2f94d451833ecb44f9895d68b1d3956c4edbd8dbad89ab1a1201048e004aca50439b7f0479bfd2ac4cbbb6e9bee587ebf35c362516e688fca5d4e299be6f1924feaca51df4067b8cfa3af57047fae7fbfbdeae363b27412c992d569f407cf5858f3bc90c314fc617705258e2d77bff01146f5a80f94df09db9608a4888982d2e1340b7b7be7ac6404e7e06e5db16702e007b26868", "76a91421ab1a140d0d305b8ff62bdb887d9fef82c9899e88ac7364204ce119c96e2fa357200b559b2f7dd5a5f02d5290aff74b03f3e471b273211c97ac6404e7e06e5db16702e007b26868", TESTMODE_VALID | TESTMODE_NONMAL, 13, 3, 3326, 1 + 33 + 66, 5);
    Test("c:andor(ripemd160(6ad07d21fd5dfc646f0b30577045ce201616b9ba),pk_h(02d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e),and_v(v:hash256(8a35d9ca92a48eaade6f53a64985e9e2afeb74dcf8acb4c3721e0dc7e4294b25),pk_h(03d01115d548e7561b15c38f004d734633687cf4419620095bc5b0f47070afe85a)))", "82012088a6146ad07d21fd5dfc646f0b30577045ce201616b9ba876482012088aa208a35d9ca92a48eaade6f53a64985e9e2afeb74dcf8acb4c3721e0dc7e4294b258876a914ca3adc1cd3d71f22d19205113264f7f2d614887b886776a91440193c145bbc4646bffe2c2732d731842a0829e58868ac", "82012088a6146ad07d21fd5dfc646f0b30577045ce201616b9ba876482012088aa208a35d9ca92a48eaade6f53a64985e9e2afeb74dcf8acb4c3721e0dc7e4294b258876a914a63d1e4d2ed109246c600ec8c19cce546b65b1cc886776a9144d4421361c3289bdad06441ffaee8be8e786f1ad8868ac", TESTMODE_VALID | TESTMODE_NEEDSIG, 18, 3, 5302, 33 + 33 + 66, 5);
    Test("c:andor(u:ripemd160(6ad07d21fd5dfc646f0b30577045ce201616b9ba),pk_h(03daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729),or_i(pk_h(022f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01),pk_h(0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798)))", "6382012088a6146ad07d21fd5dfc646f0b30577045ce201616b9ba87670068646376a9147bff4f5a4b4f712076bfcfd1670031b8e5ec9244886776a914210b26bd57f01cd7401fc1cc13f0b94304177a6688686776a9141a7a2632950c37d944ae737ab4d2eb75b3d119028868ac", "6382012088a6146ad07d21fd5dfc646f0b30577045ce201616b9ba87670068646376a914ceedcb44b38bdbcb614d872223964fd3dca8a434886776a914f678d9b79045452c8c64e9309d0f0046056e26c588686776a914a2a75e1819afa208f6c89ae0da43021116dfcb0c8868ac", TESTMODE_VALID | TESTMODE_NEEDSIG, 23, 4, 5271, 2 + 33 + 33 + 66, 5);
    Test("c:or_i(andor(c:pk_h(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),pk_h(022f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01),pk_h(02c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5)),pk_k(02d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e))", "6376a9146fe2bd29d119210124ab2a0c11c08278948ba4cc88ac6476a91446c88da20253c7dbd69d4fc5b45c3cdf8479b5f1886776a9147bff4f5a4b4f712076bfcfd1670031b8e5ec92448868674da1070ac2f9eb7a79cc63ee7e59f2dcd3998d3faf5b298d7d3480596fd1b718d4b6b897e09fe9662b1713e359528ae0dc589a039e2c669610d676b0cfa87440f2ba87affb5f0998bffa06634f1d09c68b6c9c7e830542660aefceef0ef43208c2308a7e428feef926e4eae70ff4b62110a0e5ff4c6bc5a901a91feb349990f6487e54198847cbab18c24e41de00eee1240fcf505d04a30aab99b660353da42c7bb50a0b6ecb71405cfe54fcad2872b78d667205e281e4b977b1a918d86019dbe48d832bbd705a085b0fdd37cdb6ddc9627e9d8cd52725c0788014eb266db350827f436984510935fb828bad77edf8f70ed5d9add6791deab5d69f11beecdf28832ca97a315c7d7dabda8e219d77a2a710fceb574a700a1853a35d3595719edfb8d320aa47756c5bfe752fc2e12f92a97b226817fdcc33d001925f6505608227b63983eba0e3ab706a69210dd9c308b7b6ff37bbda7b46f1c768515d7524d75c8ba49195311e1a92d6103dd89f6d369dcce3c41e7e5ec8953ebe5557ba53e4d35cd2507aa8611512d963e5d13d8930a0031838cca47edbbe81c5ca7713bd17526d18a8277772aab11009cd4b3f68689338567bf3ee911638299820268809fc768bf90813b86a1be17fe820aadadca85ffc7551575f0f4aac0b4348ff7797e2a7ba02949c895c5e8690d8273bf245f78f579b738960c61dcc334db6786108f8fff8786461d971bc313edc60d9c215faeb8281fcac9fb8c3861798e8bd30897c58629f115c1bea2b631a012f696f7479dc37bb186cb4c7d1bd3011a2031dd1ca9894e34ba8cf8385b53068f83099318ff246abe1dca77ebaefef63431e15c27830b4e463051a54e0e72fdbd2374a60c4e6a6f76111a052a2ae73b460c81c48e257117905b02cc6b2ca670cc38ff019093d6bc9a6f162b5a0ebf0d3f68114b753deee832c09d8cfaf58192a8302c53432ac1ea9605ba1cdcff83b2fbd58efef6d3cdf53ca88b2a4c0e855c75a7337304b19896d7c9dc68456917e30d8b053f2446aa2224f8bc7194e916637c0b85482a79915cb86633a72b166ad81f308471ec16ac748cac9554a101f7f341f2d93d0ebdfd4132b2a52772637ceaa10bf5e4aa3f80cf0d86cb6eda4e909af8bfcd1f77ebd78a5616166be52809c1ed92e3161626f5444a93560e5673ce7890d82d87f2f57a02faf064f14702c5eb9f17c9cd6cb14c59c71c9815677e949a13473b88bc80a34f1bb30e1db47b2fbc82c049eb4a1ff4a3cf4b4daa8b72ae94ff7a52c869c2150476f4c3eda923d470f7b783cea93a138b978a5c95bd308889543622aa5439ac049aa61639ba09b3541635746d82316464b334a0b930bde2d088d7194de7f94f8d51d309b646fd7bf41fa9ae1f0fa5516efd73591a482b84e791031b10ebae65e553c7b77dfb72ed4bc8752c3fa03e554bee9c6ae00782738850459f45b911e2520d7b3d6aa7cd6a1128f0083f31ef5eef37748afa5d41eceab41e97b2b4fe98cc852fc183215958f287a03bbfdf186ac204b3f809a1965ef86364c6392b94f550c284a1e833343264d32062fa54127542b4061660d8b8eaae282cbdd89bd373ecba49e4ca31065ad261fd9bbc8bee254c8aea5ecb4218d29c8678c9d7bd810d18e3ce6bed711b7ca0fb5f1b4f82d67cef902d901bb26b65326c97a6e8a85679f9e380eae6811cf5541b3faabbc373e4a591a9f47f392d171aacc2bc7516640ebac29f8dd05350ae7f73e4c5274fbb1e8d732bb2ba0ec10e0495befb2f51b40c9cb5982962e6db62f6bd31777fd25003183cf39f102e549ba4673a6d5bdc93597a3f3263b93578414264200648dee16c602edba19a1e3c9da736a8ba0e980b745648807c0c9a1407b4d46d4d84eed2a5882ab6b2889b19afc3aaf8b835d5cb2a5385a345d7650ff97eb5d27fa892ba7a3aea7cdca0ffc5b8b3a659d91a49dc6a2bccb09e33da42dabe420f8d83c70ccc5fd6cecf673fbd8440ff6f38a1abe75b4091538f5ca06b08b4316b3467f3d7cbf2c8d71d377bb9b1e904ec7d1f4df1b12db863a5df6c4d9d206771d533024851f104684678302873090dd462dc4b7f407cf2cdd0af53229a4f9d937dbdb4dc136f5be28f67456d3b0e97b76aa6093512272126c02857c2b3f8157605c55c0628d2e3db871dccc6747fb34b0de9b57c4b20a17b6e9d22b7dae7b634f554678d3c6a3cced7fed93393ed157ea01d7fb297a7bafad2e47cdb08a558d93c042fe2d4f51de4edcdbe1d636aa5aa5e50b6d7191c15abc7625b43782583f37b53f7c72907cc9d68ccd9b54907f5b6c94e32c70840b4c4aa730fe64488860b7308b4fc920ab506d1b70e51f84ff1ccb52bddf4db7d9e493601af290a85b2dca85075b5723853aa6df6971ef4877fd6929c987b05dcb166f450f75327ae497cdf2175c8ad0e55d5af9f824953b663dd9f22447bb7cb9143202d6ec40ffb05833db87db9901696ff9558283788d50628cef1721e8254e4c8b4c95f67324613fdd7b9af9b857ab964b1b8773e3af1e4f31e0faf9ed410aebdc9c7308981843b94f8eb34db707242a83c175310a0f53cbbd898b487b647221572b7af7261732222d12c30662bc5bad78455f78514c52fc9d67565ef2f6721c9fa68c12bd6ad0109e1ef770f4b5331dce29e4ae712a66ef42cd13e07fd20ce64b85e9ae7008106874aed90a590e6de8aa378c211aa6f5c87e6002137e9e17e7f946f38cd7aa6d5c9e02deb47e04aa3e8668ac", "6376a914fd1690c37fa3b0f04395ddc9415b220ab1ccc59588ac6476a9149b652a14674a506079f574d20ca7daef6f9a66bb886776a914ceedcb44b38bdbcb614d872223964fd3dca8a43488686720d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e68ac", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_NEEDSIG, 17, 5, 10969, 2 + 33 + 66 + 33 + 66, 6);
    Test("thresh(1,c:pk_k(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),altv:after(1000000000),altv:after(100))", "4d210a0b12993eda2e59364fabb9ff3a5bdb5918f55210ffc324861fd50a184b61a62576bbbb5f1c36a3c3ca1e7a063919f50d06d60c292419a06fb0e8d84ba525afa06110dabcfe4570d5c86928085724e44346e9c13da1683a3146fcd2f53d605fde65e8f7035d7eb3a3c0518ec79ea0f4364ef0e5ac4dd536b3fc08f7818b3f87ddfded98a5b9e26ee39e404b202ddccb8e099dd7196afda0f04cce2c98b03f5a2ce79456eb68fa8a6c02f2f4666629d445a4004b6b7737720f15e68c215f8c63933a9e135887b8ab398106091d9d1ed0de1d2801ff44124707ba0da9ec956bb6db4b973c6c8c78031ed011d4ece28eaeb5ba98efe934f9ca378c74a1400a85dd529a448ad9b67945dfe361a0334ebc0d98ad0bbf9837134b533a42deaa3f40f9e7910b456a0dcbcd6f547cc06b11e4f217c8837d27be30015a6791ece5cd21efd475ce3c61233d210d76bcd34416bbacd31135aab00bb1b09872ae2dd67460905afb9b1fd0028f51d8f1fac72da163d1ca5ea97b123aba089d63f3efeedc37745ddb63831dd81ddb3fe8aad24edac78745f1d6ab7ea84e90e1238e5807f65f544ac71d27782b3bbc8187ef3110574256c6f6148aeb596d8272e2916c7ed6348774f9a3b6f6c43e931990a53d265e38385949c5497bc64c1711fdd1320f6c2dc7268e691f561a5500c6043ff8413c5fd33038ecb598dc1dafaf43d323dc48f1522ae915f32ba66ea8098cc6c001a2fa055fadd7d22236d0d9b0634921d96a51622673078dd399721c8f7e9a1c8bc444569a4e9a0c63ea9255470ec81e8a3f022e0c06e1306cbb0a45becddb37fbd7f457a246213d49040dcd5cc89d332f53b6e4576768c21d6d42df64d09f3833e1dafd7bbfac03241e102163bc36962b0a5a096b58a411687db9b03842062fb4543b5b0bdf4e10b3d21171355570ddbf6bf1cf17484025d95fd164d0ed918d3d9ebb6685cc1747e0f7e4f30870c150a5a5e533d03edf341bf0e704a48fc6f82c9d17365de2a8d04ddf78db57fd2d164de50d535b7c82ae6d3f6f11fe77b2b8296f19c04420b56facdeac56e2b53638d778ef7f6045f00d20962621f856a210b9a2ecb94b3333d00eaea98670c33e498f5072b6c1065300db7e71022ff0fd15894689a9441a5297d5505f1f4d51ff75e0ecaea2b28b9b2e976f0a7d2e80cbb18475a2656dc23cdaff0f7c3581ab091941588f6de22ad989fb5371b15ba42cfd0eef7fa21d51b7dddf70fd3c0a2a091be20c57b11fa7091e1fad18422e18bfd53ada7a966813d1811bc5a9ce9a6d7f1e2401fc6b9643939879f69d51d214317c5a3f5ab8264db3ef68d77821c4eba3cb8ef36e6c7d994f00791550c8f44e23236f8dadfab789ff17c0e81e8dfad10bbbf1f011fe04d395fc532d827297c6aabb305ef5082ffcba71d1c9b6c5133a2d8b26af1261a8f29ec344c53dccfa46b8eb8648270eeaf2598e334a88550d0fc4d1958513b9e4b6384c459038b115ab48a1aa9a18a13674497e6a1e0261a13ff590988c27f0ba5fb325922334e17675e67c7e10d62f50ceb4b5257a3bf98abc6377cbf8f9ea21c18309eb68603abae02cf4d80de211c525f4fd21c56ad4223b0dd23b7311c8982476198b5a439f7bc6d18f31594bd065c7e3257d2e18c95724ac3511ddad8ca542a74e8b8073559d83383af2fb4e75f753dae09e70bfbb95d61f373210f76b8430d4a3f3f0ba3e677b5f18e8c4d2ccae6df6f86127eca97499be9807aacfddb02db679fc5a4f7d34276757f44c8e00254a7ca900c474619682805c9e54a1f99da9e3b6cbeb35093d037d1fa1be6e2055deb1a633d5da656f6a46e90d262267399f4def26562831424a08fd92ba43da2cbbdc6b755b4f0d3f2791054b7f8cbce8f3112a143cce97dd191f0b64b814bd022d98cb6a9db6fcef47e1e2a4b181905d55f9e6d564acafa0c927f8e4bcbbedacb81c21164b2f4456c8f89cc9e08bde96ace5ff46e57403e397e1213c806df51ff3b8534adc07155e3f5768f6758ff45569d343e3861087d919bb7be13f96a931d8fddbd87f73eaa528c2e42922b1720672a4a2499fb6b18baa094b17d238c245978d679c497dcc9a4733dc43acb83b41e0cfb23fe62edc9824be54f443c32e1017ef250bcd0f6ee048cf1b96aa4c589bf6b60afd7615ae6590e3ef6a99a63364c1f5c0167cdec8b0908cca319ee4f87a9f4a511bd6dd10406c543f81af15572f2c8321e13b5b1eee073a1f717b06298b442063958ea6f51c2fe65dd065443f8028d0538cce63dfa8305f63b97629b8deadceaae4effe1ad92bf6f50fc84ace3df3e4450fffd9e3cbb4b2e31f25490c0f1e1efa9cf373382204e7b3471cda0da081df2f0c473d6aa94a40493d849c8a655bc8a533233f7f5e3e293d3cb4033f2bd70e9b5ebbc776c5bc1dc273fecb0106d14c3d15790086cc0177df686e5913661e61d8cc796768f5643652229b385097607fb610d2f6b78851dc84532509aa540e028a12aafaaecb3104d34d4d0e87472690efe84f4861d3be3e2bcbfa69c2731801e415b0603459b843a25829208c41146ebbdb825105492b134ee359d42a6113f8a66ff7bfa395d5d3c14437e2e5b8fa465ab30b6486c72c8961386f131071fa7e3a2619a8ddd2acb20acfe8b5368c2e172fe403fb84c9be6c9b56fe9b5af13fb241849d3a672239cb346c1ed0521431442b8a49ab3371c27a64f2e55238de10cc2e92f5b65402b3f01d485b2aea0aec34fdc4f2ae9d86241c983ebaf6637910648b0d1b08ea294ba212388cf0e1c3c89e51925d096d725e46e15557e52806edef385e075991578babfc908fe41944c2a1cd75b7a5df4a92279459d09620e71422885c86720365e38fecaa14cda3e528d00e1e5d031481c1cf2687d75d764e58fde7b588bf0e71d9f0858a9181503fe1db35f51b122a47c5ee1c3b87440a6109bb9cef897df84c80723887ec19b90cf641ceb1fb226664192860e0b69cadbf18366538c834f7c0922d93c5d80ae745b1bd37d5a07fee23008ca410bb2968cab21c3789f36fe550bcd9b93a667d8ffa34c540128c99d4444e7032646317cd85ee997beb4a5ae511f2faf7402b8ee87af9d0c2ee4e907162c0fa585b222bd3d1d5fcadd83ac0d37744721a5e1b762c029330bdf80d84da1266fcc485883b45e5679e7e3261314728126727e364a2399cc97ca60c094a903eba4502f7de4397ad8ba92f6df55974599e4c7ad88ae5476eeb5c804c19686a54931732da7fc02de1235292091d0a3a18e93b1870a8c977ba86ec668c1ca0c39864cace15874d00735ea4e51dd56b659222babf582274051d248c5479635671bb56aff4609477f95b237151d48c011639566e7fb2b207b79d755419ac8ab54f6f45e36df20ff4b6724af4566f1b8659809259ca568841350acaae87882def1d52e60151cfe2a2e599a27e9039091dbc69796b3977ef23d99f8961c73a706fbc06b52f2e0007a9f9472d6f0bd79860dc54cc4a2fed70040bbbf3683f6b4bb232b1b6236f2e849adaef5673369b72053246e1580f205f32d87cb8cbc7522f5e0c7e6a789b30cf66f11f0b194ce144e0184c2d739633d312668b6210328c8a5c8dd9aa3c74539d61c9d2eb8491da1a0afa1db4982dd71ad3132961ac6b6300670400ca9a3bb16951686c936b6300670164b16951686c935187", "20d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65ac6b6300670400ca9a3bb16951686c936b6300670164b16951686c935187", TESTMODE_VALID, 18, 3, 4635, 66 + 2 + 2, 4);
    Test("thresh(2,c:pk_k(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),ac:pk_k(03fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556),altv:after(1000000000),altv:after(100))", "4d210a0b12993eda2e59364fabb9ff3a5bdb5918f55210ffc324861fd50a184b61a62576bbbb5f1c36a3c3ca1e7a063919f50d06d60c292419a06fb0e8d84ba525afa06110dabcfe4570d5c86928085724e44346e9c13da1683a3146fcd2f53d605fde65e8f7035d7eb3a3c0518ec79ea0f4364ef0e5ac4dd536b3fc08f7818b3f87ddfded98a5b9e26ee39e404b202ddccb8e099dd7196afda0f04cce2c98b03f5a2ce79456eb68fa8a6c02f2f4666629d445a4004b6b7737720f15e68c215f8c63933a9e135887b8ab398106091d9d1ed0de1d2801ff44124707ba0da9ec956bb6db4b973c6c8c78031ed011d4ece28eaeb5ba98efe934f9ca378c74a1400a85dd529a448ad9b67945dfe361a0334ebc0d98ad0bbf9837134b533a42deaa3f40f9e7910b456a0dcbcd6f547cc06b11e4f217c8837d27be30015a6791ece5cd21efd475ce3c61233d210d76bcd34416bbacd31135aab00bb1b09872ae2dd67460905afb9b1fd0028f51d8f1fac72da163d1ca5ea97b123aba089d63f3efeedc37745ddb63831dd81ddb3fe8aad24edac78745f1d6ab7ea84e90e1238e5807f65f544ac71d27782b3bbc8187ef3110574256c6f6148aeb596d8272e2916c7ed6348774f9a3b6f6c43e931990a53d265e38385949c5497bc64c1711fdd1320f6c2dc7268e691f561a5500c6043ff8413c5fd33038ecb598dc1dafaf43d323dc48f1522ae915f32ba66ea8098cc6c001a2fa055fadd7d22236d0d9b0634921d96a51622673078dd399721c8f7e9a1c8bc444569a4e9a0c63ea9255470ec81e8a3f022e0c06e1306cbb0a45becddb37fbd7f457a246213d49040dcd5cc89d332f53b6e4576768c21d6d42df64d09f3833e1dafd7bbfac03241e102163bc36962b0a5a096b58a411687db9b03842062fb4543b5b0bdf4e10b3d21171355570ddbf6bf1cf17484025d95fd164d0ed918d3d9ebb6685cc1747e0f7e4f30870c150a5a5e533d03edf341bf0e704a48fc6f82c9d17365de2a8d04ddf78db57fd2d164de50d535b7c82ae6d3f6f11fe77b2b8296f19c04420b56facdeac56e2b53638d778ef7f6045f00d20962621f856a210b9a2ecb94b3333d00eaea98670c33e498f5072b6c1065300db7e71022ff0fd15894689a9441a5297d5505f1f4d51ff75e0ecaea2b28b9b2e976f0a7d2e80cbb18475a2656dc23cdaff0f7c3581ab091941588f6de22ad989fb5371b15ba42cfd0eef7fa21d51b7dddf70fd3c0a2a091be20c57b11fa7091e1fad18422e18bfd53ada7a966813d1811bc5a9ce9a6d7f1e2401fc6b9643939879f69d51d214317c5a3f5ab8264db3ef68d77821c4eba3cb8ef36e6c7d994f00791550c8f44e23236f8dadfab789ff17c0e81e8dfad10bbbf1f011fe04d395fc532d827297c6aabb305ef5082ffcba71d1c9b6c5133a2d8b26af1261a8f29ec344c53dccfa46b8eb8648270eeaf2598e334a88550d0fc4d1958513b9e4b6384c459038b115ab48a1aa9a18a13674497e6a1e0261a13ff590988c27f0ba5fb325922334e17675e67c7e10d62f50ceb4b5257a3bf98abc6377cbf8f9ea21c18309eb68603abae02cf4d80de211c525f4fd21c56ad4223b0dd23b7311c8982476198b5a439f7bc6d18f31594bd065c7e3257d2e18c95724ac3511ddad8ca542a74e8b8073559d83383af2fb4e75f753dae09e70bfbb95d61f373210f76b8430d4a3f3f0ba3e677b5f18e8c4d2ccae6df6f86127eca97499be9807aacfddb02db679fc5a4f7d34276757f44c8e00254a7ca900c474619682805c9e54a1f99da9e3b6cbeb35093d037d1fa1be6e2055deb1a633d5da656f6a46e90d262267399f4def26562831424a08fd92ba43da2cbbdc6b755b4f0d3f2791054b7f8cbce8f3112a143cce97dd191f0b64b814bd022d98cb6a9db6fcef47e1e2a4b181905d55f9e6d564acafa0c927f8e4bcbbedacb81c21164b2f4456c8f89cc9e08bde96ace5ff46e57403e397e1213c806df51ff3b8534adc07155e3f5768f6758ff45569d343e3861087d919bb7be13f96a931d8fddbd87f73eaa528c2e42922b1720672a4a2499fb6b18baa094b17d238c245978d679c497dcc9a4733dc43acb83b41e0cfb23fe62edc9824be54f443c32e1017ef250bcd0f6ee048cf1b96aa4c589bf6b60afd7615ae6590e3ef6a99a63364c1f5c0167cdec8b0908cca319ee4f87a9f4a511bd6dd10406c543f81af15572f2c8321e13b5b1eee073a1f717b06298b442063958ea6f51c2fe65dd065443f8028d0538cce63dfa8305f63b97629b8deadceaae4effe1ad92bf6f50fc84ace3df3e4450fffd9e3cbb4b2e31f25490c0f1e1efa9cf373382204e7b3471cda0da081df2f0c473d6aa94a40493d849c8a655bc8a533233f7f5e3e293d3cb4033f2bd70e9b5ebbc776c5bc1dc273fecb0106d14c3d15790086cc0177df686e5913661e61d8cc796768f5643652229b385097607fb610d2f6b78851dc84532509aa540e028a12aafaaecb3104d34d4d0e87472690efe84f4861d3be3e2bcbfa69c2731801e415b0603459b843a25829208c41146ebbdb825105492b134ee359d42a6113f8a66ff7bfa395d5d3c14437e2e5b8fa465ab30b6486c72c8961386f131071fa7e3a2619a8ddd2acb20acfe8b5368c2e172fe403fb84c9be6c9b56fe9b5af13fb241849d3a672239cb346c1ed0521431442b8a49ab3371c27a64f2e55238de10cc2e92f5b65402b3f01d485b2aea0aec34fdc4f2ae9d86241c983ebaf6637910648b0d1b08ea294ba212388cf0e1c3c89e51925d096d725e46e15557e52806edef385e075991578babfc908fe41944c2a1cd75b7a5df4a92279459d09620e71422885c86720365e38fecaa14cda3e528d00e1e5d031481c1cf2687d75d764e58fde7b588bf0e71d9f0858a9181503fe1db35f51b122a47c5ee1c3b87440a6109bb9cef897df84c80723887ec19b90cf641ceb1fb226664192860e0b69cadbf18366538c834f7c0922d93c5d80ae745b1bd37d5a07fee23008ca410bb2968cab21c3789f36fe550bcd9b93a667d8ffa34c540128c99d4444e7032646317cd85ee997beb4a5ae511f2faf7402b8ee87af9d0c2ee4e907162c0fa585b222bd3d1d5fcadd83ac0d37744721a5e1b762c029330bdf80d84da1266fcc485883b45e5679e7e3261314728126727e364a2399cc97ca60c094a903eba4502f7de4397ad8ba92f6df55974599e4c7ad88ae5476eeb5c804c19686a54931732da7fc02de1235292091d0a3a18e93b1870a8c977ba86ec668c1ca0c39864cace15874d00735ea4e51dd56b659222babf582274051d248c5479635671bb56aff4609477f95b237151d48c011639566e7fb2b207b79d755419ac8ab54f6f45e36df20ff4b6724af4566f1b8659809259ca568841350acaae87882def1d52e60151cfe2a2e599a27e9039091dbc69796b3977ef23d99f8961c73a706fbc06b52f2e0007a9f9472d6f0bd79860dc54cc4a2fed70040bbbf3683f6b4bb232b1b6236f2e849adaef5673369b72053246e1580f205f32d87cb8cbc7522f5e0c7e6a789b30cf66f11f0b194ce144e0184c2d739633d312668b6210328c8a5c8dd9aa3c74539d61c9d2eb8491da1a0afa1db4982dd71ad3132961ac6b4d210a0b02f5a49f7172de3bcc53784733bc3dfeb93dd4416dd0327688bca1820c8a0f3a7357b21895b9be437f1cbdb8a919cade0c725ee6187eb054a211af0ce6b6529a4a73bff87a370f737744fcb26a133148c7929a6c81f2111737845822812434acbb02ec6bdd7415f8e89efff2a3621dddee6a88f7480179ec20abb7389e0bfc5549d84313d029f5df56b740e29ef957e6d14230c77158ea46810b5002c3e75a198cadddbaf7ede0259137c80af1e63c773921f6e3f112c5128da4129ef2831f115533fe666cf102d2dc29ff7a26087639eca2e9ef51b265205d35c8f3eaaee2227dc0b833799ef4f8af7c72ac0d7ba158f952e4dad57c9d9ea9110dca9d62e75cd3636aedb65806ef6ef4006fa3cab5203a31c1d9f3e31f2bd494737953e7db59f2a311eb989457c353d2736da705da857389f3ad316916c46b629e58bc86d96b63235f00b08e8b5993691ecf015366a933a5641bf805aed6b9d4f3a72717c60c938dd24069a4b5a2e466e72e0f3600d7193af76bfbfcadc8d4ae122cb73f1d3c03c1602900958d000c4732a1b725e79f1d9be295d3bc9b711e48e7bb6bee9914f7bd9b44ab28a7001ba89edcd7636ff335d4eb2457150934d6158bdfa7b3090460734236fc694c592bc1ba69912e6df57a7305eddf53edd4a4ae7b47c3036c528a264beb48b90c34b6586bffc6f263cf48eada3bcd80d74e1308cd06d6ac959f0d678c3f8bb98b31f6a53c178508f90164d59287e346d0c661fd612204fa3242745e4e731994d8a5a42019a8ee4f0ab01aaaac6ebb6a9826a7f24ad9132395084c1e28402e8cef44ed6543b4166a9a85996317394d99e81c4bb2e1aadfabfb6883ec777c6ab5774c9329f286d3939069bab5ec332c2e480a1ee10908c5473b5b617adaa0559ab12ec1f106946e6507656e4ccc7982e36a3bd93dfddd667924a07dd867bf35464ec429056c88e413c07909481cb8eb9c9a8d26b98d93662d3198b89502f2aea74c138cbd059dfb586547b5259d8019d7c72032d6f7bd04039cd2fcd76405844896fc7347322526f4a4811502662768322da2dbb773df2be96c97dbc6637faac183c0d1a5dab72b1fe147019438cc335148bc22b222789f89713f1ccf748f698c7d96d09c40f81c914b3897e09eab285b38f0530eb004c0df109f0595fe268171dede7eac59e63cd9fd387c8ca5b5f6809bd5ca42caa0fa293106d5e25abc23863be9eced9e7100900044c822f703017ef64915af67a66ea3392bb62753cc84f0aef18a0e2d93fb32ac0092f5c10f860a3486fd519f45117de684bc044878e6d0a88252fab08cfd224af4ee0e27cd6e26a3859a063980e231d4e903f1e260ead8c53acaa5ff4864fefc9a329aceb1e1da7569e6c78a47dfcdd6b693d001017bbd385d9bd18645070c1c942f163e72a392babf3bd4157debfdf9b3d1eeefaec0dfecb37f2e2e880af717b4f6866527c08fe69dc9e977af2632238688e27bc8b8b4f0f562b4a402730c0351dd8b3122f42b5e8c987dee7756a1b28f50aa197c9150cc92fd29888fcb2c3df7dbdf9a6030d280b6511f90592af564767ff7f0aeadd6f73e3f0636a4e951ef866189decf8590253086871195a6883ed09b438fd4a35a8dc42ef12589659f3bc67c385fb18917ed020b17c4bd1218b402cd88bfa02977db3a56c53e999f7f4593bab402d07638ba2180ce3c1994797c8a3361602b5d75a611df53c71acd632481f7068646e439749b0f92a8c948126d9bc1496445d8dbe0a628532407f69b411794cb1acdecdaf049331d8c618ffd119dd3cf393f931ce6eb4c557952c4df6bd9a99ef5ea3a2e433de15fa46296e8c82a631463c08c12ecf2fcc29f73e012ef7cca478778acef371c52ae1495fc700098cd7c185eb82f251f4dfe26fd53c6bb99244cc9731319d0513ca5df5283758008728f39eb27e9550aa9f101b9791cd5433a27d0599f983d61696e44f50a3366bb57115f1676448ce70671c92292bb0b8ddccedd6ff4cf566671770951b692a1c75ec51bfd95b54fd99f81267c8f13485f19f2d06cca3a52b7e5b049588b99d8eb41a16a679e616d62a1510f912f7d01c0dc684d5c405af8f0ac09f78da3521b8823b821fd9fc127d9b4d68d2fc1377dffd60b313b0eb6524266a764eaa997f21764eb2045562239bbedc4dfd7731978e325bf299c2f611880d7339a3ccb33803d79af8608091c3a5491412333402af46f69a79ba094c02da6851bbb0e7f50208ca1e9dc90316dce99144f29fa64d41be9ec426b6c37e883efa339c741eb1debc6b009fac84b48ba97e6e1d4154ffb824e42b0bf772fac5faa7f41fc0b64a5ecd441482d71941b41312aa253e2c43d68228b8fa5c7a62b53113bc9e6da11aaee5261a3b25bc1394631124d15b543d95e4de33cd1a13d3e7dea34b57921ab99bb00520a9e672be095affda96b1029fd3a38b04dc937680dc511aff82beb0220c9c074279b8c77ff5b5c2907ea4a55d519442a65d02645d2f9e8913788970d5eabe40d82ddc347bd61379686a7ce4f43dfe964328c8c49624e09ed5f6c0bf7d0ec5d1e9855904aa7fba7944787c8b7887093300337d3883350ddb9986b1eafa305b1f90760626316c7e8602830fb109fe47e41433edde52bbfb02cf86d2cf6afe5887a8346ad60b4b039d8a9e28c2ef7ff5c8a4c7ebd31f15ec168ba9c90ee22031a6f33b25728f2160ae7ca420af9f75310a13cf8e2c308fa732e586ec65443ae94d84bab7ca0a9422566e083aff3dd905d2f439765d2cb16e3b3a806daf4636771bd4e8841915bf1b8aef6f11e319b698aa39536800673dffa991f2c45200c82289c536d982ed3815f2bababa1027b694b206660b26663fd72bc3330f06d5e54def1fa4804e1ad2034bf9fecbae93be331987fb51ff90482f10f6a0731108d6835f67c6684dddcb20c40062c3c22a440df74dfd1a8f172b3ca16df11d4dd476444fa331d62020f79b16aa52badc1de6fff930ccd3b5a9389cf17f0488a3073b2b3e1a23d13f7d7802f11effe15cd3ca76163d8f926d31c85450642e9fd5dbca48c2dde15aa5f1eb16d1f6ef4a26e4c7c230bac1a57c0d568461030b11749f89a500a88207ff3492ad54cf8cb831ddd5840d05438149f5b6209425443fba153ddde66a98dbeab79ddc853f01ee4694b34a700e73ada9f5777ae1f37cef00a1648d067618d30032e25f42a2f655c11d05df3cc7d63c44d65713e4a4110dbfb65da0fb54a09c155d8fba9c2c5de46e91cba5d5d934ccf607ee151be98a05b3ed07eabc3f64b862617e0b5831dccc04214b0505c1dabbb869cf1d430c9a480bd9c38dc4922f0704070be2b84f1c17a337f43ebca2d90978ee6e7ca6e2145610b19574a0cd74056de83cce1f9da0e0ceff7665bdf6c21809252f4cd67bab033b1002ecca2e23a5949eaccc7df7f5b174da7eb2d2f60b72ded920427a9ec1bb81026e8efc10a70a9b122114694d5d14571d9c36f6d9ad49769af69dac59184021dd0d915b37a2fd6bf68eb2d24b12577a1fa3956ae8987da17fd8b865d689c9d7a31027645441e478ffa397b29674dc49aafcb2742480358e0900698e9f51ecb5dcd42958fca0e05a5a2438857670f1b7abe6db220349a7ba155b14b31be8328f679d339ac6c936b6300670400ca9a3bb16951686c936b6300670164b16951686c935287", "20d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65ac6b20fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556ac6c936b6300670400ca9a3bb16951686c936b6300670164b16951686c935287", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_TIMELOCKMIX, 22, 4, 9266, 66 + 66 + 2 + 2, 5);

    // Misc unit tests
    // A Script with a non minimal push is invalid
    constexpr auto nonminpush{"0000210232780000feff00ffffffffffff21ff005f00ae21ae00000000060602060406564c2102320000060900fe00005f00ae21ae00100000060606060606000000000000000000000000000000000000000000000000000000000000000000"_hex_u8};
    const CScript nonminpush_script(nonminpush.begin(), nonminpush.end());
    BOOST_CHECK(miniscript::FromScript(nonminpush_script, wsh_converter) == nullptr);
    // A non-minimal VERIFY (<key> CHECKSIG VERIFY 1)
    constexpr auto nonminverify{"2103a0434d9e47f3c86235477c7b1ae6ae5d3442d49b1943c2b752a68e2a47e247c7ac6951"_hex_u8};
    const CScript nonminverify_script(nonminverify.begin(), nonminverify.end());
    BOOST_CHECK(miniscript::FromScript(nonminverify_script, wsh_converter) == nullptr);
    // A threshold as large as the number of subs is valid.
    Test("thresh(2,c:pk_k(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),altv:after(100))", "4d210a0b12993eda2e59364fabb9ff3a5bdb5918f55210ffc324861fd50a184b61a62576bbbb5f1c36a3c3ca1e7a063919f50d06d60c292419a06fb0e8d84ba525afa06110dabcfe4570d5c86928085724e44346e9c13da1683a3146fcd2f53d605fde65e8f7035d7eb3a3c0518ec79ea0f4364ef0e5ac4dd536b3fc08f7818b3f87ddfded98a5b9e26ee39e404b202ddccb8e099dd7196afda0f04cce2c98b03f5a2ce79456eb68fa8a6c02f2f4666629d445a4004b6b7737720f15e68c215f8c63933a9e135887b8ab398106091d9d1ed0de1d2801ff44124707ba0da9ec956bb6db4b973c6c8c78031ed011d4ece28eaeb5ba98efe934f9ca378c74a1400a85dd529a448ad9b67945dfe361a0334ebc0d98ad0bbf9837134b533a42deaa3f40f9e7910b456a0dcbcd6f547cc06b11e4f217c8837d27be30015a6791ece5cd21efd475ce3c61233d210d76bcd34416bbacd31135aab00bb1b09872ae2dd67460905afb9b1fd0028f51d8f1fac72da163d1ca5ea97b123aba089d63f3efeedc37745ddb63831dd81ddb3fe8aad24edac78745f1d6ab7ea84e90e1238e5807f65f544ac71d27782b3bbc8187ef3110574256c6f6148aeb596d8272e2916c7ed6348774f9a3b6f6c43e931990a53d265e38385949c5497bc64c1711fdd1320f6c2dc7268e691f561a5500c6043ff8413c5fd33038ecb598dc1dafaf43d323dc48f1522ae915f32ba66ea8098cc6c001a2fa055fadd7d22236d0d9b0634921d96a51622673078dd399721c8f7e9a1c8bc444569a4e9a0c63ea9255470ec81e8a3f022e0c06e1306cbb0a45becddb37fbd7f457a246213d49040dcd5cc89d332f53b6e4576768c21d6d42df64d09f3833e1dafd7bbfac03241e102163bc36962b0a5a096b58a411687db9b03842062fb4543b5b0bdf4e10b3d21171355570ddbf6bf1cf17484025d95fd164d0ed918d3d9ebb6685cc1747e0f7e4f30870c150a5a5e533d03edf341bf0e704a48fc6f82c9d17365de2a8d04ddf78db57fd2d164de50d535b7c82ae6d3f6f11fe77b2b8296f19c04420b56facdeac56e2b53638d778ef7f6045f00d20962621f856a210b9a2ecb94b3333d00eaea98670c33e498f5072b6c1065300db7e71022ff0fd15894689a9441a5297d5505f1f4d51ff75e0ecaea2b28b9b2e976f0a7d2e80cbb18475a2656dc23cdaff0f7c3581ab091941588f6de22ad989fb5371b15ba42cfd0eef7fa21d51b7dddf70fd3c0a2a091be20c57b11fa7091e1fad18422e18bfd53ada7a966813d1811bc5a9ce9a6d7f1e2401fc6b9643939879f69d51d214317c5a3f5ab8264db3ef68d77821c4eba3cb8ef36e6c7d994f00791550c8f44e23236f8dadfab789ff17c0e81e8dfad10bbbf1f011fe04d395fc532d827297c6aabb305ef5082ffcba71d1c9b6c5133a2d8b26af1261a8f29ec344c53dccfa46b8eb8648270eeaf2598e334a88550d0fc4d1958513b9e4b6384c459038b115ab48a1aa9a18a13674497e6a1e0261a13ff590988c27f0ba5fb325922334e17675e67c7e10d62f50ceb4b5257a3bf98abc6377cbf8f9ea21c18309eb68603abae02cf4d80de211c525f4fd21c56ad4223b0dd23b7311c8982476198b5a439f7bc6d18f31594bd065c7e3257d2e18c95724ac3511ddad8ca542a74e8b8073559d83383af2fb4e75f753dae09e70bfbb95d61f373210f76b8430d4a3f3f0ba3e677b5f18e8c4d2ccae6df6f86127eca97499be9807aacfddb02db679fc5a4f7d34276757f44c8e00254a7ca900c474619682805c9e54a1f99da9e3b6cbeb35093d037d1fa1be6e2055deb1a633d5da656f6a46e90d262267399f4def26562831424a08fd92ba43da2cbbdc6b755b4f0d3f2791054b7f8cbce8f3112a143cce97dd191f0b64b814bd022d98cb6a9db6fcef47e1e2a4b181905d55f9e6d564acafa0c927f8e4bcbbedacb81c21164b2f4456c8f89cc9e08bde96ace5ff46e57403e397e1213c806df51ff3b8534adc07155e3f5768f6758ff45569d343e3861087d919bb7be13f96a931d8fddbd87f73eaa528c2e42922b1720672a4a2499fb6b18baa094b17d238c245978d679c497dcc9a4733dc43acb83b41e0cfb23fe62edc9824be54f443c32e1017ef250bcd0f6ee048cf1b96aa4c589bf6b60afd7615ae6590e3ef6a99a63364c1f5c0167cdec8b0908cca319ee4f87a9f4a511bd6dd10406c543f81af15572f2c8321e13b5b1eee073a1f717b06298b442063958ea6f51c2fe65dd065443f8028d0538cce63dfa8305f63b97629b8deadceaae4effe1ad92bf6f50fc84ace3df3e4450fffd9e3cbb4b2e31f25490c0f1e1efa9cf373382204e7b3471cda0da081df2f0c473d6aa94a40493d849c8a655bc8a533233f7f5e3e293d3cb4033f2bd70e9b5ebbc776c5bc1dc273fecb0106d14c3d15790086cc0177df686e5913661e61d8cc796768f5643652229b385097607fb610d2f6b78851dc84532509aa540e028a12aafaaecb3104d34d4d0e87472690efe84f4861d3be3e2bcbfa69c2731801e415b0603459b843a25829208c41146ebbdb825105492b134ee359d42a6113f8a66ff7bfa395d5d3c14437e2e5b8fa465ab30b6486c72c8961386f131071fa7e3a2619a8ddd2acb20acfe8b5368c2e172fe403fb84c9be6c9b56fe9b5af13fb241849d3a672239cb346c1ed0521431442b8a49ab3371c27a64f2e55238de10cc2e92f5b65402b3f01d485b2aea0aec34fdc4f2ae9d86241c983ebaf6637910648b0d1b08ea294ba212388cf0e1c3c89e51925d096d725e46e15557e52806edef385e075991578babfc908fe41944c2a1cd75b7a5df4a92279459d09620e71422885c86720365e38fecaa14cda3e528d00e1e5d031481c1cf2687d75d764e58fde7b588bf0e71d9f0858a9181503fe1db35f51b122a47c5ee1c3b87440a6109bb9cef897df84c80723887ec19b90cf641ceb1fb226664192860e0b69cadbf18366538c834f7c0922d93c5d80ae745b1bd37d5a07fee23008ca410bb2968cab21c3789f36fe550bcd9b93a667d8ffa34c540128c99d4444e7032646317cd85ee997beb4a5ae511f2faf7402b8ee87af9d0c2ee4e907162c0fa585b222bd3d1d5fcadd83ac0d37744721a5e1b762c029330bdf80d84da1266fcc485883b45e5679e7e3261314728126727e364a2399cc97ca60c094a903eba4502f7de4397ad8ba92f6df55974599e4c7ad88ae5476eeb5c804c19686a54931732da7fc02de1235292091d0a3a18e93b1870a8c977ba86ec668c1ca0c39864cace15874d00735ea4e51dd56b659222babf582274051d248c5479635671bb56aff4609477f95b237151d48c011639566e7fb2b207b79d755419ac8ab54f6f45e36df20ff4b6724af4566f1b8659809259ca568841350acaae87882def1d52e60151cfe2a2e599a27e9039091dbc69796b3977ef23d99f8961c73a706fbc06b52f2e0007a9f9472d6f0bd79860dc54cc4a2fed70040bbbf3683f6b4bb232b1b6236f2e849adaef5673369b72053246e1580f205f32d87cb8cbc7522f5e0c7e6a789b30cf66f11f0b194ce144e0184c2d739633d312668b6210328c8a5c8dd9aa3c74539d61c9d2eb8491da1a0afa1db4982dd71ad3132961ac6b6300670164b16951686c935287", "20d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65ac6b6300670164b16951686c935287", TESTMODE_VALID | TESTMODE_NEEDSIG | TESTMODE_NONMAL);
    // A threshold of 1 is valid.
    Test("thresh(1,c:pk_k(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),sc:pk_k(03fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556))", "4d210a0b12993eda2e59364fabb9ff3a5bdb5918f55210ffc324861fd50a184b61a62576bbbb5f1c36a3c3ca1e7a063919f50d06d60c292419a06fb0e8d84ba525afa06110dabcfe4570d5c86928085724e44346e9c13da1683a3146fcd2f53d605fde65e8f7035d7eb3a3c0518ec79ea0f4364ef0e5ac4dd536b3fc08f7818b3f87ddfded98a5b9e26ee39e404b202ddccb8e099dd7196afda0f04cce2c98b03f5a2ce79456eb68fa8a6c02f2f4666629d445a4004b6b7737720f15e68c215f8c63933a9e135887b8ab398106091d9d1ed0de1d2801ff44124707ba0da9ec956bb6db4b973c6c8c78031ed011d4ece28eaeb5ba98efe934f9ca378c74a1400a85dd529a448ad9b67945dfe361a0334ebc0d98ad0bbf9837134b533a42deaa3f40f9e7910b456a0dcbcd6f547cc06b11e4f217c8837d27be30015a6791ece5cd21efd475ce3c61233d210d76bcd34416bbacd31135aab00bb1b09872ae2dd67460905afb9b1fd0028f51d8f1fac72da163d1ca5ea97b123aba089d63f3efeedc37745ddb63831dd81ddb3fe8aad24edac78745f1d6ab7ea84e90e1238e5807f65f544ac71d27782b3bbc8187ef3110574256c6f6148aeb596d8272e2916c7ed6348774f9a3b6f6c43e931990a53d265e38385949c5497bc64c1711fdd1320f6c2dc7268e691f561a5500c6043ff8413c5fd33038ecb598dc1dafaf43d323dc48f1522ae915f32ba66ea8098cc6c001a2fa055fadd7d22236d0d9b0634921d96a51622673078dd399721c8f7e9a1c8bc444569a4e9a0c63ea9255470ec81e8a3f022e0c06e1306cbb0a45becddb37fbd7f457a246213d49040dcd5cc89d332f53b6e4576768c21d6d42df64d09f3833e1dafd7bbfac03241e102163bc36962b0a5a096b58a411687db9b03842062fb4543b5b0bdf4e10b3d21171355570ddbf6bf1cf17484025d95fd164d0ed918d3d9ebb6685cc1747e0f7e4f30870c150a5a5e533d03edf341bf0e704a48fc6f82c9d17365de2a8d04ddf78db57fd2d164de50d535b7c82ae6d3f6f11fe77b2b8296f19c04420b56facdeac56e2b53638d778ef7f6045f00d20962621f856a210b9a2ecb94b3333d00eaea98670c33e498f5072b6c1065300db7e71022ff0fd15894689a9441a5297d5505f1f4d51ff75e0ecaea2b28b9b2e976f0a7d2e80cbb18475a2656dc23cdaff0f7c3581ab091941588f6de22ad989fb5371b15ba42cfd0eef7fa21d51b7dddf70fd3c0a2a091be20c57b11fa7091e1fad18422e18bfd53ada7a966813d1811bc5a9ce9a6d7f1e2401fc6b9643939879f69d51d214317c5a3f5ab8264db3ef68d77821c4eba3cb8ef36e6c7d994f00791550c8f44e23236f8dadfab789ff17c0e81e8dfad10bbbf1f011fe04d395fc532d827297c6aabb305ef5082ffcba71d1c9b6c5133a2d8b26af1261a8f29ec344c53dccfa46b8eb8648270eeaf2598e334a88550d0fc4d1958513b9e4b6384c459038b115ab48a1aa9a18a13674497e6a1e0261a13ff590988c27f0ba5fb325922334e17675e67c7e10d62f50ceb4b5257a3bf98abc6377cbf8f9ea21c18309eb68603abae02cf4d80de211c525f4fd21c56ad4223b0dd23b7311c8982476198b5a439f7bc6d18f31594bd065c7e3257d2e18c95724ac3511ddad8ca542a74e8b8073559d83383af2fb4e75f753dae09e70bfbb95d61f373210f76b8430d4a3f3f0ba3e677b5f18e8c4d2ccae6df6f86127eca97499be9807aacfddb02db679fc5a4f7d34276757f44c8e00254a7ca900c474619682805c9e54a1f99da9e3b6cbeb35093d037d1fa1be6e2055deb1a633d5da656f6a46e90d262267399f4def26562831424a08fd92ba43da2cbbdc6b755b4f0d3f2791054b7f8cbce8f3112a143cce97dd191f0b64b814bd022d98cb6a9db6fcef47e1e2a4b181905d55f9e6d564acafa0c927f8e4bcbbedacb81c21164b2f4456c8f89cc9e08bde96ace5ff46e57403e397e1213c806df51ff3b8534adc07155e3f5768f6758ff45569d343e3861087d919bb7be13f96a931d8fddbd87f73eaa528c2e42922b1720672a4a2499fb6b18baa094b17d238c245978d679c497dcc9a4733dc43acb83b41e0cfb23fe62edc9824be54f443c32e1017ef250bcd0f6ee048cf1b96aa4c589bf6b60afd7615ae6590e3ef6a99a63364c1f5c0167cdec8b0908cca319ee4f87a9f4a511bd6dd10406c543f81af15572f2c8321e13b5b1eee073a1f717b06298b442063958ea6f51c2fe65dd065443f8028d0538cce63dfa8305f63b97629b8deadceaae4effe1ad92bf6f50fc84ace3df3e4450fffd9e3cbb4b2e31f25490c0f1e1efa9cf373382204e7b3471cda0da081df2f0c473d6aa94a40493d849c8a655bc8a533233f7f5e3e293d3cb4033f2bd70e9b5ebbc776c5bc1dc273fecb0106d14c3d15790086cc0177df686e5913661e61d8cc796768f5643652229b385097607fb610d2f6b78851dc84532509aa540e028a12aafaaecb3104d34d4d0e87472690efe84f4861d3be3e2bcbfa69c2731801e415b0603459b843a25829208c41146ebbdb825105492b134ee359d42a6113f8a66ff7bfa395d5d3c14437e2e5b8fa465ab30b6486c72c8961386f131071fa7e3a2619a8ddd2acb20acfe8b5368c2e172fe403fb84c9be6c9b56fe9b5af13fb241849d3a672239cb346c1ed0521431442b8a49ab3371c27a64f2e55238de10cc2e92f5b65402b3f01d485b2aea0aec34fdc4f2ae9d86241c983ebaf6637910648b0d1b08ea294ba212388cf0e1c3c89e51925d096d725e46e15557e52806edef385e075991578babfc908fe41944c2a1cd75b7a5df4a92279459d09620e71422885c86720365e38fecaa14cda3e528d00e1e5d031481c1cf2687d75d764e58fde7b588bf0e71d9f0858a9181503fe1db35f51b122a47c5ee1c3b87440a6109bb9cef897df84c80723887ec19b90cf641ceb1fb226664192860e0b69cadbf18366538c834f7c0922d93c5d80ae745b1bd37d5a07fee23008ca410bb2968cab21c3789f36fe550bcd9b93a667d8ffa34c540128c99d4444e7032646317cd85ee997beb4a5ae511f2faf7402b8ee87af9d0c2ee4e907162c0fa585b222bd3d1d5fcadd83ac0d37744721a5e1b762c029330bdf80d84da1266fcc485883b45e5679e7e3261314728126727e364a2399cc97ca60c094a903eba4502f7de4397ad8ba92f6df55974599e4c7ad88ae5476eeb5c804c19686a54931732da7fc02de1235292091d0a3a18e93b1870a8c977ba86ec668c1ca0c39864cace15874d00735ea4e51dd56b659222babf582274051d248c5479635671bb56aff4609477f95b237151d48c011639566e7fb2b207b79d755419ac8ab54f6f45e36df20ff4b6724af4566f1b8659809259ca568841350acaae87882def1d52e60151cfe2a2e599a27e9039091dbc69796b3977ef23d99f8961c73a706fbc06b52f2e0007a9f9472d6f0bd79860dc54cc4a2fed70040bbbf3683f6b4bb232b1b6236f2e849adaef5673369b72053246e1580f205f32d87cb8cbc7522f5e0c7e6a789b30cf66f11f0b194ce144e0184c2d739633d312668b6210328c8a5c8dd9aa3c74539d61c9d2eb8491da1a0afa1db4982dd71ad3132961ac7c4d210a0b02f5a49f7172de3bcc53784733bc3dfeb93dd4416dd0327688bca1820c8a0f3a7357b21895b9be437f1cbdb8a919cade0c725ee6187eb054a211af0ce6b6529a4a73bff87a370f737744fcb26a133148c7929a6c81f2111737845822812434acbb02ec6bdd7415f8e89efff2a3621dddee6a88f7480179ec20abb7389e0bfc5549d84313d029f5df56b740e29ef957e6d14230c77158ea46810b5002c3e75a198cadddbaf7ede0259137c80af1e63c773921f6e3f112c5128da4129ef2831f115533fe666cf102d2dc29ff7a26087639eca2e9ef51b265205d35c8f3eaaee2227dc0b833799ef4f8af7c72ac0d7ba158f952e4dad57c9d9ea9110dca9d62e75cd3636aedb65806ef6ef4006fa3cab5203a31c1d9f3e31f2bd494737953e7db59f2a311eb989457c353d2736da705da857389f3ad316916c46b629e58bc86d96b63235f00b08e8b5993691ecf015366a933a5641bf805aed6b9d4f3a72717c60c938dd24069a4b5a2e466e72e0f3600d7193af76bfbfcadc8d4ae122cb73f1d3c03c1602900958d000c4732a1b725e79f1d9be295d3bc9b711e48e7bb6bee9914f7bd9b44ab28a7001ba89edcd7636ff335d4eb2457150934d6158bdfa7b3090460734236fc694c592bc1ba69912e6df57a7305eddf53edd4a4ae7b47c3036c528a264beb48b90c34b6586bffc6f263cf48eada3bcd80d74e1308cd06d6ac959f0d678c3f8bb98b31f6a53c178508f90164d59287e346d0c661fd612204fa3242745e4e731994d8a5a42019a8ee4f0ab01aaaac6ebb6a9826a7f24ad9132395084c1e28402e8cef44ed6543b4166a9a85996317394d99e81c4bb2e1aadfabfb6883ec777c6ab5774c9329f286d3939069bab5ec332c2e480a1ee10908c5473b5b617adaa0559ab12ec1f106946e6507656e4ccc7982e36a3bd93dfddd667924a07dd867bf35464ec429056c88e413c07909481cb8eb9c9a8d26b98d93662d3198b89502f2aea74c138cbd059dfb586547b5259d8019d7c72032d6f7bd04039cd2fcd76405844896fc7347322526f4a4811502662768322da2dbb773df2be96c97dbc6637faac183c0d1a5dab72b1fe147019438cc335148bc22b222789f89713f1ccf748f698c7d96d09c40f81c914b3897e09eab285b38f0530eb004c0df109f0595fe268171dede7eac59e63cd9fd387c8ca5b5f6809bd5ca42caa0fa293106d5e25abc23863be9eced9e7100900044c822f703017ef64915af67a66ea3392bb62753cc84f0aef18a0e2d93fb32ac0092f5c10f860a3486fd519f45117de684bc044878e6d0a88252fab08cfd224af4ee0e27cd6e26a3859a063980e231d4e903f1e260ead8c53acaa5ff4864fefc9a329aceb1e1da7569e6c78a47dfcdd6b693d001017bbd385d9bd18645070c1c942f163e72a392babf3bd4157debfdf9b3d1eeefaec0dfecb37f2e2e880af717b4f6866527c08fe69dc9e977af2632238688e27bc8b8b4f0f562b4a402730c0351dd8b3122f42b5e8c987dee7756a1b28f50aa197c9150cc92fd29888fcb2c3df7dbdf9a6030d280b6511f90592af564767ff7f0aeadd6f73e3f0636a4e951ef866189decf8590253086871195a6883ed09b438fd4a35a8dc42ef12589659f3bc67c385fb18917ed020b17c4bd1218b402cd88bfa02977db3a56c53e999f7f4593bab402d07638ba2180ce3c1994797c8a3361602b5d75a611df53c71acd632481f7068646e439749b0f92a8c948126d9bc1496445d8dbe0a628532407f69b411794cb1acdecdaf049331d8c618ffd119dd3cf393f931ce6eb4c557952c4df6bd9a99ef5ea3a2e433de15fa46296e8c82a631463c08c12ecf2fcc29f73e012ef7cca478778acef371c52ae1495fc700098cd7c185eb82f251f4dfe26fd53c6bb99244cc9731319d0513ca5df5283758008728f39eb27e9550aa9f101b9791cd5433a27d0599f983d61696e44f50a3366bb57115f1676448ce70671c92292bb0b8ddccedd6ff4cf566671770951b692a1c75ec51bfd95b54fd99f81267c8f13485f19f2d06cca3a52b7e5b049588b99d8eb41a16a679e616d62a1510f912f7d01c0dc684d5c405af8f0ac09f78da3521b8823b821fd9fc127d9b4d68d2fc1377dffd60b313b0eb6524266a764eaa997f21764eb2045562239bbedc4dfd7731978e325bf299c2f611880d7339a3ccb33803d79af8608091c3a5491412333402af46f69a79ba094c02da6851bbb0e7f50208ca1e9dc90316dce99144f29fa64d41be9ec426b6c37e883efa339c741eb1debc6b009fac84b48ba97e6e1d4154ffb824e42b0bf772fac5faa7f41fc0b64a5ecd441482d71941b41312aa253e2c43d68228b8fa5c7a62b53113bc9e6da11aaee5261a3b25bc1394631124d15b543d95e4de33cd1a13d3e7dea34b57921ab99bb00520a9e672be095affda96b1029fd3a38b04dc937680dc511aff82beb0220c9c074279b8c77ff5b5c2907ea4a55d519442a65d02645d2f9e8913788970d5eabe40d82ddc347bd61379686a7ce4f43dfe964328c8c49624e09ed5f6c0bf7d0ec5d1e9855904aa7fba7944787c8b7887093300337d3883350ddb9986b1eafa305b1f90760626316c7e8602830fb109fe47e41433edde52bbfb02cf86d2cf6afe5887a8346ad60b4b039d8a9e28c2ef7ff5c8a4c7ebd31f15ec168ba9c90ee22031a6f33b25728f2160ae7ca420af9f75310a13cf8e2c308fa732e586ec65443ae94d84bab7ca0a9422566e083aff3dd905d2f439765d2cb16e3b3a806daf4636771bd4e8841915bf1b8aef6f11e319b698aa39536800673dffa991f2c45200c82289c536d982ed3815f2bababa1027b694b206660b26663fd72bc3330f06d5e54def1fa4804e1ad2034bf9fecbae93be331987fb51ff90482f10f6a0731108d6835f67c6684dddcb20c40062c3c22a440df74dfd1a8f172b3ca16df11d4dd476444fa331d62020f79b16aa52badc1de6fff930ccd3b5a9389cf17f0488a3073b2b3e1a23d13f7d7802f11effe15cd3ca76163d8f926d31c85450642e9fd5dbca48c2dde15aa5f1eb16d1f6ef4a26e4c7c230bac1a57c0d568461030b11749f89a500a88207ff3492ad54cf8cb831ddd5840d05438149f5b6209425443fba153ddde66a98dbeab79ddc853f01ee4694b34a700e73ada9f5777ae1f37cef00a1648d067618d30032e25f42a2f655c11d05df3cc7d63c44d65713e4a4110dbfb65da0fb54a09c155d8fba9c2c5de46e91cba5d5d934ccf607ee151be98a05b3ed07eabc3f64b862617e0b5831dccc04214b0505c1dabbb869cf1d430c9a480bd9c38dc4922f0704070be2b84f1c17a337f43ebca2d90978ee6e7ca6e2145610b19574a0cd74056de83cce1f9da0e0ceff7665bdf6c21809252f4cd67bab033b1002ecca2e23a5949eaccc7df7f5b174da7eb2d2f60b72ded920427a9ec1bb81026e8efc10a70a9b122114694d5d14571d9c36f6d9ad49769af69dac59184021dd0d915b37a2fd6bf68eb2d24b12577a1fa3956ae8987da17fd8b865d689c9d7a31027645441e478ffa397b29674dc49aafcb2742480358e0900698e9f51ecb5dcd42958fca0e05a5a2438857670f1b7abe6db220349a7ba155b14b31be8328f679d339ac935187", "20d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65ac7c20fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556ac935187", TESTMODE_VALID | TESTMODE_NEEDSIG | TESTMODE_NONMAL);
    // A threshold with a k larger than the number of subs is invalid
    Test("thresh(3,c:pk_k(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),sc:pk_k(03fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556))", "?", "=", TESTMODE_INVALID);
    // A threshold with a k null is invalid
    Test("thresh(0,c:pk_k(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),sc:pk_k(03fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556))", "?", "=", TESTMODE_INVALID);
    // For CHECKMULTISIG the OP cost is the number of keys, but the stack size is the number of sigs (+1)
    const auto ms_multi = miniscript::FromString("multi(1,03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65,03fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556,0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798)", wsh_converter);
    BOOST_CHECK(ms_multi);
    BOOST_CHECK_EQUAL(*ms_multi->GetOps(), 4); // 3 pubkeys + CMS
    BOOST_CHECK_EQUAL(*ms_multi->GetStackSize(), 2); // 1 sig + dummy elem
    // The 'd:' wrapper leaves on the stack what was DUP'ed at the beginning of its execution.
    // Since it contains an OP_IF just after on the same element, we can make sure that the element
    // in question must be OP_1 if OP_IF enforces that its argument must only be OP_1 or the empty
    // vector (since otherwise the execution would immediately fail). This is the MINIMALIF rule.
    // Unfortunately, this rule is only policy for P2WSH. Therefore we can't
    // (for now) have 'd:' be 'u'. This tests we can't use a 'd:' wrapper for a thresh, which requires
    // its subs to all be 'u' (taken from https://github.com/rust-bitcoin/rust-miniscript/discussions/341).
    const auto ms_minimalif = miniscript::FromString("thresh(3,c:pk_k(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),sc:pk_k(03fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556),sc:pk_k(0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798),sdv:older(32))", wsh_converter);
    BOOST_CHECK(ms_minimalif && !ms_minimalif->IsValid());
    // A Miniscript with duplicate keys is not sane
    const auto ms_dup1 = miniscript::FromString("and_v(v:pk(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),pk(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65))", wsh_converter);
    BOOST_CHECK(ms_dup1);
    BOOST_CHECK(!ms_dup1->IsSane() && !ms_dup1->CheckDuplicateKey());
    // Same with a disjunction, and different key nodes (pk and pkh)
    const auto ms_dup2 = miniscript::FromString("or_b(c:pk_k(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),ac:pk_h(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65))", wsh_converter);
    BOOST_CHECK(ms_dup2 && !ms_dup2->IsSane() && !ms_dup2->CheckDuplicateKey());
    // Same when the duplicates are leaves or a larger tree
    const auto ms_dup3 = miniscript::FromString("or_i(and_b(pk(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),s:pk(03fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556)),and_b(older(1),s:pk(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65)))", wsh_converter);
    BOOST_CHECK(ms_dup3 && !ms_dup3->IsSane() && !ms_dup3->CheckDuplicateKey());
    // Same when the duplicates are on different levels in the tree
    const auto ms_dup4 = miniscript::FromString("thresh(2,pkh(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),s:pk(03fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556),a:and_b(dv:older(1),s:pk(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65)))", wsh_converter);
    BOOST_CHECK(ms_dup4 && !ms_dup4->IsSane() && !ms_dup4->CheckDuplicateKey());
    // Sanity check the opposite is true, too. An otherwise sane Miniscript with no duplicate keys is sane.
    const auto ms_nondup = miniscript::FromString("pk(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65)", wsh_converter);
    BOOST_CHECK(ms_nondup && ms_nondup->CheckDuplicateKey() && ms_nondup->IsSane());
    // Test we find the first insane sub closer to be a leaf node. This fragment is insane for two reasons:
    // 1. It can be spent without a signature
    // 2. It contains timelock mixes
    // We'll report the timelock mix error, as it's "deeper" (closer to be a leaf node) than the "no 's' property"
    // error is.
    const auto ms_ins = miniscript::FromString("or_i(and_b(after(1),a:after(1000000000)),pk(03cdabb7f2dce7bfbd8a0b9570c6fd1e712e5d64045e9d6b517b3d5072251dc204))", wsh_converter);
    BOOST_CHECK(ms_ins && ms_ins->IsValid() && !ms_ins->IsSane());
    const auto insane_sub = ms_ins->FindInsaneSub();
    BOOST_CHECK(insane_sub && *insane_sub->ToString(wsh_converter) == "and_b(after(1),a:after(1000000000))");

    // Numbers can't be prefixed by a sign.
    BOOST_CHECK(!miniscript::FromString("after(-1)", wsh_converter));
    BOOST_CHECK(!miniscript::FromString("after(+1)", wsh_converter));
    BOOST_CHECK(!miniscript::FromString("thresh(-1,pk(03cdabb7f2dce7bfbd8a0b9570c6fd1e712e5d64045e9d6b517b3d5072251dc204))", wsh_converter));
    BOOST_CHECK(!miniscript::FromString("multi(+1,03cdabb7f2dce7bfbd8a0b9570c6fd1e712e5d64045e9d6b517b3d5072251dc204)", wsh_converter));

    // Timelock tests
    Test("after(100)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // only heightlock
    Test("after(1000000000)", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL); // only timelock
    Test("or_b(l:after(100),al:after(1000000000))", "?", "?", TESTMODE_VALID); // or_b(timelock, heighlock) valid
    Test("and_b(after(100),a:after(1000000000))", "?", "?", TESTMODE_VALID | TESTMODE_NONMAL | TESTMODE_TIMELOCKMIX); // and_b(timelock, heighlock) invalid
    /* This is correctly detected as non-malleable but for the wrong reason. The type system assumes that branches 1 and 2
       can be spent together to create a non-malleble witness, but because of mixing of timelocks they cannot be spent together.
       But since exactly one of the two after's can be satisfied, the witness involving the key cannot be malleated.
    */
    Test("thresh(2,ltv:after(1000000000),altv:after(100),a:pk(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65))", "?", "?", TESTMODE_VALID | TESTMODE_TIMELOCKMIX | TESTMODE_NONMAL); // thresh with k = 2
    // This is actually non-malleable in practice, but we cannot detect it in type system. See above rationale
    Test("thresh(1,c:pk_k(03d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65),altv:after(1000000000),altv:after(100))", "?", "?", TESTMODE_VALID); // thresh with k = 1

    g_testdata.reset();
}

BOOST_AUTO_TEST_CASE(pq_scheme_keysize_tests)
{
    g_testdata.reset(new TestData());
    const KeyConverter wsh_converter{miniscript::MiniscriptContext::P2WSH};

    const std::array<pq::SchemeId, 5> schemes{
        pq::SchemeId::FALCON_512,
        pq::SchemeId::FALCON_1024,
        pq::SchemeId::MLDSA_44,
        pq::SchemeId::MLDSA_65,
        pq::SchemeId::MLDSA_87,
    };

    std::map<pq::SchemeId, CPubKey> sample_keys;
    for (const auto& key : g_testdata->pubkeys) {
        const auto* info = pq::SchemeFromPrefix(static_cast<uint8_t>(key[0]));
        if (info && !sample_keys.count(info->id)) {
            sample_keys.emplace(info->id, key);
        }
    }

    for (const auto scheme_id : schemes) {
        auto it = sample_keys.find(scheme_id);
        BOOST_REQUIRE(it != sample_keys.end());
        const CPubKey& key = it->second;
        const auto* info = pq::SchemeFromPrefix(static_cast<uint8_t>(key[0]));
        BOOST_REQUIRE(info != nullptr);

        const auto key_str = wsh_converter.ToString(key);
        BOOST_REQUIRE(key_str);

        const auto ms_pk = miniscript::FromString("pk(" + *key_str + ")", wsh_converter);
        BOOST_REQUIRE(ms_pk);
        const auto pk_script = ms_pk->ToScript(wsh_converter);
        BOOST_CHECK_EQUAL(ms_pk->ScriptSize(), pk_script.size());
        const auto pk_roundtrip = miniscript::FromScript(pk_script, wsh_converter);
        BOOST_REQUIRE(pk_roundtrip);
        BOOST_CHECK(pk_roundtrip->ToScript(wsh_converter) == pk_script);

        const uint32_t sig_elem = miniscript::internal::WitnessElementSize(info->sig_bytes_max + 1);
        BOOST_CHECK_EQUAL(*ms_pk->GetWitnessSize(), sig_elem);

        const auto ms_pkh = miniscript::FromString("pkh(" + *key_str + ")", wsh_converter);
        BOOST_REQUIRE(ms_pkh);
        const auto pkh_script = ms_pkh->ToScript(wsh_converter);
        BOOST_CHECK_EQUAL(ms_pkh->ScriptSize(), pkh_script.size());
        const auto pkh_roundtrip = miniscript::FromScript(pkh_script, wsh_converter);
        BOOST_REQUIRE(pkh_roundtrip);
        BOOST_CHECK(pkh_roundtrip->ToScript(wsh_converter) == pkh_script);

        const uint32_t pubkey_elem = miniscript::internal::WitnessElementSize(key.size());
        BOOST_CHECK_EQUAL(*ms_pkh->GetWitnessSize(), sig_elem + pubkey_elem);
    }

    std::vector<CPubKey> multi_keys;
    for (const auto scheme_id : schemes) {
        auto it = sample_keys.find(scheme_id);
        if (it != sample_keys.end()) multi_keys.push_back(it->second);
    }
    BOOST_REQUIRE(multi_keys.size() >= 3);
    multi_keys.resize(3);
    const uint32_t k = 2;

    std::string multi_expr = "multi(" + std::to_string(k);
    for (const auto& key : multi_keys) {
        const auto key_str = wsh_converter.ToString(key);
        BOOST_REQUIRE(key_str);
        multi_expr += "," + *key_str;
    }
    multi_expr += ")";

    const auto ms_multi = miniscript::FromString(multi_expr, wsh_converter);
    BOOST_REQUIRE(ms_multi);
    const auto multi_script = ms_multi->ToScript(wsh_converter);
    BOOST_CHECK_EQUAL(ms_multi->ScriptSize(), multi_script.size());
    const auto multi_roundtrip = miniscript::FromScript(multi_script, wsh_converter);
    BOOST_REQUIRE(multi_roundtrip);
    BOOST_CHECK(multi_roundtrip->ToScript(wsh_converter) == multi_script);

    std::vector<uint32_t> sig_sizes;
    sig_sizes.reserve(multi_keys.size());
    for (const auto& key : multi_keys) {
        const auto* info = pq::SchemeFromPrefix(static_cast<uint8_t>(key[0]));
        BOOST_REQUIRE(info != nullptr);
        sig_sizes.push_back(miniscript::internal::WitnessElementSize(info->sig_bytes_max + 1));
    }
    std::sort(sig_sizes.begin(), sig_sizes.end(), std::greater<uint32_t>());
    uint32_t expected_multi = 1;
    for (uint32_t i = 0; i < k; ++i) expected_multi += sig_sizes[i];
    BOOST_CHECK_EQUAL(*ms_multi->GetWitnessSize(), expected_multi);

    g_testdata.reset();
}

BOOST_AUTO_TEST_SUITE_END()
